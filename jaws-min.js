/* Built at 2013-08-07 03:09:57 +0200 */
var jaws=function(c){function b(b){c.mouse_x=b.pageX||b.clientX;c.mouse_y=b.pageY||b.clientY;b=c.canvas?c.canvas:c.dom;c.mouse_x-=b.offsetLeft;c.mouse_y-=b.offsetTop}var e,d;c.title=function(c){return c?e.innerHTML=c:e.innerHTML};c.unpack=function(){"Sprite SpriteList Animation Viewport SpriteSheet Parallax TileMap Rect pressed".split(" ").forEach(function(b,e,d){window[b]?c.log(b+"already exists in global namespace"):window[b]=c[b]})};c.log=function(c,b){d&&(c+="<br />",d.innerHTML=b?d.innerHTML.toString()+
c:c)};c.init=function(f){e=document.getElementsByTagName("title")[0];c.url_parameters=c.getUrlParameters();d=document.getElementById("jaws-log");c.url_parameters.debug&&!d&&(d=document.createElement("div"),d.id="jaws-log",d.style.cssText="overflow: auto; color: #aaaaaa; width: 300px; height: 150px; margin: 40px auto 0px auto; padding: 5px; border: #444444 1px solid; clear: both; font: 10px verdana; text-align: left;",document.body.appendChild(d));c.canvas=document.getElementsByTagName("canvas")[0];
c.canvas||(c.dom=document.getElementById("canvas"));c.canvas?c.context=c.canvas.getContext("2d"):c.dom?c.dom.style.position="relative":(c.canvas=document.createElement("canvas"),c.canvas.width=f.width,c.canvas.height=f.height,c.context=c.canvas.getContext("2d"),document.body.appendChild(c.canvas));c.context&&c.useCrispScaling();c.width=c.canvas?c.canvas.width:c.dom.offsetWidth;c.height=c.canvas?c.canvas.height:c.dom.offsetHeight;c.mouse_x=0;c.mouse_y=0;window.addEventListener("mousemove",b)};c.useCrispScaling=
function(){c.context.imageSmoothingEnabled=!1;c.context.webkitImageSmoothingEnabled=!1;c.context.mozImageSmoothingEnabled=!1};c.useSmoothScaling=function(){c.context.imageSmoothingEnabled=!0;c.context.webkitImageSmoothingEnabled=!0;c.context.mozImageSmoothingEnabled=!0};c.start=function(b,e,d){function h(b,d){c.log(d+"%: "+b,!0);e.loading_screen&&c.assets.displayProgress(d)}function l(b){c.log("Error loading: "+b,!0)}function r(){c.log("all assets loaded",!0);c.switchGameState(b||window,{fps:s},d)}
e||(e={});var s=e.fps||60;void 0===e.loading_screen&&(e.loading_screen=!0);e.width||(e.width=500);e.height||(e.height=300);c.init(e);e.loading_screen&&c.assets.displayProgress(0);c.log("setupInput()",!0);c.setupInput();c.log("assets.loadAll()",!0);0<c.assets.length()?c.assets.loadAll({onload:h,onerror:l,onfinish:r}):r()};c.switchGameState=function(b,e,d){e=e&&e.fps||c.game_loop&&c.game_loop.fps||60;c.game_loop&&c.game_loop.stop();c.clearKeyCallbacks();c.isFunction(b)&&(b=new b);c.previous_game_state=
c.game_state;c.game_state=b;c.game_loop=new c.GameLoop(b,{fps:e},d);c.game_loop.start()};c.imageToCanvas=function(c){var b=document.createElement("canvas");b.src=c.src;b.width=c.width;b.height=c.height;b.getContext("2d").drawImage(c,0,0,c.width,c.height);return b};c.forceArray=function(c){return Array.isArray(c)?c:[c]};c.clear=function(){c.context.clearRect(0,0,c.width,c.height)};c.isImage=function(c){return"[object HTMLImageElement]"===Object.prototype.toString.call(c)};c.isCanvas=function(c){return"[object HTMLCanvasElement]"===
Object.prototype.toString.call(c)};c.isDrawable=function(b){return c.isImage(b)||c.isCanvas(b)};c.isString=function(c){return"string"==typeof c};c.isArray=function(c){return c?-1!=c.constructor.toString().indexOf("Array"):!1};c.isFunction=function(c){return"[object Function]"===Object.prototype.toString.call(c)};c.isObject=function(c){return null!=c&&"object"==typeof c};c.isOutsideCanvas=function(b){return 0>b.x||0>b.y||b.x>c.width||b.y>c.height};c.forceInsideCanvas=function(b){0>b.x&&(b.x=0);b.x>
c.width&&(b.x=c.width);0>b.y&&(b.y=0);b.y>c.height&&(b.y=c.height)};c.getUrlParameters=function(){for(var c=[],b,e=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<e.length;d++)b=e[d].split("="),c.push(b[0]),c[b[0]]=b[1];return c};c.parseOptions=function(b,e,d){b.options=e;for(option in e)if(void 0===d[option])throw"Unsupported option '"+option+"' sent to constructor";for(option in d)b[option]=void 0!==e[option]?e[option]:c.clone(d[option])};c.clone=function(b){return c.isArray(b)?
b.slice(0):c.isObject(b)?JSON.parse(JSON.stringify(b)):b};return c}(jaws||{}),jaws=function(c){function b(b){l={}}function e(b){event=b?b:window.event;s[event.keyCode].split(" ").forEach(function(c){l[c]=!1;q[c]&&(q[c](c),b.preventDefault());v[c]&&b.preventDefault()})}function d(b){event=b?b:window.event;s[event.keyCode].split(" ").forEach(function(c){l[c]=!0;t[c]&&(t[c](c),b.preventDefault());v[c]&&b.preventDefault()})}function f(c){event=c?c:window.event;var b=p[event.button];"Microsoft Internet Explorer"==
navigator.appName&&(b=n[event.button]);l[b]=!0;t[b]&&(t[b](b),c.preventDefault())}function g(b){event=b?b:window.event;var c=p[event.button];"Microsoft Internet Explorer"==navigator.appName&&(c=n[event.button]);l[c]=!1;q[c]&&(q[c](c),b.preventDefault())}function m(b){event=b?b:window.event;l.left_mouse_button=!0;c.mouse_x=b.touches[0].pageX-c.canvas.offsetLeft;c.mouse_y=b.touches[0].pageY-c.canvas.offsetTop}function h(b){event=b?b:window.event;l.left_mouse_button=!1;c.mouse_x=void 0;c.mouse_y=void 0}
var l={},r={},s=[],t=[],q=[],p=[],n=[];c.setupInput=function(){var k=[];k[8]="backspace";k[9]="tab";k[13]="enter";k[16]="shift";k[17]="ctrl";k[18]="alt";k[19]="pause";k[20]="capslock";k[27]="esc";k[32]="space";k[33]="pageup";k[34]="pagedown";k[35]="end";k[36]="home";k[37]="left";k[38]="up";k[39]="right";k[40]="down";k[45]="insert";k[46]="delete";k[91]="left_window_key leftwindowkey";k[92]="right_window_key rightwindowkey";k[93]="select_key selectkey";k[106]="multiply *";k[107]="add plus +";k[109]=
"subtract minus -";k[110]="decimalpoint";k[111]="divide /";k[144]="numlock";k[145]="scrollock";k[186]="semicolon ;";k[187]="equalsign =";k[188]="comma ,";k[189]="dash -";k[190]="period .";k[191]="forwardslash /";k[192]="graveaccent `";k[219]="openbracket [";k[220]="backslash \\";k[221]="closebracket ]";k[222]="singlequote '";p=["left_mouse_button","center_mouse_button","right_mouse_button"];n=[,"left_mouse_button","right_mouse_button",,"center_mouse_button"];for(var l="numpad0 numpad1 numpad2 numpad3 numpad4 numpad5 numpad6 numpad7 numpad8 numpad9".split(" "),
q="f1 f2 f3 f4 f5 f6 f7 f8 f9".split(" "),r="0123456789".split(""),t="abcdefghijklmnopqrstuvwxyz".split(""),u=0;r[u];u++)k[48+u]=r[u];for(u=0;t[u];u++)k[65+u]=t[u];for(u=0;l[u];u++)k[96+u]=l[u];for(u=0;q[u];u++)k[112+u]=q[u];s=k;window.addEventListener("keydown",d);window.addEventListener("keyup",e);k=c.canvas||c.dom;k.addEventListener("mousedown",f,!1);k.addEventListener("mouseup",g,!1);k.addEventListener("touchstart",m,!1);k.addEventListener("touchend",h,!1);window.addEventListener("blur",b,!1);
document.oncontextmenu=function(){return!1}};var v=[];c.preventDefaultKeys=function(b){b.forEach(function(b,c){v[b]=!0})};c.pressed=function(b,e){c.isString(b)&&(b=b.split(" "));return e?b.every(function(b){return l[b]}):b.some(function(b){return l[b]})};c.pressedWithoutRepeat=function(b,e){if(c.pressed(b,e)){if(!r[b])return r[b]=!0}else return r[b]=!1};c.on_keydown=function(b,e){if(c.isArray(b))for(var d=0;b[d];d++)t[b[d]]=e;else t[b]=e};c.on_keyup=function(b,e){if(c.isArray(b))for(var d=0;b[d];d++)q[b[d]]=
e;else q[b]=e};c.clearKeyCallbacks=function(){q=[];t=[]};return c}(jaws||{}),jaws=function(c){c.Assets=function(){if(!(this instanceof arguments.callee))return new arguments.callee;this.loaded=[];this.loading=[];this.src_list=[];this.data=[];this.bust_cache=!1;this.fuchia_to_transparent=this.image_to_canvas=!0;this.root="";this.file_type={};this.file_type.json="json";this.file_type.wav="audio";this.file_type.mp3="audio";this.file_type.ogg="audio";this.file_type.png="image";this.file_type.jpg="image";
this.file_type.jpeg="image";this.file_type.gif="image";this.file_type.bmp="image";this.file_type.tiff="image";var b=this;this.length=function(){return this.src_list.length};this.get=function(e){if(c.isArray(e))return e.map(function(c){return b.data[c]});if(this.loaded[e])return this.data[e];c.log("No such asset: "+e,!0)};this.isLoading=function(b){return this.loading[b]};this.isLoaded=function(b){return this.loaded[b]};this.getPostfix=function(b){postfix_regexp=/\.([a-zA-Z0-9]+)/;return postfix_regexp.exec(b)[1]};
this.getType=function(b){b=this.getPostfix(b);return this.file_type[b]?this.file_type[b]:b};this.add=function(b){if(c.isArray(b))for(var d=0;b[d];d++)this.add(b[d]);else this.src_list.push(b);return this};this.loadAll=function(b){this.error_count=this.load_count=0;this.onload=b.onload;this.onerror=b.onerror;this.onfinish=b.onfinish;for(i=0;this.src_list[i];i++)this.load(this.src_list[i])};this.getOrLoad=function(b,c,f){this.data[b]?c():this.load(b,c,f)};this.load=function(b,c,f){var g={};g.src=b;
g.onload=c;g.onerror=f;this.loading[b]=!0;b=this.root+g.src;this.bust_cache&&(b+="?"+parseInt(1E7*Math.random()));switch(this.getType(g.src)){case "image":g.image=new Image;g.image.asset=g;g.image.onload=this.assetLoaded;g.image.onerror=this.assetError;g.image.src=b;break;case "audio":g.audio=new Audio(b);g.audio.asset=g;this.data[g.src]=g.audio;g.audio.addEventListener("canplay",this.assetLoaded,!1);g.audio.addEventListener("error",this.assetError,!1);g.audio.load();break;default:c=new XMLHttpRequest,
c.asset=g,c.onreadystatechange=this.assetLoaded,c.open("GET",b,!0),c.send(null)}};this.assetLoaded=function(e){e=this.asset;var d=e.src,f=b.getType(e.src);b.loaded[d]=!0;b.loading[d]=!1;if("json"==f){if(4!=this.readyState)return;b.data[e.src]=JSON.parse(this.responseText)}else if("image"==f){d=b.image_to_canvas?c.imageToCanvas(e.image):e.image;if(b.fuchia_to_transparent&&"bmp"==b.getPostfix(e.src)){canvas=c.isImage(d)?c.imageToCanvas(d):d;for(var d=canvas.getContext("2d"),f=d.getImageData(0,0,canvas.width,
canvas.height),g=f.data,m=0;m<g.length;m+=4)255==g[m]&&(0==g[m+1]&&255==g[m+2])&&(g[m+3]=0);d.putImageData(f,0,0);d=canvas}b.data[e.src]=d}else"audio"==f&&(e.audio.removeEventListener("canplay",b.assetLoaded,!1),b.data[e.src]=e.audio);b.load_count++;b.processCallbacks(e,!0)};this.assetError=function(c){c=this.asset;b.error_count++;b.processCallbacks(c,!1)};this.processCallbacks=function(c,d){var f=parseInt(100*((b.load_count+b.error_count)/b.src_list.length));if(d){if(b.onload)b.onload(c.src,f);if(c.onload)c.onload()}else{if(b.onerror)b.onerror(c.src,
f);if(c.onerror)c.onerror(c)}if(100==f){if(b.onfinish)b.onfinish();b.onload=null;b.onerror=null;b.onfinish=null}};this.displayProgress=function(b){c.context&&(c.context.save(),c.context.fillStyle="black",c.context.fillRect(0,0,c.width,c.height),c.context.fillStyle="white",c.context.strokeStyle="white",c.context.textAlign="center",c.context.strokeRect(49,c.height/2-30-1,c.width-100+2,62),c.context.fillRect(50,c.height/2-30,(c.width-100)/100*b,60),c.context.font="11px verdana",c.context.fillText("Loading game ... "+
b+"%",c.width/2,c.height/2-35),c.context.font="11px verdana",c.context.fillStyle="#ccc",c.context.textBaseline="bottom",c.context.fillText("powered by www.jawsjs.com",c.width/2,c.height-1),c.context.restore())}};c.assets=new c.Assets;return c}(jaws||{}),jaws=function(c){function b(b){this.size=b;this.values=Array(this.size);this.value;this.add=function(b){if(this.values.length>this.size){this.values.splice(0,1);for(var c=this.value=0;this.values[c];c++)this.value+=this.values[c];this.value/=this.size}this.values.push(b);
return this};this.get=function(){return parseInt(this.value)}}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b,c){window.setTimeout(b,16.666)}}();c.GameLoop=function(e,d,f){if(!(this instanceof arguments.callee))return new arguments.callee(e,d);this.ticks=this.fps=this.tick_duration=0;var g,m=!1,h=!1,l=this,r=new b(20);this.runtime=function(){return this.last_tick-
this.first_tick};this.start=function(){c.log("game loop start",!0);this.first_tick=(new Date).getTime();this.current_tick=(new Date).getTime();this.last_tick=(new Date).getTime();e.setup&&e.setup(f);step_delay=1E3/d.fps;60==d.fps?requestAnimFrame(this.loop):g=setInterval(this.loop,step_delay);c.log("game loop loop",!0)};this.loop=function(){l.current_tick=(new Date).getTime();l.tick_duration=l.current_tick-l.last_tick;l.fps=r.add(1E3/l.tick_duration).get();h||m||(e.update&&e.update(),e.draw&&e.draw(),
l.ticks++);60!=d.fps||h||requestAnimFrame(l.loop);l.last_tick=l.current_tick};this.pause=function(){m=!0};this.unpause=function(){m=!1};this.stop=function(){g&&clearInterval(g);h=!0}};return c}(jaws||{}),jaws=function(c){c.Rect=function(b,c,d,f){if(!(this instanceof arguments.callee))return new arguments.callee(b,c,d,f);this.x=b;this.y=c;this.width=d;this.height=f;this.right=b+d;this.bottom=c+f};c.Rect.prototype.getPosition=function(){return[this.x,this.y]};c.Rect.prototype.move=function(b,c){this.x+=
b;this.y+=c;this.right+=b;this.bottom+=c;return this};c.Rect.prototype.moveTo=function(b,c){this.x=b;this.y=c;this.right=this.x+this.width;this.bottom=this.y+this.height;return this};c.Rect.prototype.resize=function(b,c){this.width+=b;this.height+=c;this.right=this.x+this.width;this.bottom=this.y+this.height;return this};c.Rect.prototype.resizeTo=function(b,c){this.width=b;this.height=c;this.right=this.x+this.width;this.bottom=this.y+this.height;return this};c.Rect.prototype.draw=function(){c.context.strokeStyle=
"red";c.context.strokeRect(this.x,this.y,this.width,this.height);return this};c.Rect.prototype.collidePoint=function(b,c){return b>=this.x&&b<=this.right&&c>=this.y&&c<=this.bottom};c.Rect.prototype.collideRect=function(b){return(this.x>=b.x&&this.x<=b.right||b.x>=this.x&&b.x<=this.right)&&(this.y>=b.y&&this.y<=b.bottom||b.y>=this.y&&b.y<=this.bottom)};c.Rect.prototype.toString=function(){return"[Rect "+this.x+", "+this.y+", "+this.width+", "+this.height+"]"};return c}(jaws||{});
"undefined"!==typeof module&&"exports"in module&&(module.exports=jaws.Rect);
jaws=function(c){c.Sprite=function(b){if(!(this instanceof arguments.callee))return new arguments.callee(b);this.set(b);b.context?this.context=b.context:b.dom&&(this.dom=b.dom,this.createDiv());b.context||b.dom||(c.context?this.context=c.context:(this.dom=c.dom,this.createDiv()))};c.Sprite.prototype.default_options={x:0,y:0,alpha:1,angle:0,flipped:!1,anchor_x:0,anchor_y:0,image:null,image_path:null,anchor:null,scale_image:null,damping:1,scale_x:1,scale_y:1,scale:1,color:null,width:null,height:null,
_constructor:null,dom:null,context:null};c.Sprite.prototype.set=function(b){c.parseOptions(this,b,this.default_options);this.scale&&(this.scale_x=this.scale_y=this.scale);this.image&&this.setImage(this.image);this.scale_image&&this.scaleImage(this.scale_image);this.anchor&&this.setAnchor(this.anchor);!this.image&&(this.color&&this.width&&this.height)&&(b=document.createElement("canvas").getContext("2d"),b.fillStyle=this.color,b.fillRect(0,0,this.width,this.height),this.image=b.getImageData(0,0,this.width,
this.height));this.cacheOffsets();return this};c.Sprite.prototype.clone=function(b){b=new (this._constructor?eval(this._constructor):this.constructor)(this.attributes());b._constructor=this._constructor||this.constructor.name;return b};c.Sprite.prototype.setImage=function(b){var e=this;if(c.isDrawable(b))return this.image=b,this.cacheOffsets();c.assets.isLoaded(b)?(this.image=c.assets.get(b),this.cacheOffsets()):(console.log("WARNING: Image '"+b+"' not preloaded with jaws.assets.add(). Image and a working sprite.rect() will be delayed."),
c.assets.load(b,function(){e.image=c.assets.get(b);e.cacheOffsets()}));return this};c.Sprite.prototype.flip=function(){this.flipped=this.flipped?!1:!0;return this};c.Sprite.prototype.flipTo=function(b){this.flipped=b;return this};c.Sprite.prototype.rotate=function(b){this.angle+=b;return this};c.Sprite.prototype.rotateTo=function(b){this.angle=b;return this};c.Sprite.prototype.moveTo=function(b,c){this.x=b;this.y=c;return this};c.Sprite.prototype.move=function(b,c){b&&(this.x+=b);c&&(this.y+=c);return this};
c.Sprite.prototype.scaleAll=function(b){this.scale_x*=b;this.scale_y*=b;return this.cacheOffsets()};c.Sprite.prototype.scaleTo=function(b){this.scale_x=this.scale_y=b;return this.cacheOffsets()};c.Sprite.prototype.scaleWidth=function(b){this.scale_x*=b;return this.cacheOffsets()};c.Sprite.prototype.scaleHeight=function(b){this.scale_y*=b;return this.cacheOffsets()};c.Sprite.prototype.setX=function(b){this.x=b;return this};c.Sprite.prototype.setY=function(b){this.y=b;return this};c.Sprite.prototype.setTop=
function(b){this.y=b+this.top_offset;return this};c.Sprite.prototype.setBottom=function(b){this.y=b-this.bottom_offset;return this};c.Sprite.prototype.setLeft=function(b){this.x=b+this.left_offset;return this};c.Sprite.prototype.setRight=function(b){this.x=b-this.right_offset;return this};c.Sprite.prototype.setWidth=function(b){this.scale_x=b/this.image.width;return this.cacheOffsets()};c.Sprite.prototype.setHeight=function(b){this.scale_y=b/this.image.height;return this.cacheOffsets()};c.Sprite.prototype.resize=
function(b,c){this.scale_x=(this.width+b)/this.image.width;this.scale_y=(this.height+c)/this.image.height;return this.cacheOffsets()};c.Sprite.prototype.resizeTo=function(b,c){this.scale_x=b/this.image.width;this.scale_y=c/this.image.height;return this.cacheOffsets()};c.Sprite.prototype.setAnchor=function(b){if(a={top_left:[0,0],left_top:[0,0],center_left:[0,0.5],left_center:[0,0.5],bottom_left:[0,1],left_bottom:[0,1],top_center:[0.5,0],center_top:[0.5,0],center_center:[0.5,0.5],center:[0.5,0.5],
bottom_center:[0.5,1],center_bottom:[0.5,1],top_right:[1,0],right_top:[1,0],center_right:[1,0.5],right_center:[1,0.5],bottom_right:[1,1],right_bottom:[1,1]}[b])this.anchor_x=a[0],this.anchor_y=a[1],this.image&&this.cacheOffsets();return this};c.Sprite.prototype.cacheOffsets=function(){if(this.image)return this.width=this.image.width*this.scale_x,this.height=this.image.height*this.scale_y,this.left_offset=this.width*this.anchor_x,this.top_offset=this.height*this.anchor_y,this.right_offset=this.width*
(1-this.anchor_x),this.bottom_offset=this.height*(1-this.anchor_y),this.cached_rect&&this.cached_rect.resizeTo(this.width,this.height),this};c.Sprite.prototype.rect=function(){!this.cached_rect&&this.width&&(this.cached_rect=new c.Rect(this.x,this.y,this.width,this.height));this.cached_rect&&this.cached_rect.moveTo(this.x-this.left_offset,this.y-this.top_offset);return this.cached_rect};c.Sprite.prototype.createDiv=function(){this.div=document.createElement("div");this.div.style.position="absolute";
this.image&&(this.div.style.width=this.image.width+"px",this.div.style.height=this.image.height+"px",this.div.style.backgroundImage=this.image.toDataURL?"url("+this.image.toDataURL()+")":"url("+this.image.src+")");this.dom&&this.dom.appendChild(this.div);this.updateDiv()};c.Sprite.prototype.updateDiv=function(){this.div.style.left=this.x+"px";this.div.style.top=this.y+"px";var b;b=""+("rotate("+this.angle+"deg) ");b=this.flipped?b+("scale(-"+this.scale_x+","+this.scale_y+")"):b+("scale("+this.scale_x+
","+this.scale_y+")");this.div.style.MozTransform=b;this.div.style.WebkitTransform=b;this.div.style.OTransform=b;this.div.style.msTransform=b;this.div.style.transform=b;return this};c.Sprite.prototype.draw=function(){if(!this.image)return this;if(this.dom)return this.updateDiv();this.context.save();this.context.translate(this.x,this.y);0!=this.angle&&c.context.rotate(this.angle*Math.PI/180);this.flipped&&this.context.scale(-1,1);this.context.globalAlpha=this.alpha;this.context.translate(-this.left_offset,
-this.top_offset);this.context.drawImage(this.image,0,0,this.width,this.height);this.context.restore();return this};c.Sprite.prototype.scaleImage=function(b){if(this.image)return this.setImage(c.gfx.retroScaleImage(this.image,b)),this};c.Sprite.prototype.asCanvasContext=function(){var b=document.createElement("canvas");b.width=this.width;b.height=this.height;b=b.getContext("2d");b.mozImageSmoothingEnabled=c.context.mozImageSmoothingEnabled;b.drawImage(this.image,0,0,this.width,this.height);return b};
c.Sprite.prototype.asCanvas=function(){var b=document.createElement("canvas");b.width=this.width;b.height=this.height;var e=b.getContext("2d");e.mozImageSmoothingEnabled=c.context.mozImageSmoothingEnabled;e.drawImage(this.image,0,0,this.width,this.height);return b};c.Sprite.prototype.toString=function(){return"[Sprite "+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width+", "+this.height+"]"};c.Sprite.prototype.attributes=function(){var b=this.options;b._constructor=this._constructor||"jaws.Sprite";
b.x=parseFloat(this.x.toFixed(2));b.y=parseFloat(this.y.toFixed(2));b.image=this.image_path;b.alpha=this.alpha;b.flipped=this.flipped;b.angle=parseFloat(this.angle.toFixed(2));b.scale_x=this.scale_x;b.scale_y=this.scale_y;b.anchor_x=this.anchor_x;b.anchor_y=this.anchor_y;return b};c.Sprite.prototype.toJSON=function(){return JSON.stringify(this.attributes())};return c}(jaws||{});"undefined"!==typeof module&&"exports"in module&&(module.exports=jaws.Sprite);
jaws=function(c){c.SpriteList=function(b){if(!(this instanceof arguments.callee))return new arguments.callee(b);this.sprites=[];this.length=0;b&&this.load(b)};c.SpriteList.prototype.at=function(b){return this.sprites[b]};c.SpriteList.prototype.concat=function(){return this.sprites.concat.apply(this.sprites,arguments)};c.SpriteList.prototype.indexOf=function(b,c){return this.sprites.indexOf(b,c)};c.SpriteList.prototype.join=function(b){return this.sprites.join(b)};c.SpriteList.prototype.lastIndexOf=
function(){return this.sprites.lastIndexOf.apply(this.sprites,arguments)};c.SpriteList.prototype.pop=function(){var b=this.sprites.pop();this.updateLength();return b};c.SpriteList.prototype.push=function(){this.sprites.push.apply(this.sprites,arguments);this.updateLength();return this.length};c.SpriteList.prototype.reverse=function(){this.sprites.reverse()};c.SpriteList.prototype.shift=function(){var b=this.sprites.shift();this.updateLength();return b};c.SpriteList.prototype.slice=function(b,c){return this.sprites.slice(b,
c)};c.SpriteList.prototype.sort=function(){this.sprites.sort.apply(this.sprites,arguments)};c.SpriteList.prototype.splice=function(){var b=this.sprites.splice.apply(this.sprites,arguments);this.updateLength();return b};c.SpriteList.prototype.unshift=function(){this.sprites.unshift.apply(this.sprites,arguments);this.updateLength();return this.length};c.SpriteList.prototype.updateLength=function(){this.length=this.sprites.length};c.SpriteList.prototype.valueOf=function(){return this.toString()};c.SpriteList.prototype.filter=
function(){return this.sprites.filter.apply(this.sprites,arguments)};c.SpriteList.prototype.forEach=function(){this.sprites.forEach.apply(this.sprites,arguments);this.updateLength()};c.SpriteList.prototype.every=function(){return this.sprites.every.apply(this.sprites,arguments)};c.SpriteList.prototype.map=function(){return this.sprites.map.apply(this.sprites,arguments)};c.SpriteList.prototype.reduce=function(){return this.sprites.reduce.apply(this.sprites,arguments)};c.SpriteList.prototype.reduceRight=
function(){return this.sprites.reduceRight.apply(this.sprites,arguments)};c.SpriteList.prototype.some=function(){return this.sprites.some.apply(this.sprites,arguments)};c.SpriteList.prototype.isSpriteList=function(){return!0};c.SpriteList.prototype.load=function(b){function e(b){b.forEach(function(b){var e=b._constructor?eval(b._constructor):b.constructor;c.isFunction(e)&&(c.log("Creating "+b._constructor+"("+b.toString()+")",!0),e=new e(b),e._constructor=b._constructor||b.constructor.name,d.push(e))})}
var d=this;c.isArray(b)?b.every(function(b){return b._constructor})?e(b):this.sprites=b:c.isString(b)&&(e(JSON.parse(b)),console.log(b));this.updateLength()};c.SpriteList.prototype.remove=function(b){b=this.indexOf(b);-1<b&&this.splice(b,1);this.updateLength()};c.SpriteList.prototype.draw=function(){this.forEach(function(b){b.draw()})};c.SpriteList.prototype.drawIf=function(b){this.forEach(function(c){b(c)&&c.draw()})};c.SpriteList.prototype.update=function(){this.forEach(function(b){b.update()})};
c.SpriteList.prototype.updateIf=function(b){this.forEach(function(c){b(c)&&c.update()})};c.SpriteList.prototype.deleteIf=function(b){this.removeIf(b)};c.SpriteList.prototype.removeIf=function(b){this.sprites=this.filter(function(c){return!b(c)});this.updateLength()};c.SpriteList.prototype.toString=function(){return"[SpriteList "+this.length+" sprites]"};return c}(jaws||{});
jaws=function(c){function b(b,c,f,g,m){var h=document.createElement("canvas");h.width=g;h.height=m;h.getContext("2d").drawImage(b,c,f,g,m,0,0,h.width,h.height);return h}c.SpriteSheet=function(e){if(!(this instanceof arguments.callee))return new arguments.callee(e);c.parseOptions(this,e,this.default_options);if(c.isString(this.image)&&!e.frame_size){var d=RegExp("_(\\d+)x(\\d+)","g").exec(this.image);this.frame_size=[];this.frame_size[0]=parseInt(d[1]);this.frame_size[1]=parseInt(d[2])}this.image=
c.isDrawable(this.image)?this.image:c.assets.data[this.image];this.scale_image&&(d=c.isDrawable(this.image)?this.image:c.assets.get(this.image),this.frame_size[0]*=this.scale_image,this.frame_size[1]*=this.scale_image,this.image=c.gfx.retroScaleImage(d,this.scale_image));this.frames=[];if("down"==this.orientation)for(d=this.offset;d<this.image.width;d+=this.frame_size[0])for(var f=0;f<this.image.height;f+=this.frame_size[1])this.frames.push(b(this.image,d,f,this.frame_size[0],this.frame_size[1]));
else for(f=this.offset;f<this.image.height;f+=this.frame_size[1])for(d=0;d<this.image.width;d+=this.frame_size[0])this.frames.push(b(this.image,d,f,this.frame_size[0],this.frame_size[1]))};c.SpriteSheet.prototype.default_options={image:null,orientation:"down",frame_size:[32,32],offset:0,scale_image:null};c.SpriteSheet.prototype.toString=function(){return"[SpriteSheet "+this.frames.length+" frames]"};return c}(jaws||{});
jaws=function(c){c.Parallax=function(b){if(!(this instanceof arguments.callee))return new arguments.callee(b);c.parseOptions(this,b,this.default_options);this.width=b.width||c.width;this.height=b.height||c.height};c.Parallax.prototype.default_options={scale:1,repeat_x:null,repeat_y:null,camera_x:0,camera_y:0,width:null,height:null,layers:[]};c.Parallax.prototype.draw=function(b){for(var c,d=0;d<this.layers.length;d++)for(b=this.layers[d],c=this.repeat_x?-(this.camera_x/b.damping%b.width):-(this.camera_x/
b.damping),b.y=this.repeat_y?-(this.camera_y/b.damping%b.height):-(this.camera_y/b.damping),b.x=c;b.y<this.height;){for(;b.x<this.width&&(0<=b.x+b.width&&0<=b.y+b.height&&b.draw(),b.x+=b.width,this.repeat_x););b.y+=b.height;b.x=c;if(!this.repeat_y)break}};c.Parallax.prototype.addLayer=function(b){b=new c.ParallaxLayer(b);b.scaleAll(this.scale);this.layers.push(b)};c.Parallax.prototype.toString=function(){return"[Parallax "+this.x+", "+this.y+". "+this.layers.length+" layers]"};c.ParallaxLayer=function(b){if(!(this instanceof
arguments.callee))return new arguments.callee(b);this.damping=b.damping||0;c.Sprite.call(this,b)};c.ParallaxLayer.prototype=c.Sprite.prototype;return c}(jaws||{});
jaws=function(c){c.Animation=function(b){if(!(this instanceof arguments.callee))return new arguments.callee(b);c.parseOptions(this,b,this.default_options);if(b.sprite_sheet){var e=new c.SpriteSheet({image:b.sprite_sheet,scale_image:this.scale_image,frame_size:this.frame_size,orientation:this.orientation,offset:this.offset});this.frames=e.frames;this.frame_size=e.frame_size}b.scale_image&&(e=c.isDrawable(b.sprite_sheet)?b.sprite_sheet:c.assets.get(b.sprite_sheet),this.frame_size[0]*=b.scale_image,
this.frame_size[1]*=b.scale_image,b.sprite_sheet=c.gfx.retroScaleImage(e,b.scale_image));this.current_tick=(new Date).getTime();this.last_tick=(new Date).getTime();this.sum_tick=0;if(b.subsets)for(subset in this.subsets={},b.subsets)start_stop=b.subsets[subset],this.subsets[subset]=this.slice(start_stop[0],start_stop[1])};c.Animation.prototype.default_options={frames:[],subsets:[],frame_duration:100,index:0,loop:1,bounce:0,frame_direction:1,frame_size:null,orientation:"down",on_end:null,offset:0,
scale_image:null,sprite_sheet:null};c.Animation.prototype.subset=function(b){return this.subsets[b]};c.Animation.prototype.update=function(){this.current_tick=(new Date).getTime();this.sum_tick+=this.current_tick-this.last_tick;this.last_tick=this.current_tick;this.sum_tick>this.frame_duration&&(this.index+=this.frame_direction,this.sum_tick=0);if(this.index>=this.frames.length||0>this.index)this.bounce?(this.frame_direction=-this.frame_direction,this.index+=2*this.frame_direction):this.loop?this.index=
0>this.frame_direction?this.frames.length-1:0:(this.index-=this.frame_direction,this.on_end&&(this.on_end(),this.on_end=null));return this};c.Animation.prototype.slice=function(b,e){var d={};d.frame_duration=this.frame_duration;d.loop=this.loop;d.bounce=this.bounce;d.on_end=this.on_end;d.frame_direction=this.frame_direction;d.frames=this.frames.slice().slice(b,e);return new c.Animation(d)};c.Animation.prototype.next=function(){this.update();return this.frames[this.index]};c.Animation.prototype.atLastFrame=
function(){return this.index==this.frames.length-1};c.Animation.prototype.atFirstFrame=function(){return 0==this.index};c.Animation.prototype.currentFrame=function(){return this.frames[this.index]};c.Animation.prototype.toString=function(){return"[Animation, "+this.frames.length+" frames]"};return c}(jaws||{});
jaws=function(c){c.Viewport=function(b){if(!(this instanceof arguments.callee))return new arguments.callee(b);c.parseOptions(this,b,this.default_options);this.context||(this.context=c.context);this.width||(this.width=c.width);this.height||(this.height=c.height);this.max_x||(this.max_x=c.width);this.max_y||(this.max_y=c.height);var e=this;this.move=function(b,c){b&&(this.x+=b);c&&(this.y+=c);this.verifyPosition()};this.moveTo=function(b,c){void 0!=b&&(this.x=b);void 0!=c&&(this.y=c);this.verifyPosition()};
this.isOutside=function(b){return!e.isInside(b)};this.isInside=function(b){return b.x>=e.x&&b.x<=e.x+e.width&&b.y>=e.y&&b.y<=e.y+e.height};this.isPartlyInside=function(b){var c=b.rect();return c.right>=e.x&&c.x<=e.x+e.width&&c.bottom>=e.y&&b.y<=e.y+e.height};this.isLeftOf=function(b){return b.x<e.x};this.isRightOf=function(b){return b.x>e.x+e.width};this.isAbove=function(b){return b.y<e.y};this.isBelow=function(b){return b.y>e.y+e.height};this.centerAround=function(b){this.x=Math.floor(b.x-this.width/
2);this.y=Math.floor(b.y-this.height/2);this.verifyPosition()};this.forceInsideVisibleArea=function(b,e){b.x<this.x+e&&(b.x=this.x+e);b.x>this.x+c.width-e&&(b.x=this.x+c.width-e);b.y<this.y+e&&(b.y=this.y+e);b.y>this.y+c.height-e&&(b.y=this.y+c.height-e)};this.forceInside=function(b,c){b.x<c&&(b.x=c);b.x>this.max_x-c&&(b.x=this.max_x-c);b.y<c&&(b.y=c);b.y>this.max_y-c&&(b.y=this.max_y-c)};this.apply=function(b){this.context.save();this.context.translate(-this.x,-this.y);b();this.context.restore()};
this.draw=function(b){this.apply(function(){b.forEach?b.forEach(e.drawIfPartlyInside):b.draw&&e.drawIfPartlyInside(b)})};this.drawTileMap=function(b){var c=b.atRect({x:this.x,y:this.y,right:this.x+this.width,bottom:this.y+this.height});this.apply(function(){for(var b=0;b<c.length;b++)c[b].draw()})};this.drawIfPartlyInside=function(b){e.isPartlyInside(b)&&b.draw()};this.verifyPosition=function(){var b=this.max_x-this.width;0>this.x&&(this.x=0);this.x>b&&(this.x=b);b=this.max_y-this.height;0>this.y&&
(this.y=0);this.y>b&&(this.y=b)};this.moveTo(b.x||0,b.y||0)};c.Viewport.prototype.default_options={context:null,width:null,height:null,max_x:null,max_y:null,x:0,y:0};c.Viewport.prototype.toString=function(){return"[Viewport "+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width+", "+this.height+"]"};return c}(jaws||{});
jaws=function(c){c.TileMap=function(b){if(!(this instanceof arguments.callee))return new arguments.callee(b);c.parseOptions(this,b,this.default_options);this.cells=Array(this.size[0]);for(var e=0;e<this.size[0];e++){this.cells[e]=Array(this.size[1]);for(var d=0;d<this.size[1];d++)this.cells[e][d]=[]}};c.TileMap.prototype.default_options={cell_size:[32,32],size:[100,100],sortFunction:null};c.TileMap.prototype.clear=function(){for(var b=0;b<this.size[0];b++)for(var c=0;c<this.size[1];c++)this.cells[b][c]=
[]};c.TileMap.prototype.sortCells=function(b){for(var c=0;c<this.size[0];c++)for(var d=0;d<this.size[1];d++)this.cells[c][d].sort(b)};c.TileMap.prototype.push=function(b){var c=this;if(b.forEach)return b.forEach(function(b){c.push(b)}),b;if(b.rect)return this.pushAsRect(b,b.rect());var d=parseInt(b.x/this.cell_size[0]),f=parseInt(b.y/this.cell_size[1]);return this.pushToCell(d,f,b)};c.TileMap.prototype.pushAsPoint=function(b){if(Array.isArray(b)){for(var c=0;c<b.length;c++)this.pushAsPoint(b[c]);
return b}var c=parseInt(b.x/this.cell_size[0]),d=parseInt(b.y/this.cell_size[1]);return this.pushToCell(c,d,b)};c.TileMap.prototype.pushAsRect=function(b,c){for(var d=parseInt(c.x/this.cell_size[0]),f=parseInt((c.right-1)/this.cell_size[0]);d<=f;d++)for(var g=parseInt(c.y/this.cell_size[1]),m=parseInt((c.bottom-1)/this.cell_size[1]);g<=m;g++)this.pushToCell(d,g,b);return b};c.TileMap.prototype.pushToCell=function(b,c,d){this.cells[b][c].push(d);this.sortFunction&&this.cells[b][c].sort(this.sortFunction);
return this};c.TileMap.prototype.at=function(b,c){var d=parseInt(b/this.cell_size[0]),f=parseInt(c/this.cell_size[1]);return this.cells[d][f]};c.TileMap.prototype.atRect=function(b){var c=[];try{var d=parseInt(b.x/this.cell_size[0]);0>d&&(d=0);var f=parseInt(b.right/this.cell_size[0]);f>=this.size[0]&&(f=this.size[0]-1);var g=parseInt(b.y/this.cell_size[1]);0>g&&(g=0);var m=parseInt(b.bottom/this.cell_size[1]);m>=this.size[1]&&(m=this.size[1]-1);for(b=d;b<=f;b++)for(d=g;d<=m;d++)this.cells[b][d].forEach(function(b,
d){-1==c.indexOf(b)&&c.push(b)})}catch(h){}return c};c.TileMap.prototype.all=function(){for(var b=[],c=0;c<this.size[0];c++)for(var d=0;d<this.size[1];d++)this.cells[c][d].forEach(function(c,e){b.push(c)});return b};c.TileMap.prototype.cell=function(b,c){return this.cells[b][c]};c.TileMap.prototype.findPath=function(b,c,d){"undefined"==typeof d&&(d=!1);var f=parseInt(b[0]/this.cell_size[0]),g=parseInt(b[1]/this.cell_size[1]),m=parseInt(c[0]/this.cell_size[0]);c=parseInt(c[1]/this.cell_size[1]);if(f===
m&&g===c)return[{x:b[0],y:b[1]}];for(var h=f,l=g,r=0,s=0,t=2*this.size[0]*this.size[1]+1,q=Array(this.size[0]),p=0;p<this.size[0];p++){q[p]=Array(this.size[1]);for(var n=0;n<this.size[1];n++)q[p][n]=!1}q[h][l]={parent:[],G:0,score:t};b=Array(this.size[0]);for(p=0;p<this.size[0];p++)for(b[p]=Array(this.size[1]),n=0;n<this.size[1];n++)b[p][n]=!1;for(;h!==m||l!==c;){n=[];0<h&&n.push([h-1,l]);h<this.size[0]-1&&n.push([h+1,l]);0<l&&n.push([h,l-1]);l<this.size[1]-1&&n.push([h,l+1]);for(p=0;p<n.length;p++){var v=
n[p][0],k=n[p][1];if(s=0===this.cell(v,k).length&&!d||0<this.cell(v,k).length&&d)s=b[v][k]?!0:!1,s=!s;if(s){var s=r+1,w;w=[v,k];var x=[m,c];w=Math.abs(x[0]-w[0])+Math.abs(x[1]-w[1]);s+=w;if(!q[v][k]||q[v][k]&&q[v][k].score>s)q[v][k]={parent:[h,l],G:r+1,score:s}}}l=[];v=[];h=t;for(p=r=0;p<this.size[0];p++)for(n=0;n<this.size[1];n++)q[p][n]&&q[p][n].score<h&&(l=[p,n],v=q[p][n].parent,h=q[p][n].score,r=q[p][n].G);if(0===l.length)return[];q[l[0]][l[1]]=!1;h=l[0];l=l[1];b[h][l]={parent:v}}d=[];m=b[h][l];
for(d.unshift({x:h*this.cell_size[0],y:l*this.cell_size[1]});h!==f||l!==g;)h=m.parent[0],l=m.parent[1],d.unshift({x:h*this.cell_size[0],y:l*this.cell_size[1]}),m=b[h][l];return d};c.TileMap.prototype.lineOfSight=function(b,c,d){"undefined"==typeof d&&(d=!1);var f=b[0],g=c[0];b=b[1];c=c[1];var m=Math.abs(g-f),h=Math.abs(c-b),l,r;l=f<g?1:-1;r=b<c?1:-1;for(var s=m-h,t;f!==g||b!==c;){if(d){if(0===this.at(f,b).length)return!1}else if(0<this.at(f,b).length)return!1;t=2*s;t>-h&&(s-=h,f+=l);t<m&&(s+=m,b+=
r)}return!0};c.TileMap.prototype.toString=function(){return"[TileMap "+this.size[0]+" cols, "+this.size[1]+" rows]"};return c}(jaws||{});"undefined"!==typeof module&&"exports"in module&&(module.exports=jaws.TileMap);
jaws=function(c){function b(b,c){for(var f=function(c){return void 0!==b.isSpriteList?b.at(c):b[c]},g=[],m=Array(c),h=0;h<c;h++)m[h]=h;for(var h=c-1,l=b.length;0<=h;l=b.length){for(g.push(m.map(f));0<=h&&m[h]==l-1;)h--,l--;if(0<=h){m[h]+=1;for(h+=1;h<c;h++)m[h]=m[h-1]+1;h=c-1}}return g}c.collideOneWithOne=function(b,d){return b.radius&&d.radius&&b!==d&&c.collideCircles(b,d)||b.rect&&d.rect&&b!==d&&c.collideRects(b.rect(),d.rect())?!0:!1};c.collideOneWithMany=function(b,d,f){if(f)for(var g=0;g<d.length;g++)c.collideOneWithOne(b,
d[g])&&f(b,d[g]);else return d.filter(function(d){return c.collideOneWithOne(b,d)})};c.collideManyWithMany=function(e,d,f){var g=[];e===d?b(e,2).forEach(function(b){c.collideOneWithOne(b[0],b[1])&&(f?f(b[0],b[1]):g.push([b[0],b[1]]))}):e.forEach(function(b){d.forEach(function(d){c.collideOneWithOne(b,d)&&(f?f(b,d):g.push([b,d]))})});return g};c.collideCircles=function(b,d){return c.distanceBetween(b,d)<b.radius+d.radius};c.collideRects=function(b,c){return(b.x>=c.x&&b.x<=c.right||c.x>=b.x&&c.x<=b.right)&&
(b.y>=c.y&&b.y<=c.bottom||c.y>=b.y&&c.y<=b.bottom)};c.distanceBetween=function(b,c){return Math.sqrt(Math.pow(b.x-c.x,2)+Math.pow(b.y-c.y,2))};c.collide=function(b,d,f){if(b.rect&&d.forEach)return c.collideOneWithMany(b,d,f)===[];if(b.forEach&&d.forEach)return c.collideManyWithMany(b,d,f)===[];if(b.forEach&&d.rect)return c.collideOneWithMany(d,b,f)===[];if(b.rect&&d.rect){var g=c.collideOneWithOne(b,d);if(f&&g)f(b,d);else return g}};return c}(jaws||{});
jaws=function(c){c.gfx={};c.gfx.retroScaleImage=function(b,e){var d=c.isImage(b)?c.imageToCanvas(b):b,d=d.getContext("2d").getImageData(0,0,d.width,d.height).data,f=document.createElement("canvas");f.width=b.width*e;f.height=b.height*e;for(var g=f.getContext("2d"),m=g.createImageData(f.width,f.height),h=m.width,l=m.height,r=0;r<l;r+=1)for(var s=r*m.width,t=Math.floor(r/e)*b.width,q=0;q<h;q+=1){var p=4*(s+q),n=4*(t+Math.floor(q/e));m.data[p]=d[n];m.data[p+1]=d[n+1];m.data[p+2]=d[n+2];m.data[p+3]=d[n+
3]}g.putImageData(m,0,0);return f};return c}(jaws||{});window.addEventListener("load",function(){if(jaws.onload)jaws.onload()},!1);
