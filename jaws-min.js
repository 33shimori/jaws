/* Built at 2013-08-25 11:34:46 +0200 */
var jaws=function(b){function c(e){b.mouse_x=e.pageX||e.clientX;b.mouse_y=e.pageY||e.clientY;e=b.canvas?b.canvas:b.dom;b.mouse_x-=e.offsetLeft;b.mouse_y-=e.offsetTop}var f,g;b.Parallax=function(){b.log.error("To use jaws.Parallax() you need to include src/extras/parallax.js")};b.SpriteList=function(){b.log.error("To use SpriteList() you need to include src/extras/parallax.js")};b.TileMap=function(){b.log.error("To use SteList() you need to include src/extras/parallax.js")};b.SpriteList=function(){b.log.error("To use SpriteList() you need to include src/extras/parallax.js")};
b.PixelMap=function(){b.log.error("To use SpriteList() you need to include src/extras/parallax.js")};b.QuadTree=function(){b.log.error("To use QuadTree() you need to include src/extras/quadtree.js")};b.Audio=function(){b.log.error("To use jaws.Audio() you need to include src/extras/audio.js")};b.title=function(e){if(b.isString(e))return e?f.innerHTML=e:f.innerHTML;b.log.error("jaws.title: Passed in value is not a String.")};b.unpack=function(){"Sprite SpriteList Animation Viewport SpriteSheet Parallax TileMap pressed QuadTree".split(" ").forEach(function(e){window[e]?
b.log.warn("jaws.unpack: "+e+" already exists in global namespace."):window[e]=b[e]})};b.log=function(e,d){b.isString(e)||(e=JSON.stringify(e));b.log.on&&(g&&b.log.use_log_element&&(g.innerHTML=d?g.innerHTML+(e+"<br />"):e),console.log&&b.log.use_console&&console.log("JawsJS: ",e))};b.log.on=!0;b.log.use_console=!1;b.log.use_log_element=!0;b.log.warn=function(e){console.warn&&b.log.use_console&&b.log.on?console.warn(e):b.log("[WARNING]: "+JSON.stringify(e),!0)};b.log.error=function(e){console.error&&
b.log.use_console&&b.log.on?console.error(e):b.log("[ERROR]: "+JSON.stringify(e),!0)};b.log.info=function(e){console.info&&b.log.use_console&&b.log.on?console.info(e):b.log("[INFO]: "+JSON.stringify(e),!0)};b.log.debug=function(e){console.debug&&b.log.use_console&&b.log.on?console.debug(e):b.log("[DEBUG]: "+JSON.stringify(e),!0)};b.log.clear=function(){g&&(g.innerHTML="");console.clear&&console.clear()};b.init=function(e){f=document.getElementsByTagName("title")[0];b.url_parameters=b.getUrlParameters();
g=document.getElementById("jaws-log");b.url_parameters.debug&&!g&&(g=document.createElement("div"),g.id="jaws-log",g.style.cssText="overflow: auto; color: #aaaaaa; width: 300px; height: 150px; margin: 40px auto 0px auto; padding: 5px; border: #444444 1px solid; clear: both; font: 10px verdana; text-align: left;",document.body.appendChild(g));b.url_parameters.bust_cache&&(b.log.info("Busting cache when loading assets"),b.assets.bust_cache=!0);b.canvas=document.getElementsByTagName("canvas")[0];b.canvas||
(b.dom=document.getElementById("canvas"));b.canvas?b.context=b.canvas.getContext("2d"):b.dom?b.dom.style.position="relative":(b.canvas=document.createElement("canvas"),b.canvas.width=e.width,b.canvas.height=e.height,b.context=b.canvas.getContext("2d"),document.body.appendChild(b.canvas));b.context&&b.useCrispScaling();b.width=b.canvas?b.canvas.width:b.dom.offsetWidth;b.height=b.canvas?b.canvas.height:b.dom.offsetHeight;b.mouse_x=0;b.mouse_y=0;window.addEventListener("mousemove",c)};b.useCrispScaling=
function(){b.context.imageSmoothingEnabled=!1;b.context.webkitImageSmoothingEnabled=!1;b.context.mozImageSmoothingEnabled=!1};b.useSmoothScaling=function(){b.context.imageSmoothingEnabled=!0;b.context.webkitImageSmoothingEnabled=!0;b.context.mozImageSmoothingEnabled=!0};b.start=function(e,d,c){function g(e,c){b.log.info(c+"%: "+e,!0);d.loading_screen&&b.assets.displayProgress(c)}function f(e,d){b.log.info(d+"%: Error loading asset "+e,!0)}function q(){b.log.info("all assets loaded",!0);b.switchGameState(e||
window,{fps:v},c)}if(b.isFunction(e))if(b.isObject(c)||void 0===c){d||(d={});var v=d.fps||60;void 0===d.loading_screen&&(d.loading_screen=!0);d.width||(d.width=500);d.height||(d.height=300);b.init(d);d.loading_screen&&b.assets.displayProgress(0);b.log.info("setupInput()",!0);b.setupInput();b.log.info("assets.loadAll()",!0);0<b.assets.length()?b.assets.loadAll({onprogress:g,onerror:f,onload:q}):q()}else b.log.error("jaws.start: The setup options for the game state is not an object.");else b.log.error("jaws.start: Passed in GameState is not a function.")};
b.switchGameState=function(e,d,c){b.isFunction(e)?(e=new e,d=d&&d.fps||b.game_loop&&b.game_loop.fps||60,b.game_loop&&b.game_loop.stop(),b.clearKeyCallbacks(),b.previous_game_state=b.game_state,b.game_state=e,b.game_loop=new b.GameLoop(e,{fps:d},c),b.game_loop.start()):b.log.error("jaws.switchGameState: Passed in GameState is not a function.")};b.imageToCanvas=function(e){if(b.isImage(e)){var d=document.createElement("canvas");d.src=e.src;d.width=e.width;d.height=e.height;d.getContext("2d").drawImage(e,
0,0,e.width,e.height);return d}b.log.error("jaws.imageToCanvas: Passed in object is not an image.")};b.forceArray=function(b){return Array.isArray(b)?b:[b]};b.clear=function(){b.context.clearRect(0,0,b.width,b.height)};b.fill=function(e){b.context.fillStyle=e;b.context.fillRect(0,0,b.width,b.height)};b.draw=function(){var e=arguments;1==e.length&&b.isArray(e[0])&&(e=e[0]);for(var d=0;d<e.length;d++)b.isArray(e[d])?b.draw(e[d]):e[d].draw()};b.update=function(){var e=arguments;1==e.length&&b.isArray(e[0])&&
(e=e[0]);for(var d=0;d<e.length;d++)b.isArray(e[d])?b.update(e[d]):e[d].update()};b.isImage=function(b){return"[object HTMLImageElement]"===Object.prototype.toString.call(b)};b.isCanvas=function(b){return"[object HTMLCanvasElement]"===Object.prototype.toString.call(b)};b.isDrawable=function(e){return b.isImage(e)||b.isCanvas(e)};b.isString=function(b){return"string"===typeof b||"object"===typeof b&&b.constructor===String};b.isNumber=function(b){return!isNaN(parseFloat(b))&&isFinite(b)};b.isArray=
function(b){return b?-1!==b.constructor.toString().indexOf("Array"):!1};b.isObject=function(b){return null!==b&&"object"===typeof b};b.isFunction=function(b){return"[object Function]"===Object.prototype.toString.call(b)};b.isRegExp=function(b){return b instanceof RegExp};b.isOutsideCanvas=function(e){if(e.x&&e.y)return 0>e.x||0>e.y||e.x>b.width||e.y>b.height};b.forceInsideCanvas=function(e){e.x&&e.y&&(0>e.x&&(e.x=0),e.x>b.width&&(e.x=b.width),0>e.y&&(e.y=0),e.y>b.height&&(e.y=b.height))};b.getUrlParameters=
function(){for(var b=[],d,c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),g=0;g<c.length;g++)d=c[g].split("="),b.push(d[0]),b[d[0]]=d[1];return b};b.parseOptions=function(c,d,g){c.options=d;for(var f in d)void 0===g[f]&&b.log.warn("jaws.parseOptions: Unsupported property "+f+"for "+c.constructor);for(f in g)c[f]=void 0!==d[f]?d[f]:b.clone(g[f])};b.clone=function(c){return b.isArray(c)?c.slice(0):b.isObject(c)?JSON.parse(JSON.stringify(c)):c};return b}(jaws||{}),jaws=function(b){function c(b){k=
{}}function f(b){event=b?b:window.event;v[event.keyCode].split(" ").forEach(function(c){k[c]=!1;n[c]&&(n[c](c),b.preventDefault());u[c]&&b.preventDefault()})}function g(b){event=b?b:window.event;v[event.keyCode].split(" ").forEach(function(c){k[c]=!0;m[c]&&(m[c](c),b.preventDefault());u[c]&&b.preventDefault()})}function e(b){event=b?b:window.event;var c=r[event.button];"Microsoft Internet Explorer"==navigator.appName&&(c=s[event.button]);k[c]=!0;m[c]&&(m[c](c),b.preventDefault())}function d(b){event=
b?b:window.event;var c=r[event.button];"Microsoft Internet Explorer"==navigator.appName&&(c=s[event.button]);k[c]=!1;n[c]&&(n[c](c),b.preventDefault())}function l(c){event=c?c:window.event;k.left_mouse_button=!0;b.mouse_x=c.touches[0].pageX-b.canvas.offsetLeft;b.mouse_y=c.touches[0].pageY-b.canvas.offsetTop}function h(c){event=c?c:window.event;k.left_mouse_button=!1;b.mouse_x=void 0;b.mouse_y=void 0}var k={},q={},v=[],m=[],n=[],r=[],s=[];b.setupInput=function(){var k=[];k[8]="backspace";k[9]="tab";
k[13]="enter";k[16]="shift";k[17]="ctrl";k[18]="alt";k[19]="pause";k[20]="capslock";k[27]="esc";k[32]="space";k[33]="pageup";k[34]="pagedown";k[35]="end";k[36]="home";k[37]="left";k[38]="up";k[39]="right";k[40]="down";k[45]="insert";k[46]="delete";k[91]="left_window_key leftwindowkey";k[92]="right_window_key rightwindowkey";k[93]="select_key selectkey";k[106]="multiply *";k[107]="add plus +";k[109]="subtract minus -";k[110]="decimalpoint";k[111]="divide /";k[144]="numlock";k[145]="scrollock";k[186]=
"semicolon ;";k[187]="equalsign =";k[188]="comma ,";k[189]="dash -";k[190]="period .";k[191]="forwardslash /";k[192]="graveaccent `";k[219]="openbracket [";k[220]="backslash \\";k[221]="closebracket ]";k[222]="singlequote '";r=["left_mouse_button","center_mouse_button","right_mouse_button"];s=[,"left_mouse_button","right_mouse_button",,"center_mouse_button"];for(var q="numpad0 numpad1 numpad2 numpad3 numpad4 numpad5 numpad6 numpad7 numpad8 numpad9".split(" "),m="f1 f2 f3 f4 f5 f6 f7 f8 f9".split(" "),
n="0123456789".split(""),u="abcdefghijklmnopqrstuvwxyz".split(""),p=0;n[p];p++)k[48+p]=n[p];for(p=0;u[p];p++)k[65+p]=u[p];for(p=0;q[p];p++)k[96+p]=q[p];for(p=0;m[p];p++)k[112+p]=m[p];v=k;window.addEventListener("keydown",g);window.addEventListener("keyup",f);k=b.canvas||b.dom;k.addEventListener("mousedown",e,!1);k.addEventListener("mouseup",d,!1);k.addEventListener("touchstart",l,!1);k.addEventListener("touchend",h,!1);window.addEventListener("blur",c,!1);document.oncontextmenu=function(){return!1}};
var u=[];b.preventDefaultKeys=function(b){b.forEach(function(b,c){u[b]=!0})};b.pressed=function(c,d){b.isString(c)&&(c=c.split(" "));return d?c.every(function(b){return k[b]}):c.some(function(b){return k[b]})};b.pressedWithoutRepeat=function(c,d){if(b.pressed(c,d)){if(!q[c])return q[c]=!0}else return q[c]=!1};b.on_keydown=function(c,d){if(b.isArray(c))for(var g=0;c[g];g++)m[c[g]]=d;else m[c]=d};b.on_keyup=function(c,d){if(b.isArray(c))for(var g=0;c[g];g++)n[c[g]]=d;else n[c]=d};b.clearKeyCallbacks=
function(){n=[];m=[]};return b}(jaws||{}),jaws=function(b){b.Assets=function(){function c(c){if(b.isString(c))return c=d.getPostfix(c),d.file_type[c]?d.file_type[c]:c;b.log.error("jaws.assets.getType: Argument not a String with "+c)}function f(g){var f=this.asset,v=f.src,l=c(f.src);d.loaded[v]=!0;d.loading[v]=!1;try{if("json"===l){if(4!==this.readyState)return;d.data[f.src]=JSON.parse(this.responseText)}else if("image"===l){var h=d.image_to_canvas?b.imageToCanvas(f.image):f.image;if(d.fuchia_to_transparent&&
"bmp"===d.getPostfix(f.src))if(l=h,b.isDrawable(l)){for(var r=b.isImage(l)?b.imageToCanvas(l):l,s=r.getContext("2d"),u=s.getImageData(0,0,r.width,r.height),t=u.data,l=0;l<t.length;l+=4)255===t[l]&&(0===t[l+1]&&255===t[l+2])&&(t[l+3]=0);s.putImageData(u,0,0);h=r}else h=void 0;d.data[f.src]=h}else"audio"===l&&d.can_play[d.getPostfix(f.src)]?d.data[f.src]=f.audio:"video"===l&&d.can_play[d.getPostfix(f.src)]?d.data[f.src]=f.video:d.data[f.src]=this.response}catch(w){b.log.error("Cannot process "+v+" (Message: "+
w.message+", Name: "+w.name+")"),d.data[f.src]=null}d.load_count++;e(f,!0,g)}function g(b){var c=this.asset;d.error_count++;e(c,!1,b)}function e(b,c,g){var e=parseInt(100*((d.load_count+d.error_count)/d.src_list.length));if(c){if(d.onprogress)d.onprogress(b.src,e);if(b.onprogress)b.onprogress(g)}else{if(d.onerror)d.onerror(b.src,e);if(b.onerror)b.onerror(g)}if(100===e){if(d.onload)d.onload();d.onprogress=null;d.onerror=null;d.onload=null}}if(!(this instanceof arguments.callee))return new arguments.callee;
var d=this;d.loaded=[];d.loading=[];d.src_list=[];d.data=[];d.bust_cache=!1;d.image_to_canvas=!0;d.fuchia_to_transparent=!0;d.root="";d.file_type={};d.file_type.json="json";d.file_type.wav="audio";d.file_type.mp3="audio";d.file_type.ogg="audio";d.file_type.m4a="audio";d.file_type.weba="audio";d.file_type.aac="audio";d.file_type.mka="audio";d.file_type.flac="audio";d.file_type.png="image";d.file_type.jpg="image";d.file_type.jpeg="image";d.file_type.gif="image";d.file_type.bmp="image";d.file_type.tiff=
"image";d.file_type.mp4="video";d.file_type.webm="video";d.file_type.ogv="video";d.file_type.mkv="video";var l=new Audio,h=document.createElement("video");d.can_play={};d.can_play.wav=!!l.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"");d.can_play.ogg=!!l.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"");d.can_play.mp3=!!l.canPlayType("audio/mpeg;").replace(/^no$/,"");d.can_play.m4a=!!(l.canPlayType("audio/x-m4a;")||l.canPlayType("audio/aac;")).replace(/^no$/,"");d.can_play.weba=
!!l.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"");d.can_play.aac=!!l.canPlayType("audio/aac;").replace(/^no$/,"");d.can_play.mka=!!l.canPlayType("audio/x-matroska;").replace(/^no$/,"");d.can_play.flac=!!l.canPlayType("audio/x-flac;").replace(/^no$/,"");d.can_play.mp4=!!h.canPlayType("video/mp4;").replace(/^no$/,"");d.can_play.webm=!!h.canPlayType('video/webm; codecs="vorbis"').replace(/^no$/,"");d.can_play.ogv=!!h.canPlayType('video/ogg; codecs="vorbis"').replace(/^no$/,"");d.can_play.mkv=
!!h.canPlayType("video/x-matroska;").replace(/^no$/,"");d.length=function(){return d.src_list.length};d.setRoot=function(b){d.root=b;return d};d.get=function(c){if(b.isArray(c))return c.map(function(b){return d.data[b]});if(b.isString(c)){if("*"===c[c.length-1])for(var g=c.replace("*",""),e=0;e<d.src_list.length;e++)if(0==d.src_list[e].indexOf(g)&&d.data[d.src_list[e]])return d.data[d.src_list[e]];if(d.data[c])return d.data[c];b.log.warn("No such asset: "+c,!0)}else b.log.error("jaws.get: Neither String nor Array. Incorrect URL resource "+
c)};d.isLoading=function(c){if(b.isString(c))return d.loading[c];b.log.error("jaws.isLoading: Argument not a String with "+c)};d.isLoaded=function(c){if(b.isString(c))return d.loaded[c];b.log.error("jaws.isLoaded: Argument not a String with "+c)};d.getPostfix=function(c){if(b.isString(c))return c.toLowerCase().match(/.+\.([^?]+)(\?|$)/)[1];b.log.error("jaws.assets.getPostfix: Argument not a String with "+c)};d.add=function(c){var g=arguments;1==g.length&&b.isArray(g[0])&&(g=g[0]);for(var e=0;e<g.length;e++)b.isArray(g[e])?
d.add(g[e]):b.isString(g[e])?d.src_list.push(g[e]):b.log.error("jaws.assets.add: Neither String nor Array. Incorrect URL resource "+c);return d};d.loadAll=function(c){d.load_count=0;d.error_count=0;c.onprogress&&b.isFunction(c.onprogress)&&(d.onprogress=c.onprogress);c.onerror&&b.isFunction(c.onerror)&&(d.onerror=c.onerror);c.onload&&b.isFunction(c.onload)&&(d.onload=c.onload);d.src_list.forEach(function(b){d.load(b)});return d};d.load=function(e,l){l||(l={});if(b.isString(e)){var h={},m="";h.src=
e;h.onload=l.onload;h.onerror=l.onerror;d.loading[e]=!0;m=/^((f|ht)tp(s)?:)?\/\//.test(e)?h.src:d.root+h.src;d.bust_cache&&(m+="?"+parseInt(1E7*Math.random()));var n=c(h.src);if("image"===n)try{h.image=new Image,h.image.asset=h,h.image.addEventListener("load",f),h.image.addEventListener("error",g),h.image.src=m}catch(r){b.log.error("Cannot load Image resource "+m+" (Message: "+r.message+", Name: "+r.name+")")}else if(d.can_play[d.getPostfix(h.src)])if("audio"===n)try{h.audio=new Audio,h.audio.asset=
h,h.audio.addEventListener("error",g),h.audio.addEventListener("canplay",f),d.data[h.src]=h.audio,h.audio.src=m,h.audio.load()}catch(s){b.log.error("Cannot load Audio resource "+m+" (Message: "+s.message+", Name: "+s.name+")")}else{if("video"===n)try{h.video=document.createElement("video"),h.video.asset=h,d.data[h.src]=h.video,h.video.setAttribute("style","display:none;"),h.video.addEventListener("error",g),h.video.addEventListener("canplay",f),document.body.appendChild(h.video),h.video.src=m,h.video.load()}catch(u){b.log.error("Cannot load Video resource "+
m+" (Message: "+u.message+", Name: "+u.name+")")}}else try{var t=new XMLHttpRequest;t.asset=h;t.onreadystatechange=f;t.onerror=g;t.open("GET",m,!0);"json"!==n&&(t.responseType="blob");t.send(null)}catch(w){b.log.error("Cannot load "+m+" (Message: "+w.message+", Name: "+w.name+")")}return d}b.log.error("jaws.assets.load: Argument not a String with "+e)};d.displayProgress=function(c){b.isNumber(c)&&b.context&&(b.context.save(),b.context.fillStyle="black",b.context.fillRect(0,0,b.width,b.height),b.context.fillStyle=
"white",b.context.strokeStyle="white",b.context.textAlign="center",b.context.strokeRect(49,b.height/2-30-1,b.width-100+2,62),b.context.fillRect(50,b.height/2-30,(b.width-100)/100*c,60),b.context.font="11px verdana",b.context.fillText("Loading... "+c+"%",b.width/2,b.height/2-35),b.context.font="11px verdana",b.context.fillStyle="#ccc",b.context.textBaseline="bottom",b.context.fillText("powered by www.jawsjs.com",b.width/2,b.height-1),b.context.restore())}};b.assets=new b.Assets;return b}(jaws||{}),
jaws=function(b){function c(b){this.size=b;this.values=Array(this.size);this.value;this.add=function(b){if(this.values.length>this.size){this.values.splice(0,1);for(var c=this.value=0;this.values[c];c++)this.value+=this.values[c];this.value/=this.size}this.values.push(b);return this};this.get=function(){return parseInt(this.value)}}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||
window.msRequestAnimationFrame||function(b,c){window.setTimeout(b,16.666)}}();b.GameLoop=function(f,g,e){if(!(this instanceof arguments.callee))return new arguments.callee(f,g);this.ticks=this.fps=this.tick_duration=0;var d,l=!1,h=!1,k=this,q=new c(20);this.runtime=function(){return this.last_tick-this.first_tick};this.start=function(){b.log.info("Game loop start",!0);this.first_tick=(new Date).getTime();this.current_tick=(new Date).getTime();this.last_tick=(new Date).getTime();f.setup&&f.setup(e);
step_delay=1E3/g.fps;60==g.fps?requestAnimFrame(this.loop):d=setInterval(this.loop,step_delay)};this.loop=function(){k.current_tick=(new Date).getTime();k.tick_duration=k.current_tick-k.last_tick;k.fps=q.add(1E3/k.tick_duration).get();h||l||(f.update&&f.update(),f.draw&&f.draw(),k.ticks++);60!=g.fps||h||requestAnimFrame(k.loop);k.last_tick=k.current_tick};this.pause=function(){l=!0};this.unpause=function(){l=!1};this.stop=function(){d&&clearInterval(d);h=!0}};return b}(jaws||{}),jaws=function(b){b.Rect=
function(b,f,g,e){if(!(this instanceof arguments.callee))return new arguments.callee(b,f,g,e);this.x=b;this.y=f;this.width=g;this.height=e;this.right=b+g;this.bottom=f+e};b.Rect.prototype.getPosition=function(){return[this.x,this.y]};b.Rect.prototype.move=function(b,f){this.x+=b;this.y+=f;this.right+=b;this.bottom+=f;return this};b.Rect.prototype.moveTo=function(b,f){this.x=b;this.y=f;this.right=this.x+this.width;this.bottom=this.y+this.height;return this};b.Rect.prototype.resize=function(b,f){this.width+=
b;this.height+=f;this.right=this.x+this.width;this.bottom=this.y+this.height;return this};b.Rect.prototype.clone=function(){return new b.Rect(this.x,this.y,this.width,this.height)};b.Rect.prototype.shrink=function(b,f){this.x+=b;this.y+=f;this.width-=b+b;this.height-=f+f;this.right=this.x+this.width;this.bottom=this.y+this.height;return this};b.Rect.prototype.resizeTo=function(b,f){this.width=b;this.height=f;this.right=this.x+this.width;this.bottom=this.y+this.height;return this};b.Rect.prototype.draw=
function(){b.context.strokeStyle="red";b.context.strokeRect(this.x,this.y,this.width,this.height);return this};b.Rect.prototype.collidePoint=function(b,f){return b>=this.x&&b<=this.right&&f>=this.y&&f<=this.bottom};b.Rect.prototype.collideRect=function(b){return(this.x>=b.x&&this.x<=b.right||b.x>=this.x&&b.x<=this.right)&&(this.y>=b.y&&this.y<=b.bottom||b.y>=this.y&&b.y<=this.bottom)};b.Rect.prototype.toString=function(){return"[Rect "+this.x+", "+this.y+", "+this.width+", "+this.height+"]"};return b}(jaws||
{});"undefined"!==typeof module&&"exports"in module&&(module.exports=jaws.Rect);
jaws=function(b){b.Sprite=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);this.set(c);c.context?this.context=c.context:c.dom&&(this.dom=c.dom,this.createDiv());c.context||c.dom||(b.context?this.context=b.context:(this.dom=b.dom,this.createDiv()))};b.Sprite.prototype.default_options={x:0,y:0,alpha:1,angle:0,flipped:!1,anchor_x:0,anchor_y:0,image:null,image_path:null,anchor:null,scale_image:null,damping:1,scale_x:1,scale_y:1,scale:1,color:null,width:null,height:null,
_constructor:null,dom:null,context:null};b.Sprite.prototype.set=function(c){b.parseOptions(this,c,this.default_options);this.scale&&(this.scale_x=this.scale_y=this.scale);this.image&&this.setImage(this.image);this.scale_image&&this.scaleImage(this.scale_image);this.anchor&&this.setAnchor(this.anchor);if(!this.image&&this.color&&this.width&&this.height){c=document.createElement("canvas");var f=c.getContext("2d");c.width=this.width;c.height=this.height;f.fillStyle=this.color;f.fillRect(0,0,this.width,
this.height);this.image=c}this.cacheOffsets();return this};b.Sprite.prototype.clone=function(b){b=new (this._constructor?eval(this._constructor):this.constructor)(this.attributes());b._constructor=this._constructor||this.constructor.name;return b};b.Sprite.prototype.setImage=function(c){var f=this;if(b.isDrawable(c))return this.image=c,this.cacheOffsets();b.assets.isLoaded(c)?(this.image=b.assets.get(c),this.cacheOffsets()):(b.log.warn("Image '"+c+"' not preloaded with jaws.assets.add(). Image and a working sprite.rect() will be delayed."),
b.assets.load(c,{onload:function(){f.image=b.assets.get(c);f.cacheOffsets()}}));return this};b.Sprite.prototype.stepToWhile=function(b,f,g){var e=b<this.x?-1:1,d=f<this.y?-1:1;b=parseInt(b);f=parseInt(f);for(var l=!1,h=!1;;)if(!1===l&&(this.x!=b&&(this.x+=e),g(this)||(this.x-=e,l=!0)),!1===h&&(this.y!=f&&(this.y+=d),g(this)||(this.y-=d,h=!0)),(l||this.x==b)&&(h||this.y==f))return{x:l,y:h}};b.Sprite.prototype.flip=function(){this.flipped=this.flipped?!1:!0;return this};b.Sprite.prototype.flipTo=function(b){this.flipped=
b;return this};b.Sprite.prototype.rotate=function(b){this.angle+=b;return this};b.Sprite.prototype.rotateTo=function(b){this.angle=b;return this};b.Sprite.prototype.moveTo=function(b,f){this.x=b;this.y=f;return this};b.Sprite.prototype.move=function(b,f){b&&(this.x+=b);f&&(this.y+=f);return this};b.Sprite.prototype.scaleAll=function(b){this.scale_x*=b;this.scale_y*=b;return this.cacheOffsets()};b.Sprite.prototype.scaleTo=function(b){this.scale_x=this.scale_y=b;return this.cacheOffsets()};b.Sprite.prototype.scaleWidth=
function(b){this.scale_x*=b;return this.cacheOffsets()};b.Sprite.prototype.scaleHeight=function(b){this.scale_y*=b;return this.cacheOffsets()};b.Sprite.prototype.setX=function(b){this.x=b;return this};b.Sprite.prototype.setY=function(b){this.y=b;return this};b.Sprite.prototype.setTop=function(b){this.y=b+this.top_offset;return this};b.Sprite.prototype.setBottom=function(b){this.y=b-this.bottom_offset;return this};b.Sprite.prototype.setLeft=function(b){this.x=b+this.left_offset;return this};b.Sprite.prototype.setRight=
function(b){this.x=b-this.right_offset;return this};b.Sprite.prototype.setWidth=function(b){this.scale_x=b/this.image.width;return this.cacheOffsets()};b.Sprite.prototype.setHeight=function(b){this.scale_y=b/this.image.height;return this.cacheOffsets()};b.Sprite.prototype.resize=function(b,f){this.scale_x=(this.width+b)/this.image.width;this.scale_y=(this.height+f)/this.image.height;return this.cacheOffsets()};b.Sprite.prototype.resizeTo=function(b,f){this.scale_x=b/this.image.width;this.scale_y=
f/this.image.height;return this.cacheOffsets()};b.Sprite.prototype.setAnchor=function(b){if(a={top_left:[0,0],left_top:[0,0],center_left:[0,0.5],left_center:[0,0.5],bottom_left:[0,1],left_bottom:[0,1],top_center:[0.5,0],center_top:[0.5,0],center_center:[0.5,0.5],center:[0.5,0.5],bottom_center:[0.5,1],center_bottom:[0.5,1],top_right:[1,0],right_top:[1,0],center_right:[1,0.5],right_center:[1,0.5],bottom_right:[1,1],right_bottom:[1,1]}[b])this.anchor_x=a[0],this.anchor_y=a[1],this.image&&this.cacheOffsets();
return this};b.Sprite.prototype.cacheOffsets=function(){if(this.image)return this.width=this.image.width*this.scale_x,this.height=this.image.height*this.scale_y,this.left_offset=this.width*this.anchor_x,this.top_offset=this.height*this.anchor_y,this.right_offset=this.width*(1-this.anchor_x),this.bottom_offset=this.height*(1-this.anchor_y),this.cached_rect&&this.cached_rect.resizeTo(this.width,this.height),this};b.Sprite.prototype.rect=function(){!this.cached_rect&&this.width&&(this.cached_rect=new b.Rect(this.x,
this.y,this.width,this.height));this.cached_rect&&this.cached_rect.moveTo(this.x-this.left_offset,this.y-this.top_offset);return this.cached_rect};b.Sprite.prototype.createDiv=function(){this.div=document.createElement("div");this.div.style.position="absolute";this.image&&(this.div.style.width=this.image.width+"px",this.div.style.height=this.image.height+"px",this.div.style.backgroundImage=this.image.toDataURL?"url("+this.image.toDataURL()+")":"url("+this.image.src+")");this.dom&&this.dom.appendChild(this.div);
this.updateDiv()};b.Sprite.prototype.updateDiv=function(){this.div.style.left=this.x+"px";this.div.style.top=this.y+"px";var b;b=""+("rotate("+this.angle+"deg) ");b=this.flipped?b+("scale(-"+this.scale_x+","+this.scale_y+")"):b+("scale("+this.scale_x+","+this.scale_y+")");this.div.style.MozTransform=b;this.div.style.WebkitTransform=b;this.div.style.OTransform=b;this.div.style.msTransform=b;this.div.style.transform=b;return this};b.Sprite.prototype.draw=function(){if(!this.image)return this;if(this.dom)return this.updateDiv();
this.context.save();this.context.translate(this.x,this.y);0!=this.angle&&b.context.rotate(this.angle*Math.PI/180);this.flipped&&this.context.scale(-1,1);this.context.globalAlpha=this.alpha;this.context.translate(-this.left_offset,-this.top_offset);this.context.drawImage(this.image,0,0,this.width,this.height);this.context.restore();return this};b.Sprite.prototype.scaleImage=function(c){if(this.image)return this.setImage(b.gfx.retroScaleImage(this.image,c)),this};b.Sprite.prototype.asCanvasContext=
function(){var c=document.createElement("canvas");c.width=this.width;c.height=this.height;c=c.getContext("2d");b.context&&(c.mozImageSmoothingEnabled=b.context.mozImageSmoothingEnabled);c.drawImage(this.image,0,0,this.width,this.height);return c};b.Sprite.prototype.asCanvas=function(){var c=document.createElement("canvas");c.width=this.width;c.height=this.height;var f=c.getContext("2d");b.context&&(f.mozImageSmoothingEnabled=b.context.mozImageSmoothingEnabled);f.drawImage(this.image,0,0,this.width,
this.height);return c};b.Sprite.prototype.toString=function(){return"[Sprite "+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width+", "+this.height+"]"};b.Sprite.prototype.attributes=function(){var b=this.options;b._constructor=this._constructor||"jaws.Sprite";b.x=parseFloat(this.x.toFixed(2));b.y=parseFloat(this.y.toFixed(2));b.image=this.image_path;b.alpha=this.alpha;b.flipped=this.flipped;b.angle=parseFloat(this.angle.toFixed(2));b.scale_x=this.scale_x;b.scale_y=this.scale_y;b.anchor_x=this.anchor_x;
b.anchor_y=this.anchor_y;return b};b.Sprite.prototype.toJSON=function(){return JSON.stringify(this.attributes())};return b}(jaws||{});"undefined"!==typeof module&&"exports"in module&&(module.exports=jaws.Sprite);
jaws=function(b){function c(b,c,e,d,l){var h=document.createElement("canvas");h.width=d;h.height=l;h.getContext("2d").drawImage(b,c,e,d,l,0,0,h.width,h.height);return h}b.SpriteSheet=function(f){if(!(this instanceof arguments.callee))return new arguments.callee(f);b.parseOptions(this,f,this.default_options);if(b.isString(this.image)&&!f.frame_size){var g=RegExp("_(\\d+)x(\\d+)","g").exec(this.image);this.frame_size=[];this.frame_size[0]=parseInt(g[1]);this.frame_size[1]=parseInt(g[2])}this.image=
b.isDrawable(this.image)?this.image:b.assets.data[this.image];this.scale_image&&(g=b.isDrawable(this.image)?this.image:b.assets.get(this.image),this.frame_size[0]*=this.scale_image,this.frame_size[1]*=this.scale_image,this.image=b.gfx.retroScaleImage(g,this.scale_image));this.frames=[];if("down"==this.orientation)for(g=this.offset;g<this.image.width;g+=this.frame_size[0])for(var e=0;e<this.image.height;e+=this.frame_size[1])this.frames.push(c(this.image,g,e,this.frame_size[0],this.frame_size[1]));
else for(e=this.offset;e<this.image.height;e+=this.frame_size[1])for(g=0;g<this.image.width;g+=this.frame_size[0])this.frames.push(c(this.image,g,e,this.frame_size[0],this.frame_size[1]))};b.SpriteSheet.prototype.default_options={image:null,orientation:"down",frame_size:[32,32],offset:0,scale_image:null};b.SpriteSheet.prototype.toString=function(){return"[SpriteSheet "+this.frames.length+" frames]"};return b}(jaws||{});
jaws=function(b){b.Animation=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);b.parseOptions(this,c,this.default_options);if(c.sprite_sheet){var f=new b.SpriteSheet({image:c.sprite_sheet,scale_image:this.scale_image,frame_size:this.frame_size,orientation:this.orientation,offset:this.offset});this.frames=f.frames;this.frame_size=f.frame_size}c.scale_image&&(f=b.isDrawable(c.sprite_sheet)?c.sprite_sheet:b.assets.get(c.sprite_sheet),this.frame_size[0]*=c.scale_image,
this.frame_size[1]*=c.scale_image,c.sprite_sheet=b.gfx.retroScaleImage(f,c.scale_image));this.current_tick=(new Date).getTime();this.last_tick=(new Date).getTime();this.sum_tick=0;if(c.subsets)for(subset in this.subsets={},c.subsets)start_stop=c.subsets[subset],this.subsets[subset]=this.slice(start_stop[0],start_stop[1])};b.Animation.prototype.default_options={frames:[],subsets:[],frame_duration:100,index:0,loop:1,bounce:0,frame_direction:1,frame_size:null,orientation:"down",on_end:null,offset:0,
scale_image:null,sprite_sheet:null};b.Animation.prototype.subset=function(b){return this.subsets[b]};b.Animation.prototype.update=function(){this.current_tick=(new Date).getTime();this.sum_tick+=this.current_tick-this.last_tick;this.last_tick=this.current_tick;this.sum_tick>this.frame_duration&&(this.index+=this.frame_direction,this.sum_tick=0);if(this.index>=this.frames.length||0>this.index)this.bounce?(this.frame_direction=-this.frame_direction,this.index+=2*this.frame_direction):this.loop?this.index=
0>this.frame_direction?this.frames.length-1:0:(this.index-=this.frame_direction,this.on_end&&(this.on_end(),this.on_end=null));return this};b.Animation.prototype.slice=function(c,f){var g={};g.frame_duration=this.frame_duration;g.loop=this.loop;g.bounce=this.bounce;g.on_end=this.on_end;g.frame_direction=this.frame_direction;g.frames=this.frames.slice().slice(c,f);return new b.Animation(g)};b.Animation.prototype.next=function(){this.update();return this.frames[this.index]};b.Animation.prototype.atLastFrame=
function(){return this.index==this.frames.length-1};b.Animation.prototype.atFirstFrame=function(){return 0==this.index};b.Animation.prototype.currentFrame=function(){return this.frames[this.index]};b.Animation.prototype.toString=function(){return"[Animation, "+this.frames.length+" frames]"};return b}(jaws||{});
jaws=function(b){b.Viewport=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);b.parseOptions(this,c,this.default_options);this.context||(this.context=b.context);this.width||(this.width=b.width);this.height||(this.height=b.height);this.max_x||(this.max_x=b.width);this.max_y||(this.max_y=b.height);var f=this;this.move=function(b,c){b&&(this.x+=b);c&&(this.y+=c);this.verifyPosition()};this.moveTo=function(b,c){void 0!=b&&(this.x=b);void 0!=c&&(this.y=c);this.verifyPosition()};
this.isOutside=function(b){return!f.isInside(b)};this.isInside=function(b){return b.x>=f.x&&b.x<=f.x+f.width&&b.y>=f.y&&b.y<=f.y+f.height};this.isPartlyInside=function(b){var c=b.rect();return c.right>=f.x&&c.x<=f.x+f.width&&c.bottom>=f.y&&b.y<=f.y+f.height};this.isLeftOf=function(b){return b.x<f.x};this.isRightOf=function(b){return b.x>f.x+f.width};this.isAbove=function(b){return b.y<f.y};this.isBelow=function(b){return b.y>f.y+f.height};this.centerAround=function(b){this.x=Math.floor(b.x-this.width/
2);this.y=Math.floor(b.y-this.height/2);this.verifyPosition()};this.forceInsideVisibleArea=function(c,e){c.x<this.x+e&&(c.x=this.x+e);c.x>this.x+b.width-e&&(c.x=this.x+b.width-e);c.y<this.y+e&&(c.y=this.y+e);c.y>this.y+b.height-e&&(c.y=this.y+b.height-e)};this.forceInside=function(b,c){b.x<c&&(b.x=c);b.x>this.max_x-c&&(b.x=this.max_x-c);b.y<c&&(b.y=c);b.y>this.max_y-c&&(b.y=this.max_y-c)};this.apply=function(b){this.context.save();this.context.translate(-this.x,-this.y);b();this.context.restore()};
this.draw=function(b){this.apply(function(){b.forEach?b.forEach(f.drawIfPartlyInside):b.draw&&f.drawIfPartlyInside(b)})};this.drawTileMap=function(b){var c=b.atRect({x:this.x,y:this.y,right:this.x+this.width,bottom:this.y+this.height});this.apply(function(){for(var b=0;b<c.length;b++)c[b].draw()})};this.drawIfPartlyInside=function(b){f.isPartlyInside(b)&&b.draw()};this.verifyPosition=function(){var b=this.max_x-this.width;0>this.x&&(this.x=0);this.x>b&&(this.x=b);b=this.max_y-this.height;0>this.y&&
(this.y=0);this.y>b&&(this.y=b)};this.moveTo(c.x||0,c.y||0)};b.Viewport.prototype.default_options={context:null,width:null,height:null,max_x:null,max_y:null,x:0,y:0};b.Viewport.prototype.toString=function(){return"[Viewport "+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width+", "+this.height+"]"};return b}(jaws||{});
jaws=function(b){function c(b,c){for(var e=function(c){return void 0!==b.isSpriteList?b.at(c):b[c]},d=[],l=Array(c),h=0;h<c;h++)l[h]=h;for(var h=c-1,k=b.length;0<=h;k=b.length){for(d.push(l.map(e));0<=h&&l[h]==k-1;)h--,k--;if(0<=h){l[h]+=1;for(h+=1;h<c;h++)l[h]=l[h-1]+1;h=c-1}}return d}b.collideOneWithOne=function(c,g){return c.radius&&g.radius&&c!==g&&b.collideCircles(c,g)||c.rect&&g.rect&&c!==g&&b.collideRects(c.rect(),g.rect())?!0:!1};b.collideOneWithMany=function(c,g,e){if(e)for(var d=0;d<g.length;d++)b.collideOneWithOne(c,
g[d])&&e(c,g[d]);else return g.filter(function(d){return b.collideOneWithOne(c,d)})};b.collideManyWithMany=function(f,g,e){var d=[];f===g?c(f,2).forEach(function(c){b.collideOneWithOne(c[0],c[1])&&(e?e(c[0],c[1]):d.push([c[0],c[1]]))}):f.forEach(function(c){g.forEach(function(f){b.collideOneWithOne(c,f)&&(e?e(c,f):d.push([c,f]))})});return d};b.collideCircles=function(c,g){return b.distanceBetween(c,g)<c.radius+g.radius};b.collideRects=function(b,c){return(b.x>=c.x&&b.x<=c.right||c.x>=b.x&&c.x<=b.right)&&
(b.y>=c.y&&b.y<=c.bottom||c.y>=b.y&&c.y<=b.bottom)};b.distanceBetween=function(b,c){return Math.sqrt(Math.pow(b.x-c.x,2)+Math.pow(b.y-c.y,2))};b.collide=function(c,g,e){if(c.rect&&g.forEach)return b.collideOneWithMany(c,g,e)===[];if(c.forEach&&g.forEach)return b.collideManyWithMany(c,g,e)===[];if(c.forEach&&g.rect)return b.collideOneWithMany(g,c,e)===[];if(c.rect&&g.rect){var d=b.collideOneWithOne(c,g);if(e&&d)e(c,g);else return d}};return b}(jaws||{});
jaws=function(b){b.gfx={};b.gfx.retroScaleImage=function(c,f){var g=b.isImage(c)?b.imageToCanvas(c):c,g=g.getContext("2d").getImageData(0,0,g.width,g.height).data,e=document.createElement("canvas");e.width=c.width*f;e.height=c.height*f;for(var d=e.getContext("2d"),l=d.createImageData(e.width,e.height),h=l.width,k=l.height,q=0;q<k;q+=1)for(var v=q*l.width,m=Math.floor(q/f)*c.width,n=0;n<h;n+=1){var r=4*(v+n),s=4*(m+Math.floor(n/f));l.data[r]=g[s];l.data[r+1]=g[s+1];l.data[r+2]=g[s+2];l.data[r+3]=g[s+
3]}d.putImageData(l,0,0);return e};return b}(jaws||{});window.addEventListener("load",function(){if(jaws.onload)jaws.onload()},!1);
