/* Built at 2013-08-24 16:24:16 +0200 */
var jaws=function(b){function c(c){b.mouse_x=c.pageX||c.clientX;b.mouse_y=c.pageY||c.clientY;c=b.canvas?b.canvas:b.dom;b.mouse_x-=c.offsetLeft;b.mouse_y-=c.offsetTop}var d,e;b.title=function(c){if(b.isString(c))return c?d.innerHTML=c:d.innerHTML;b.log.error("jaws.title: Passed in value is not a String.")};b.unpack=function(){"Sprite SpriteList Animation Viewport SpriteSheet Parallax TileMap pressed QuadTree".split(" ").forEach(function(c){window[c]?b.log.warn("jaws.unpack: "+c+" already exists in global namespace."):
window[c]=b[c]})};b.log=function(c,d){b.isString(c)||(c=JSON.stringify(c));b.log.on&&(e&&b.log.use_log_element&&(e.innerHTML=d?e.innerHTML+(c+"<br />"):c),console.log&&b.log.use_console&&console.log("JawsJS: ",c))};b.log.on=!0;b.log.use_console=!1;b.log.use_log_element=!0;b.log.warn=function(c){console.warn&&b.log.use_console&&b.log.on?console.warn(c):b.log("[WARNING]: "+JSON.stringify(c),!0)};b.log.error=function(c){console.error&&b.log.use_console&&b.log.on?console.error(c):b.log("[ERROR]: "+JSON.stringify(c),
!0)};b.log.info=function(c){console.info&&b.log.use_console&&b.log.on?console.info(c):b.log("[INFO]: "+JSON.stringify(c),!0)};b.log.debug=function(c){console.debug&&b.log.use_console&&b.log.on?console.debug(c):b.log("[DEBUG]: "+JSON.stringify(c),!0)};b.log.clear=function(){e&&(e.innerHTML="");console.clear&&console.clear()};b.init=function(l){d=document.getElementsByTagName("title")[0];b.url_parameters=b.getUrlParameters();e=document.getElementById("jaws-log");b.url_parameters.debug&&!e&&(e=document.createElement("div"),
e.id="jaws-log",e.style.cssText="overflow: auto; color: #aaaaaa; width: 300px; height: 150px; margin: 40px auto 0px auto; padding: 5px; border: #444444 1px solid; clear: both; font: 10px verdana; text-align: left;",document.body.appendChild(e));b.url_parameters.bust_cache&&(b.log.info("Busting cache when loading assets"),b.assets.bust_cache=!0);b.canvas=document.getElementsByTagName("canvas")[0];b.canvas||(b.dom=document.getElementById("canvas"));b.canvas?b.context=b.canvas.getContext("2d"):b.dom?
b.dom.style.position="relative":(b.canvas=document.createElement("canvas"),b.canvas.width=l.width,b.canvas.height=l.height,b.context=b.canvas.getContext("2d"),document.body.appendChild(b.canvas));b.context&&b.useCrispScaling();b.width=b.canvas?b.canvas.width:b.dom.offsetWidth;b.height=b.canvas?b.canvas.height:b.dom.offsetHeight;b.mouse_x=0;b.mouse_y=0;window.addEventListener("mousemove",c)};b.useCrispScaling=function(){b.context.imageSmoothingEnabled=!1;b.context.webkitImageSmoothingEnabled=!1;b.context.mozImageSmoothingEnabled=
!1};b.useSmoothScaling=function(){b.context.imageSmoothingEnabled=!0;b.context.webkitImageSmoothingEnabled=!0;b.context.mozImageSmoothingEnabled=!0};b.start=function(c,e,d){function k(c,d){b.log.info(d+"%: "+c,!0);e.loading_screen&&b.assets.displayProgress(d)}function g(c,e){b.log.info(e+"%: Error loading asset "+c,!0)}function q(){b.log.info("all assets loaded",!0);b.switchGameState(c||window,{fps:r},d)}if(b.isFunction(c))if(b.isObject(d)||void 0===d){e||(e={});var r=e.fps||60;void 0===e.loading_screen&&
(e.loading_screen=!0);e.width||(e.width=500);e.height||(e.height=300);b.init(e);e.loading_screen&&b.assets.displayProgress(0);b.log.info("setupInput()",!0);b.setupInput();b.log.info("assets.loadAll()",!0);0<b.assets.length()?b.assets.loadAll({onprogress:k,onerror:g,onload:q}):q()}else b.log.error("jaws.start: The setup options for the game state is not an object.");else b.log.error("jaws.start: Passed in GameState is not a function.")};b.switchGameState=function(c,e,d){b.isFunction(c)?(c=new c,e=
e&&e.fps||b.game_loop&&b.game_loop.fps||60,b.game_loop&&b.game_loop.stop(),b.clearKeyCallbacks(),b.previous_game_state=b.game_state,b.game_state=c,b.game_loop=new b.GameLoop(c,{fps:e},d),b.game_loop.start()):b.log.error("jaws.switchGameState: Passed in GameState is not a function.")};b.imageToCanvas=function(c){if(b.isImage(c)){var e=document.createElement("canvas");e.src=c.src;e.width=c.width;e.height=c.height;e.getContext("2d").drawImage(c,0,0,c.width,c.height);return e}b.log.error("jaws.imageToCanvas: Passed in object is not an image.")};
b.forceArray=function(b){return Array.isArray(b)?b:[b]};b.clear=function(){b.context.clearRect(0,0,b.width,b.height)};b.isImage=function(b){return"[object HTMLImageElement]"===Object.prototype.toString.call(b)};b.isCanvas=function(b){return"[object HTMLCanvasElement]"===Object.prototype.toString.call(b)};b.isDrawable=function(c){return b.isImage(c)||b.isCanvas(c)};b.isString=function(b){return"string"===typeof b||"object"===typeof b&&b.constructor===String};b.isNumber=function(b){return!isNaN(parseFloat(b))&&
isFinite(b)};b.isArray=function(b){return b?-1!==b.constructor.toString().indexOf("Array"):!1};b.isObject=function(b){return null!==b&&"object"===typeof b};b.isFunction=function(b){return"[object Function]"===Object.prototype.toString.call(b)};b.isRegExp=function(b){return b instanceof RegExp};b.isOutsideCanvas=function(c){if(c.x&&c.y)return 0>c.x||0>c.y||c.x>b.width||c.y>b.height};b.forceInsideCanvas=function(c){c.x&&c.y&&(0>c.x&&(c.x=0),c.x>b.width&&(c.x=b.width),0>c.y&&(c.y=0),c.y>b.height&&(c.y=
b.height))};b.getUrlParameters=function(){for(var b=[],c,e=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<e.length;d++)c=e[d].split("="),b.push(c[0]),b[c[0]]=c[1];return b};b.parseOptions=function(c,e,d){c.options=e;for(var k in e)void 0===d[k]&&b.log.warn("jaws.parseOptions: Unsupported property "+k+"for "+c.constructor);for(k in d)c[k]=void 0!==e[k]?e[k]:b.clone(d[k])};b.clone=function(c){return b.isArray(c)?c.slice(0):b.isObject(c)?JSON.parse(JSON.stringify(c)):
c};return b}(jaws||{}),jaws=function(b){function c(b){g={}}function d(b){event=b?b:window.event;r[event.keyCode].split(" ").forEach(function(c){g[c]=!1;m[c]&&(m[c](c),b.preventDefault());s[c]&&b.preventDefault()})}function e(b){event=b?b:window.event;r[event.keyCode].split(" ").forEach(function(c){g[c]=!0;u[c]&&(u[c](c),b.preventDefault());s[c]&&b.preventDefault()})}function l(b){event=b?b:window.event;var c=n[event.button];"Microsoft Internet Explorer"==navigator.appName&&(c=p[event.button]);g[c]=
!0;u[c]&&(u[c](c),b.preventDefault())}function f(b){event=b?b:window.event;var c=n[event.button];"Microsoft Internet Explorer"==navigator.appName&&(c=p[event.button]);g[c]=!1;m[c]&&(m[c](c),b.preventDefault())}function h(c){event=c?c:window.event;g.left_mouse_button=!0;b.mouse_x=c.touches[0].pageX-b.canvas.offsetLeft;b.mouse_y=c.touches[0].pageY-b.canvas.offsetTop}function k(c){event=c?c:window.event;g.left_mouse_button=!1;b.mouse_x=void 0;b.mouse_y=void 0}var g={},q={},r=[],u=[],m=[],n=[],p=[];b.setupInput=
function(){var g=[];g[8]="backspace";g[9]="tab";g[13]="enter";g[16]="shift";g[17]="ctrl";g[18]="alt";g[19]="pause";g[20]="capslock";g[27]="esc";g[32]="space";g[33]="pageup";g[34]="pagedown";g[35]="end";g[36]="home";g[37]="left";g[38]="up";g[39]="right";g[40]="down";g[45]="insert";g[46]="delete";g[91]="left_window_key leftwindowkey";g[92]="right_window_key rightwindowkey";g[93]="select_key selectkey";g[106]="multiply *";g[107]="add plus +";g[109]="subtract minus -";g[110]="decimalpoint";g[111]="divide /";
g[144]="numlock";g[145]="scrollock";g[186]="semicolon ;";g[187]="equalsign =";g[188]="comma ,";g[189]="dash -";g[190]="period .";g[191]="forwardslash /";g[192]="graveaccent `";g[219]="openbracket [";g[220]="backslash \\";g[221]="closebracket ]";g[222]="singlequote '";n=["left_mouse_button","center_mouse_button","right_mouse_button"];p=[,"left_mouse_button","right_mouse_button",,"center_mouse_button"];for(var q="numpad0 numpad1 numpad2 numpad3 numpad4 numpad5 numpad6 numpad7 numpad8 numpad9".split(" "),
u="f1 f2 f3 f4 f5 f6 f7 f8 f9".split(" "),m="0123456789".split(""),s="abcdefghijklmnopqrstuvwxyz".split(""),v=0;m[v];v++)g[48+v]=m[v];for(v=0;s[v];v++)g[65+v]=s[v];for(v=0;q[v];v++)g[96+v]=q[v];for(v=0;u[v];v++)g[112+v]=u[v];r=g;window.addEventListener("keydown",e);window.addEventListener("keyup",d);g=b.canvas||b.dom;g.addEventListener("mousedown",l,!1);g.addEventListener("mouseup",f,!1);g.addEventListener("touchstart",h,!1);g.addEventListener("touchend",k,!1);window.addEventListener("blur",c,!1);
document.oncontextmenu=function(){return!1}};var s=[];b.preventDefaultKeys=function(b){b.forEach(function(b,c){s[b]=!0})};b.pressed=function(c,e){b.isString(c)&&(c=c.split(" "));return e?c.every(function(b){return g[b]}):c.some(function(b){return g[b]})};b.pressedWithoutRepeat=function(c,e){if(b.pressed(c,e)){if(!q[c])return q[c]=!0}else return q[c]=!1};b.on_keydown=function(c,e){if(b.isArray(c))for(var d=0;c[d];d++)u[c[d]]=e;else u[c]=e};b.on_keyup=function(c,e){if(b.isArray(c))for(var d=0;c[d];d++)m[c[d]]=
e;else m[c]=e};b.clearKeyCallbacks=function(){m=[];u=[]};return b}(jaws||{}),jaws=function(b){b.Assets=function(){function c(c){if(b.isString(c))return c=f.getPostfix(c),f.file_type[c]?f.file_type[c]:c;b.log.error("jaws.assets.getType: Argument not a String with "+c)}function d(e){var d=this.asset,k=d.src,h=c(d.src);f.loaded[k]=!0;f.loading[k]=!1;try{if("json"===h){if(4!==this.readyState)return;f.data[d.src]=JSON.parse(this.responseText)}else if("image"===h){var m=f.image_to_canvas?b.imageToCanvas(d.image):
d.image;if(f.fuchia_to_transparent&&"bmp"===f.getPostfix(d.src))if(h=m,b.isDrawable(h)){for(var n=b.isImage(h)?b.imageToCanvas(h):h,p=n.getContext("2d"),s=p.getImageData(0,0,n.width,n.height),t=s.data,h=0;h<t.length;h+=4)255===t[h]&&(0===t[h+1]&&255===t[h+2])&&(t[h+3]=0);p.putImageData(s,0,0);m=n}else m=void 0;f.data[d.src]=m}else"audio"===h&&f.can_play[f.getPostfix(d.src)]?f.data[d.src]=d.audio:"video"===h&&f.can_play[f.getPostfix(d.src)]?f.data[d.src]=d.video:f.data[d.src]=this.response}catch(w){b.log.error("Cannot process "+
k+" (Message: "+w.message+", Name: "+w.name+")"),f.data[d.src]=null}f.load_count++;l(d,!0,e)}function e(b){var c=this.asset;f.error_count++;l(c,!1,b)}function l(b,c,e){var d=parseInt(100*((f.load_count+f.error_count)/f.src_list.length));if(c){if(f.onprogress)f.onprogress(b.src,d);if(b.onprogress)b.onprogress(e)}else{if(f.onerror)f.onerror(b.src,d);if(b.onerror)b.onerror(e)}if(100===d){if(f.onload)f.onload();f.onprogress=null;f.onerror=null;f.onload=null}}if(!(this instanceof arguments.callee))return new arguments.callee;
var f=this;f.loaded=[];f.loading=[];f.src_list=[];f.data=[];f.bust_cache=!1;f.image_to_canvas=!0;f.fuchia_to_transparent=!0;f.root="";f.file_type={};f.file_type.json="json";f.file_type.wav="audio";f.file_type.mp3="audio";f.file_type.ogg="audio";f.file_type.m4a="audio";f.file_type.weba="audio";f.file_type.aac="audio";f.file_type.mka="audio";f.file_type.flac="audio";f.file_type.png="image";f.file_type.jpg="image";f.file_type.jpeg="image";f.file_type.gif="image";f.file_type.bmp="image";f.file_type.tiff=
"image";f.file_type.mp4="video";f.file_type.webm="video";f.file_type.ogv="video";f.file_type.mkv="video";var h=new Audio,k=document.createElement("video");f.can_play={};f.can_play.wav=!!h.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"");f.can_play.ogg=!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"");f.can_play.mp3=!!h.canPlayType("audio/mpeg;").replace(/^no$/,"");f.can_play.m4a=!!(h.canPlayType("audio/x-m4a;")||h.canPlayType("audio/aac;")).replace(/^no$/,"");f.can_play.weba=
!!h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"");f.can_play.aac=!!h.canPlayType("audio/aac;").replace(/^no$/,"");f.can_play.mka=!!h.canPlayType("audio/x-matroska;").replace(/^no$/,"");f.can_play.flac=!!h.canPlayType("audio/x-flac;").replace(/^no$/,"");f.can_play.mp4=!!k.canPlayType("video/mp4;").replace(/^no$/,"");f.can_play.webm=!!k.canPlayType('video/webm; codecs="vorbis"').replace(/^no$/,"");f.can_play.ogv=!!k.canPlayType('video/ogg; codecs="vorbis"').replace(/^no$/,"");f.can_play.mkv=
!!k.canPlayType("video/x-matroska;").replace(/^no$/,"");f.length=function(){return f.src_list.length};f.get=function(c){if(b.isArray(c))return c.map(function(b){return f.data[b]});if(b.isString(c)){if("*"===c[c.length-1])for(var e=c.replace("*",""),d=0;d<f.src_list.length;d++)if(0==f.src_list[d].indexOf(e)&&f.data[f.src_list[d]])return f.data[f.src_list[d]];if(f.data[c])return f.data[c];b.log.warn("No such asset: "+c,!0)}else b.log.error("jaws.get: Neither String nor Array. Incorrect URL resource "+
c)};f.isLoading=function(c){if(b.isString(c))return f.loading[c];b.log.error("jaws.isLoading: Argument not a String with "+c)};f.isLoaded=function(c){if(b.isString(c))return f.loaded[c];b.log.error("jaws.isLoaded: Argument not a String with "+c)};f.getPostfix=function(c){if(b.isString(c))return c.toLowerCase().match(/.+\.([^?]+)(\?|$)/)[1];b.log.error("jaws.assets.getPostfix: Argument not a String with "+c)};f.add=function(c){b.isArray(c)?c.forEach(function(c){f.add(c)}):b.isString(c)?f.src_list.push(c):
b.log.error("jaws.assets.add: Neither String nor Array. Incorrect URL resource "+c)};f.loadAll=function(c){f.load_count=0;f.error_count=0;c.onprogress&&b.isFunction(c.onprogress)&&(f.onprogress=c.onprogress);c.onerror&&b.isFunction(c.onerror)&&(f.onerror=c.onerror);c.onload&&b.isFunction(c.onload)&&(f.onload=c.onload);f.src_list.forEach(function(c){f.load(c)})};f.load=function(g,l){l||(l={});if(b.isString(g)){var h={},k="";h.src=g;h.onload=l.onload;h.onerror=l.onerror;f.loading[g]=!0;k=/^((f|ht)tp(s)?:)?\/\//.test(g)?
h.src:f.root+h.src;f.bust_cache&&(k+="?"+parseInt(1E7*Math.random()));var m=c(h.src);if("image"===m)try{h.image=new Image,h.image.asset=h,h.image.addEventListener("load",d),h.image.addEventListener("error",e),h.image.src=k}catch(n){b.log.error("Cannot load Image resource "+k+" (Message: "+n.message+", Name: "+n.name+")")}else if(f.can_play[f.getPostfix(h.src)])if("audio"===m)try{h.audio=new Audio,h.audio.asset=h,h.audio.addEventListener("error",e),h.audio.addEventListener("canplay",d),f.data[h.src]=
h.audio,h.audio.src=k,h.audio.load()}catch(p){b.log.error("Cannot load Audio resource "+k+" (Message: "+p.message+", Name: "+p.name+")")}else{if("video"===m)try{h.video=document.createElement("video"),h.video.asset=h,f.data[h.src]=h.video,h.video.setAttribute("style","display:none;"),h.video.addEventListener("error",e),h.video.addEventListener("canplay",d),document.body.appendChild(h.video),h.video.src=k,h.video.load()}catch(s){b.log.error("Cannot load Video resource "+k+" (Message: "+s.message+", Name: "+
s.name+")")}}else try{var t=new XMLHttpRequest;t.asset=h;t.onreadystatechange=d;t.onerror=e;t.open("GET",k,!0);"json"!==m&&(t.responseType="blob");t.send(null)}catch(w){b.log.error("Cannot load "+k+" (Message: "+w.message+", Name: "+w.name+")")}}else b.log.error("jaws.assets.load: Argument not a String with "+g)};f.displayProgress=function(c){b.isNumber(c)&&b.context&&(b.context.save(),b.context.fillStyle="black",b.context.fillRect(0,0,b.width,b.height),b.context.fillStyle="white",b.context.strokeStyle=
"white",b.context.textAlign="center",b.context.strokeRect(49,b.height/2-30-1,b.width-100+2,62),b.context.fillRect(50,b.height/2-30,(b.width-100)/100*c,60),b.context.font="11px verdana",b.context.fillText("Loading... "+c+"%",b.width/2,b.height/2-35),b.context.font="11px verdana",b.context.fillStyle="#ccc",b.context.textBaseline="bottom",b.context.fillText("powered by www.jawsjs.com",b.width/2,b.height-1),b.context.restore())}};b.assets=new b.Assets;return b}(jaws||{}),jaws=function(b){function c(c){this.size=
c;this.values=Array(this.size);this.value;this.add=function(c){if(this.values.length>this.size){this.values.splice(0,1);for(var b=this.value=0;this.values[b];b++)this.value+=this.values[b];this.value/=this.size}this.values.push(c);return this};this.get=function(){return parseInt(this.value)}}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c,
b){window.setTimeout(c,16.666)}}();b.GameLoop=function(d,e,l){if(!(this instanceof arguments.callee))return new arguments.callee(d,e);this.ticks=this.fps=this.tick_duration=0;var f,h=!1,k=!1,g=this,q=new c(20);this.runtime=function(){return this.last_tick-this.first_tick};this.start=function(){b.log.info("Game loop start",!0);this.first_tick=(new Date).getTime();this.current_tick=(new Date).getTime();this.last_tick=(new Date).getTime();d.setup&&d.setup(l);step_delay=1E3/e.fps;60==e.fps?requestAnimFrame(this.loop):
f=setInterval(this.loop,step_delay)};this.loop=function(){g.current_tick=(new Date).getTime();g.tick_duration=g.current_tick-g.last_tick;g.fps=q.add(1E3/g.tick_duration).get();k||h||(d.update&&d.update(),d.draw&&d.draw(),g.ticks++);60!=e.fps||k||requestAnimFrame(g.loop);g.last_tick=g.current_tick};this.pause=function(){h=!0};this.unpause=function(){h=!1};this.stop=function(){f&&clearInterval(f);k=!0}};return b}(jaws||{}),jaws=function(b){b.Rect=function(c,b,e,l){if(!(this instanceof arguments.callee))return new arguments.callee(c,
b,e,l);this.x=c;this.y=b;this.width=e;this.height=l;this.right=c+e;this.bottom=b+l};b.Rect.prototype.getPosition=function(){return[this.x,this.y]};b.Rect.prototype.move=function(c,b){this.x+=c;this.y+=b;this.right+=c;this.bottom+=b;return this};b.Rect.prototype.moveTo=function(c,b){this.x=c;this.y=b;this.right=this.x+this.width;this.bottom=this.y+this.height;return this};b.Rect.prototype.resize=function(c,b){this.width+=c;this.height+=b;this.right=this.x+this.width;this.bottom=this.y+this.height;
return this};b.Rect.prototype.resizeTo=function(c,b){this.width=c;this.height=b;this.right=this.x+this.width;this.bottom=this.y+this.height;return this};b.Rect.prototype.draw=function(){b.context.strokeStyle="red";b.context.strokeRect(this.x,this.y,this.width,this.height);return this};b.Rect.prototype.collidePoint=function(c,b){return c>=this.x&&c<=this.right&&b>=this.y&&b<=this.bottom};b.Rect.prototype.collideRect=function(c){return(this.x>=c.x&&this.x<=c.right||c.x>=this.x&&c.x<=this.right)&&(this.y>=
c.y&&this.y<=c.bottom||c.y>=this.y&&c.y<=this.bottom)};b.Rect.prototype.toString=function(){return"[Rect "+this.x+", "+this.y+", "+this.width+", "+this.height+"]"};return b}(jaws||{});"undefined"!==typeof module&&"exports"in module&&(module.exports=jaws.Rect);
jaws=function(b){b.Sprite=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);this.set(c);c.context?this.context=c.context:c.dom&&(this.dom=c.dom,this.createDiv());c.context||c.dom||(b.context?this.context=b.context:(this.dom=b.dom,this.createDiv()))};b.Sprite.prototype.default_options={x:0,y:0,alpha:1,angle:0,flipped:!1,anchor_x:0,anchor_y:0,image:null,image_path:null,anchor:null,scale_image:null,damping:1,scale_x:1,scale_y:1,scale:1,color:null,width:null,height:null,
_constructor:null,dom:null,context:null};b.Sprite.prototype.set=function(c){b.parseOptions(this,c,this.default_options);this.scale&&(this.scale_x=this.scale_y=this.scale);this.image&&this.setImage(this.image);this.scale_image&&this.scaleImage(this.scale_image);this.anchor&&this.setAnchor(this.anchor);if(!this.image&&this.color&&this.width&&this.height){c=document.createElement("canvas");var d=c.getContext("2d");c.width=this.width;c.height=this.height;d.fillStyle=this.color;d.fillRect(0,0,this.width,
this.height);this.image=c}this.cacheOffsets();return this};b.Sprite.prototype.clone=function(c){c=new (this._constructor?eval(this._constructor):this.constructor)(this.attributes());c._constructor=this._constructor||this.constructor.name;return c};b.Sprite.prototype.setImage=function(c){var d=this;if(b.isDrawable(c))return this.image=c,this.cacheOffsets();b.assets.isLoaded(c)?(this.image=b.assets.get(c),this.cacheOffsets()):(b.log.warn("Image '"+c+"' not preloaded with jaws.assets.add(). Image and a working sprite.rect() will be delayed."),
b.assets.load(c,{onload:function(){d.image=b.assets.get(c);d.cacheOffsets()}}));return this};b.Sprite.prototype.flip=function(){this.flipped=this.flipped?!1:!0;return this};b.Sprite.prototype.flipTo=function(c){this.flipped=c;return this};b.Sprite.prototype.rotate=function(c){this.angle+=c;return this};b.Sprite.prototype.rotateTo=function(c){this.angle=c;return this};b.Sprite.prototype.moveTo=function(c,b){this.x=c;this.y=b;return this};b.Sprite.prototype.move=function(c,b){c&&(this.x+=c);b&&(this.y+=
b);return this};b.Sprite.prototype.scaleAll=function(c){this.scale_x*=c;this.scale_y*=c;return this.cacheOffsets()};b.Sprite.prototype.scaleTo=function(c){this.scale_x=this.scale_y=c;return this.cacheOffsets()};b.Sprite.prototype.scaleWidth=function(c){this.scale_x*=c;return this.cacheOffsets()};b.Sprite.prototype.scaleHeight=function(c){this.scale_y*=c;return this.cacheOffsets()};b.Sprite.prototype.setX=function(c){this.x=c;return this};b.Sprite.prototype.setY=function(c){this.y=c;return this};b.Sprite.prototype.setTop=
function(c){this.y=c+this.top_offset;return this};b.Sprite.prototype.setBottom=function(c){this.y=c-this.bottom_offset;return this};b.Sprite.prototype.setLeft=function(c){this.x=c+this.left_offset;return this};b.Sprite.prototype.setRight=function(c){this.x=c-this.right_offset;return this};b.Sprite.prototype.setWidth=function(c){this.scale_x=c/this.image.width;return this.cacheOffsets()};b.Sprite.prototype.setHeight=function(c){this.scale_y=c/this.image.height;return this.cacheOffsets()};b.Sprite.prototype.resize=
function(c,b){this.scale_x=(this.width+c)/this.image.width;this.scale_y=(this.height+b)/this.image.height;return this.cacheOffsets()};b.Sprite.prototype.resizeTo=function(c,b){this.scale_x=c/this.image.width;this.scale_y=b/this.image.height;return this.cacheOffsets()};b.Sprite.prototype.setAnchor=function(b){if(a={top_left:[0,0],left_top:[0,0],center_left:[0,0.5],left_center:[0,0.5],bottom_left:[0,1],left_bottom:[0,1],top_center:[0.5,0],center_top:[0.5,0],center_center:[0.5,0.5],center:[0.5,0.5],
bottom_center:[0.5,1],center_bottom:[0.5,1],top_right:[1,0],right_top:[1,0],center_right:[1,0.5],right_center:[1,0.5],bottom_right:[1,1],right_bottom:[1,1]}[b])this.anchor_x=a[0],this.anchor_y=a[1],this.image&&this.cacheOffsets();return this};b.Sprite.prototype.cacheOffsets=function(){if(this.image)return this.width=this.image.width*this.scale_x,this.height=this.image.height*this.scale_y,this.left_offset=this.width*this.anchor_x,this.top_offset=this.height*this.anchor_y,this.right_offset=this.width*
(1-this.anchor_x),this.bottom_offset=this.height*(1-this.anchor_y),this.cached_rect&&this.cached_rect.resizeTo(this.width,this.height),this};b.Sprite.prototype.rect=function(){!this.cached_rect&&this.width&&(this.cached_rect=new b.Rect(this.x,this.y,this.width,this.height));this.cached_rect&&this.cached_rect.moveTo(this.x-this.left_offset,this.y-this.top_offset);return this.cached_rect};b.Sprite.prototype.createDiv=function(){this.div=document.createElement("div");this.div.style.position="absolute";
this.image&&(this.div.style.width=this.image.width+"px",this.div.style.height=this.image.height+"px",this.div.style.backgroundImage=this.image.toDataURL?"url("+this.image.toDataURL()+")":"url("+this.image.src+")");this.dom&&this.dom.appendChild(this.div);this.updateDiv()};b.Sprite.prototype.updateDiv=function(){this.div.style.left=this.x+"px";this.div.style.top=this.y+"px";var b;b=""+("rotate("+this.angle+"deg) ");b=this.flipped?b+("scale(-"+this.scale_x+","+this.scale_y+")"):b+("scale("+this.scale_x+
","+this.scale_y+")");this.div.style.MozTransform=b;this.div.style.WebkitTransform=b;this.div.style.OTransform=b;this.div.style.msTransform=b;this.div.style.transform=b;return this};b.Sprite.prototype.draw=function(){if(!this.image)return this;if(this.dom)return this.updateDiv();this.context.save();this.context.translate(this.x,this.y);0!=this.angle&&b.context.rotate(this.angle*Math.PI/180);this.flipped&&this.context.scale(-1,1);this.context.globalAlpha=this.alpha;this.context.translate(-this.left_offset,
-this.top_offset);this.context.drawImage(this.image,0,0,this.width,this.height);this.context.restore();return this};b.Sprite.prototype.scaleImage=function(c){if(this.image)return this.setImage(b.gfx.retroScaleImage(this.image,c)),this};b.Sprite.prototype.asCanvasContext=function(){var c=document.createElement("canvas");c.width=this.width;c.height=this.height;c=c.getContext("2d");b.context&&(c.mozImageSmoothingEnabled=b.context.mozImageSmoothingEnabled);c.drawImage(this.image,0,0,this.width,this.height);
return c};b.Sprite.prototype.asCanvas=function(){var c=document.createElement("canvas");c.width=this.width;c.height=this.height;var d=c.getContext("2d");b.context&&(d.mozImageSmoothingEnabled=b.context.mozImageSmoothingEnabled);d.drawImage(this.image,0,0,this.width,this.height);return c};b.Sprite.prototype.toString=function(){return"[Sprite "+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width+", "+this.height+"]"};b.Sprite.prototype.attributes=function(){var b=this.options;b._constructor=this._constructor||
"jaws.Sprite";b.x=parseFloat(this.x.toFixed(2));b.y=parseFloat(this.y.toFixed(2));b.image=this.image_path;b.alpha=this.alpha;b.flipped=this.flipped;b.angle=parseFloat(this.angle.toFixed(2));b.scale_x=this.scale_x;b.scale_y=this.scale_y;b.anchor_x=this.anchor_x;b.anchor_y=this.anchor_y;return b};b.Sprite.prototype.toJSON=function(){return JSON.stringify(this.attributes())};return b}(jaws||{});"undefined"!==typeof module&&"exports"in module&&(module.exports=jaws.Sprite);
jaws=function(b){b.SpriteList=function(b){if(!(this instanceof arguments.callee))return new arguments.callee(b);this.sprites=[];this.length=0;b&&this.load(b)};b.SpriteList.prototype.at=function(b){return this.sprites[b]};b.SpriteList.prototype.concat=function(){return this.sprites.concat.apply(this.sprites,arguments)};b.SpriteList.prototype.indexOf=function(b,d){return this.sprites.indexOf(b,d)};b.SpriteList.prototype.join=function(b){return this.sprites.join(b)};b.SpriteList.prototype.lastIndexOf=
function(){return this.sprites.lastIndexOf.apply(this.sprites,arguments)};b.SpriteList.prototype.pop=function(){var b=this.sprites.pop();this.updateLength();return b};b.SpriteList.prototype.push=function(){this.sprites.push.apply(this.sprites,arguments);this.updateLength();return this.length};b.SpriteList.prototype.reverse=function(){this.sprites.reverse()};b.SpriteList.prototype.shift=function(){var b=this.sprites.shift();this.updateLength();return b};b.SpriteList.prototype.slice=function(b,d){return this.sprites.slice(b,
d)};b.SpriteList.prototype.sort=function(){this.sprites.sort.apply(this.sprites,arguments)};b.SpriteList.prototype.splice=function(){var b=this.sprites.splice.apply(this.sprites,arguments);this.updateLength();return b};b.SpriteList.prototype.unshift=function(){this.sprites.unshift.apply(this.sprites,arguments);this.updateLength();return this.length};b.SpriteList.prototype.updateLength=function(){this.length=this.sprites.length};b.SpriteList.prototype.valueOf=function(){return this.toString()};b.SpriteList.prototype.filter=
function(){return this.sprites.filter.apply(this.sprites,arguments)};b.SpriteList.prototype.forEach=function(){this.sprites.forEach.apply(this.sprites,arguments);this.updateLength()};b.SpriteList.prototype.every=function(){return this.sprites.every.apply(this.sprites,arguments)};b.SpriteList.prototype.map=function(){return this.sprites.map.apply(this.sprites,arguments)};b.SpriteList.prototype.reduce=function(){return this.sprites.reduce.apply(this.sprites,arguments)};b.SpriteList.prototype.reduceRight=
function(){return this.sprites.reduceRight.apply(this.sprites,arguments)};b.SpriteList.prototype.some=function(){return this.sprites.some.apply(this.sprites,arguments)};b.SpriteList.prototype.isSpriteList=function(){return!0};b.SpriteList.prototype.load=function(c){function d(c){c.forEach(function(c){var d=c._constructor?eval(c._constructor):c.constructor;b.isFunction(d)&&(b.log.info("Creating "+c._constructor+"("+c.toString()+")",!0),d=new d(c),d._constructor=c._constructor||c.constructor.name,e.push(d))})}
var e=this;b.isArray(c)?c.every(function(b){return b._constructor})?d(c):this.sprites=c:b.isString(c)&&(d(JSON.parse(c)),b.log.info(c));this.updateLength()};b.SpriteList.prototype.remove=function(b){b=this.indexOf(b);-1<b&&this.splice(b,1);this.updateLength()};b.SpriteList.prototype.draw=function(){this.forEach(function(b){b.draw()})};b.SpriteList.prototype.drawIf=function(b){this.forEach(function(d){b(d)&&d.draw()})};b.SpriteList.prototype.update=function(){this.forEach(function(b){b.update()})};
b.SpriteList.prototype.updateIf=function(b){this.forEach(function(d){b(d)&&d.update()})};b.SpriteList.prototype.deleteIf=function(b){this.removeIf(b)};b.SpriteList.prototype.removeIf=function(b){this.sprites=this.filter(function(d){return!b(d)});this.updateLength()};b.SpriteList.prototype.toString=function(){return"[SpriteList "+this.length+" sprites]"};return b}(jaws||{});
jaws=function(b){function c(b,c,l,f,h){var k=document.createElement("canvas");k.width=f;k.height=h;k.getContext("2d").drawImage(b,c,l,f,h,0,0,k.width,k.height);return k}b.SpriteSheet=function(d){if(!(this instanceof arguments.callee))return new arguments.callee(d);b.parseOptions(this,d,this.default_options);if(b.isString(this.image)&&!d.frame_size){var e=RegExp("_(\\d+)x(\\d+)","g").exec(this.image);this.frame_size=[];this.frame_size[0]=parseInt(e[1]);this.frame_size[1]=parseInt(e[2])}this.image=
b.isDrawable(this.image)?this.image:b.assets.data[this.image];this.scale_image&&(e=b.isDrawable(this.image)?this.image:b.assets.get(this.image),this.frame_size[0]*=this.scale_image,this.frame_size[1]*=this.scale_image,this.image=b.gfx.retroScaleImage(e,this.scale_image));this.frames=[];if("down"==this.orientation)for(e=this.offset;e<this.image.width;e+=this.frame_size[0])for(var l=0;l<this.image.height;l+=this.frame_size[1])this.frames.push(c(this.image,e,l,this.frame_size[0],this.frame_size[1]));
else for(l=this.offset;l<this.image.height;l+=this.frame_size[1])for(e=0;e<this.image.width;e+=this.frame_size[0])this.frames.push(c(this.image,e,l,this.frame_size[0],this.frame_size[1]))};b.SpriteSheet.prototype.default_options={image:null,orientation:"down",frame_size:[32,32],offset:0,scale_image:null};b.SpriteSheet.prototype.toString=function(){return"[SpriteSheet "+this.frames.length+" frames]"};return b}(jaws||{});
jaws=function(b){b.Parallax=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);b.parseOptions(this,c,this.default_options);this.width=c.width||b.width;this.height=c.height||b.height};b.Parallax.prototype.default_options={scale:1,repeat_x:null,repeat_y:null,camera_x:0,camera_y:0,width:null,height:null,layers:[]};b.Parallax.prototype.draw=function(b){for(var d,e=0;e<this.layers.length;e++)for(b=this.layers[e],d=this.repeat_x?-(this.camera_x/b.damping%b.width):-(this.camera_x/
b.damping),b.y=this.repeat_y?-(this.camera_y/b.damping%b.height):-(this.camera_y/b.damping),b.x=d;b.y<this.height;){for(;b.x<this.width&&(0<=b.x+b.width&&0<=b.y+b.height&&b.draw(),b.x+=b.width,this.repeat_x););b.y+=b.height;b.x=d;if(!this.repeat_y)break}};b.Parallax.prototype.addLayer=function(c){c=new b.ParallaxLayer(c);c.scaleAll(this.scale);this.layers.push(c)};b.Parallax.prototype.toString=function(){return"[Parallax "+this.x+", "+this.y+". "+this.layers.length+" layers]"};b.ParallaxLayer=function(c){if(!(this instanceof
arguments.callee))return new arguments.callee(c);this.damping=c.damping||0;b.Sprite.call(this,c)};b.ParallaxLayer.prototype=b.Sprite.prototype;return b}(jaws||{});
jaws=function(b){b.Animation=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);b.parseOptions(this,c,this.default_options);if(c.sprite_sheet){var d=new b.SpriteSheet({image:c.sprite_sheet,scale_image:this.scale_image,frame_size:this.frame_size,orientation:this.orientation,offset:this.offset});this.frames=d.frames;this.frame_size=d.frame_size}c.scale_image&&(d=b.isDrawable(c.sprite_sheet)?c.sprite_sheet:b.assets.get(c.sprite_sheet),this.frame_size[0]*=c.scale_image,
this.frame_size[1]*=c.scale_image,c.sprite_sheet=b.gfx.retroScaleImage(d,c.scale_image));this.current_tick=(new Date).getTime();this.last_tick=(new Date).getTime();this.sum_tick=0;if(c.subsets)for(subset in this.subsets={},c.subsets)start_stop=c.subsets[subset],this.subsets[subset]=this.slice(start_stop[0],start_stop[1])};b.Animation.prototype.default_options={frames:[],subsets:[],frame_duration:100,index:0,loop:1,bounce:0,frame_direction:1,frame_size:null,orientation:"down",on_end:null,offset:0,
scale_image:null,sprite_sheet:null};b.Animation.prototype.subset=function(b){return this.subsets[b]};b.Animation.prototype.update=function(){this.current_tick=(new Date).getTime();this.sum_tick+=this.current_tick-this.last_tick;this.last_tick=this.current_tick;this.sum_tick>this.frame_duration&&(this.index+=this.frame_direction,this.sum_tick=0);if(this.index>=this.frames.length||0>this.index)this.bounce?(this.frame_direction=-this.frame_direction,this.index+=2*this.frame_direction):this.loop?this.index=
0>this.frame_direction?this.frames.length-1:0:(this.index-=this.frame_direction,this.on_end&&(this.on_end(),this.on_end=null));return this};b.Animation.prototype.slice=function(c,d){var e={};e.frame_duration=this.frame_duration;e.loop=this.loop;e.bounce=this.bounce;e.on_end=this.on_end;e.frame_direction=this.frame_direction;e.frames=this.frames.slice().slice(c,d);return new b.Animation(e)};b.Animation.prototype.next=function(){this.update();return this.frames[this.index]};b.Animation.prototype.atLastFrame=
function(){return this.index==this.frames.length-1};b.Animation.prototype.atFirstFrame=function(){return 0==this.index};b.Animation.prototype.currentFrame=function(){return this.frames[this.index]};b.Animation.prototype.toString=function(){return"[Animation, "+this.frames.length+" frames]"};return b}(jaws||{});
jaws=function(b){b.Viewport=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);b.parseOptions(this,c,this.default_options);this.context||(this.context=b.context);this.width||(this.width=b.width);this.height||(this.height=b.height);this.max_x||(this.max_x=b.width);this.max_y||(this.max_y=b.height);var d=this;this.move=function(b,c){b&&(this.x+=b);c&&(this.y+=c);this.verifyPosition()};this.moveTo=function(b,c){void 0!=b&&(this.x=b);void 0!=c&&(this.y=c);this.verifyPosition()};
this.isOutside=function(b){return!d.isInside(b)};this.isInside=function(b){return b.x>=d.x&&b.x<=d.x+d.width&&b.y>=d.y&&b.y<=d.y+d.height};this.isPartlyInside=function(b){var c=b.rect();return c.right>=d.x&&c.x<=d.x+d.width&&c.bottom>=d.y&&b.y<=d.y+d.height};this.isLeftOf=function(b){return b.x<d.x};this.isRightOf=function(b){return b.x>d.x+d.width};this.isAbove=function(b){return b.y<d.y};this.isBelow=function(b){return b.y>d.y+d.height};this.centerAround=function(b){this.x=Math.floor(b.x-this.width/
2);this.y=Math.floor(b.y-this.height/2);this.verifyPosition()};this.forceInsideVisibleArea=function(c,d){c.x<this.x+d&&(c.x=this.x+d);c.x>this.x+b.width-d&&(c.x=this.x+b.width-d);c.y<this.y+d&&(c.y=this.y+d);c.y>this.y+b.height-d&&(c.y=this.y+b.height-d)};this.forceInside=function(b,c){b.x<c&&(b.x=c);b.x>this.max_x-c&&(b.x=this.max_x-c);b.y<c&&(b.y=c);b.y>this.max_y-c&&(b.y=this.max_y-c)};this.apply=function(b){this.context.save();this.context.translate(-this.x,-this.y);b();this.context.restore()};
this.draw=function(b){this.apply(function(){b.forEach?b.forEach(d.drawIfPartlyInside):b.draw&&d.drawIfPartlyInside(b)})};this.drawTileMap=function(b){var c=b.atRect({x:this.x,y:this.y,right:this.x+this.width,bottom:this.y+this.height});this.apply(function(){for(var b=0;b<c.length;b++)c[b].draw()})};this.drawIfPartlyInside=function(b){d.isPartlyInside(b)&&b.draw()};this.verifyPosition=function(){var b=this.max_x-this.width;0>this.x&&(this.x=0);this.x>b&&(this.x=b);b=this.max_y-this.height;0>this.y&&
(this.y=0);this.y>b&&(this.y=b)};this.moveTo(c.x||0,c.y||0)};b.Viewport.prototype.default_options={context:null,width:null,height:null,max_x:null,max_y:null,x:0,y:0};b.Viewport.prototype.toString=function(){return"[Viewport "+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width+", "+this.height+"]"};return b}(jaws||{});
jaws=function(b){b.TileMap=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);b.parseOptions(this,c,this.default_options);this.cells=Array(this.size[0]);for(var d=0;d<this.size[0];d++){this.cells[d]=Array(this.size[1]);for(var e=0;e<this.size[1];e++)this.cells[d][e]=[]}};b.TileMap.prototype.default_options={cell_size:[32,32],size:[100,100],sortFunction:null};b.TileMap.prototype.clear=function(){for(var b=0;b<this.size[0];b++)for(var d=0;d<this.size[1];d++)this.cells[b][d]=
[]};b.TileMap.prototype.sortCells=function(b){for(var d=0;d<this.size[0];d++)for(var e=0;e<this.size[1];e++)this.cells[d][e].sort(b)};b.TileMap.prototype.push=function(b){var d=this;if(b.forEach)return b.forEach(function(b){d.push(b)}),b;if(b.rect)return this.pushAsRect(b,b.rect());var e=parseInt(b.x/this.cell_size[0]),l=parseInt(b.y/this.cell_size[1]);return this.pushToCell(e,l,b)};b.TileMap.prototype.pushAsPoint=function(b){if(Array.isArray(b)){for(var d=0;d<b.length;d++)this.pushAsPoint(b[d]);
return b}var d=parseInt(b.x/this.cell_size[0]),e=parseInt(b.y/this.cell_size[1]);return this.pushToCell(d,e,b)};b.TileMap.prototype.pushAsRect=function(b,d){for(var e=parseInt(d.x/this.cell_size[0]),l=parseInt((d.right-1)/this.cell_size[0]);e<=l;e++)for(var f=parseInt(d.y/this.cell_size[1]),h=parseInt((d.bottom-1)/this.cell_size[1]);f<=h;f++)this.pushToCell(e,f,b);return b};b.TileMap.prototype.pushToCell=function(b,d,e){this.cells[b][d].push(e);this.sortFunction&&this.cells[b][d].sort(this.sortFunction);
return this};b.TileMap.prototype.at=function(b,d){var e=parseInt(b/this.cell_size[0]),l=parseInt(d/this.cell_size[1]);return this.cells[e][l]};b.TileMap.prototype.atRect=function(b){var d=[];try{var e=parseInt(b.x/this.cell_size[0]);0>e&&(e=0);var l=parseInt(b.right/this.cell_size[0]);l>=this.size[0]&&(l=this.size[0]-1);var f=parseInt(b.y/this.cell_size[1]);0>f&&(f=0);var h=parseInt(b.bottom/this.cell_size[1]);h>=this.size[1]&&(h=this.size[1]-1);for(b=e;b<=l;b++)for(e=f;e<=h;e++)this.cells[b][e].forEach(function(b,
c){-1==d.indexOf(b)&&d.push(b)})}catch(k){}return d};b.TileMap.prototype.all=function(){for(var b=[],d=0;d<this.size[0];d++)for(var e=0;e<this.size[1];e++)this.cells[d][e].forEach(function(d,e){b.push(d)});return b};b.TileMap.prototype.cell=function(b,d){return this.cells[b][d]};b.TileMap.prototype.findPath=function(b,d,e){"undefined"==typeof e&&(e=!1);var l=parseInt(b[0]/this.cell_size[0]),f=parseInt(b[1]/this.cell_size[1]),h=parseInt(d[0]/this.cell_size[0]);d=parseInt(d[1]/this.cell_size[1]);if(l===
h&&f===d)return[{x:b[0],y:b[1]}];for(var k=l,g=f,q=0,r=0,u=2*this.size[0]*this.size[1]+1,m=Array(this.size[0]),n=0;n<this.size[0];n++){m[n]=Array(this.size[1]);for(var p=0;p<this.size[1];p++)m[n][p]=!1}m[k][g]={parent:[],G:0,score:u};b=Array(this.size[0]);for(n=0;n<this.size[0];n++)for(b[n]=Array(this.size[1]),p=0;p<this.size[1];p++)b[n][p]=!1;for(;k!==h||g!==d;){p=[];0<k&&p.push([k-1,g]);k<this.size[0]-1&&p.push([k+1,g]);0<g&&p.push([k,g-1]);g<this.size[1]-1&&p.push([k,g+1]);for(n=0;n<p.length;n++){var s=
p[n][0],t=p[n][1];if(r=0===this.cell(s,t).length&&!e||0<this.cell(s,t).length&&e)r=b[s][t]?!0:!1,r=!r;if(r){var r=q+1,w;w=[s,t];var x=[h,d];w=Math.abs(x[0]-w[0])+Math.abs(x[1]-w[1]);r+=w;if(!m[s][t]||m[s][t]&&m[s][t].score>r)m[s][t]={parent:[k,g],G:q+1,score:r}}}g=[];s=[];k=u;for(n=q=0;n<this.size[0];n++)for(p=0;p<this.size[1];p++)m[n][p]&&m[n][p].score<k&&(g=[n,p],s=m[n][p].parent,k=m[n][p].score,q=m[n][p].G);if(0===g.length)return[];m[g[0]][g[1]]=!1;k=g[0];g=g[1];b[k][g]={parent:s}}e=[];h=b[k][g];
for(e.unshift({x:k*this.cell_size[0],y:g*this.cell_size[1]});k!==l||g!==f;)k=h.parent[0],g=h.parent[1],e.unshift({x:k*this.cell_size[0],y:g*this.cell_size[1]}),h=b[k][g];return e};b.TileMap.prototype.lineOfSight=function(b,d,e){"undefined"==typeof e&&(e=!1);var l=b[0],f=d[0];b=b[1];d=d[1];var h=Math.abs(f-l),k=Math.abs(d-b),g,q;g=l<f?1:-1;q=b<d?1:-1;for(var r=h-k,u;l!==f||b!==d;){if(e){if(0===this.at(l,b).length)return!1}else if(0<this.at(l,b).length)return!1;u=2*r;u>-k&&(r-=k,l+=g);u<h&&(r+=h,b+=
q)}return!0};b.TileMap.prototype.toString=function(){return"[TileMap "+this.size[0]+" cols, "+this.size[1]+" rows]"};return b}(jaws||{});"undefined"!==typeof module&&"exports"in module&&(module.exports=jaws.TileMap);
jaws=function(b){function c(b,c){for(var l=function(c){return void 0!==b.isSpriteList?b.at(c):b[c]},f=[],h=Array(c),k=0;k<c;k++)h[k]=k;for(var k=c-1,g=b.length;0<=k;g=b.length){for(f.push(h.map(l));0<=k&&h[k]==g-1;)k--,g--;if(0<=k){h[k]+=1;for(k+=1;k<c;k++)h[k]=h[k-1]+1;k=c-1}}return f}b.collideOneWithOne=function(c,e){return c.radius&&e.radius&&c!==e&&b.collideCircles(c,e)||c.rect&&e.rect&&c!==e&&b.collideRects(c.rect(),e.rect())?!0:!1};b.collideOneWithMany=function(c,e,l){if(l)for(var f=0;f<e.length;f++)b.collideOneWithOne(c,
e[f])&&l(c,e[f]);else return e.filter(function(e){return b.collideOneWithOne(c,e)})};b.collideManyWithMany=function(d,e,l){var f=[];d===e?c(d,2).forEach(function(c){b.collideOneWithOne(c[0],c[1])&&(l?l(c[0],c[1]):f.push([c[0],c[1]]))}):d.forEach(function(c){e.forEach(function(d){b.collideOneWithOne(c,d)&&(l?l(c,d):f.push([c,d]))})});return f};b.collideCircles=function(c,e){return b.distanceBetween(c,e)<c.radius+e.radius};b.collideRects=function(b,c){return(b.x>=c.x&&b.x<=c.right||c.x>=b.x&&c.x<=b.right)&&
(b.y>=c.y&&b.y<=c.bottom||c.y>=b.y&&c.y<=b.bottom)};b.distanceBetween=function(b,c){return Math.sqrt(Math.pow(b.x-c.x,2)+Math.pow(b.y-c.y,2))};b.collide=function(c,e,l){if(c.rect&&e.forEach)return b.collideOneWithMany(c,e,l)===[];if(c.forEach&&e.forEach)return b.collideManyWithMany(c,e,l)===[];if(c.forEach&&e.rect)return b.collideOneWithMany(e,c,l)===[];if(c.rect&&e.rect){var f=b.collideOneWithOne(c,e);if(l&&f)l(c,e);else return f}};return b}(jaws||{});
jaws=function(b){b.gfx={};b.gfx.retroScaleImage=function(c,d){var e=b.isImage(c)?b.imageToCanvas(c):c,e=e.getContext("2d").getImageData(0,0,e.width,e.height).data,l=document.createElement("canvas");l.width=c.width*d;l.height=c.height*d;for(var f=l.getContext("2d"),h=f.createImageData(l.width,l.height),k=h.width,g=h.height,q=0;q<g;q+=1)for(var r=q*h.width,u=Math.floor(q/d)*c.width,m=0;m<k;m+=1){var n=4*(r+m),p=4*(u+Math.floor(m/d));h.data[n]=e[p];h.data[n+1]=e[p+1];h.data[n+2]=e[p+2];h.data[n+3]=e[p+
3]}f.putImageData(h,0,0);return l};return b}(jaws||{});window.addEventListener("load",function(){if(jaws.onload)jaws.onload()},!1);
