/* Built at 2013-08-29 21:06:04 +0200 */
var jaws=function(b){b.Text=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);this.set(c);c.context?this.context=c.context:c.dom&&(this.dom=c.dom,this.createDiv());c.context||c.dom||(b.context?this.context=b.context:(this.dom=b.dom,this.createDiv()))};b.Text.prototype.default_options={x:0,y:0,alpha:1,angle:0,anchor_x:0,anchor_y:0,anchor:"top_left",damping:1,style:"normal",fontFace:"serif",fontSize:12,color:"black",textAlign:"start",textBaseline:"alphabetic",text:"",
wordWrap:!1,width:function(){return b.width},height:function(){return b.height},shadowColor:null,shadowBlur:null,shadowOffsetX:null,shadowOffsetY:null,_constructor:null,dom:null};b.Text.prototype.set=function(c){b.parseOptions(this,c,this.default_options);this.anchor&&this.setAnchor(this.anchor);this.cacheOffsets();return this};b.Text.prototype.clone=function(){var b=new (this._constructor?eval(this._constructor):this.constructor)(this.attributes());b._constructor=this._constructor||this.constructor.name;
return b};b.Text.prototype.rotate=function(b){this.angle+=b;return this};b.Text.prototype.rotateTo=function(b){this.angle=b;return this};b.Text.prototype.moveTo=function(b,d){this.x=b;this.y=d;return this};b.Text.prototype.move=function(b,d){b&&(this.x+=b);d&&(this.y+=d);return this};b.Text.prototype.setX=function(b){this.x=b;return this};b.Text.prototype.setY=function(b){this.y=b;return this};b.Text.prototype.setTop=function(b){this.y=b+this.top_offset;return this};b.Text.prototype.setBottom=function(b){this.y=
b-this.bottom_offset;return this};b.Text.prototype.setLeft=function(b){this.x=b+this.left_offset;return this};b.Text.prototype.setRight=function(b){this.x=b-this.right_offset;return this};b.Text.prototype.setWidth=function(b){this.width=b;return this.cacheOffsets()};b.Text.prototype.setHeight=function(b){this.height=b;return this.cacheOffsets()};b.Text.prototype.resize=function(b,d){this.width+=b;this.height+=d;return this.cacheOffsets()};b.Text.prototype.resizeTo=function(b,d){this.width=b;this.height=
d;return this.cacheOffsets()};b.Text.prototype.setAnchor=function(b){var d={top_left:[0,0],left_top:[0,0],center_left:[0,0.5],left_center:[0,0.5],bottom_left:[0,1],left_bottom:[0,1],top_center:[0.5,0],center_top:[0.5,0],center_center:[0.5,0.5],center:[0.5,0.5],bottom_center:[0.5,1],center_bottom:[0.5,1],top_right:[1,0],right_top:[1,0],center_right:[1,0.5],right_center:[1,0.5],bottom_right:[1,1],right_bottom:[1,1]};d.hasOwnProperty(b)&&(this.anchor_x=d[b][0],this.anchor_y=d[b][1],this.cacheOffsets());
return this};b.Text.prototype.cacheOffsets=function(){this.left_offset=this.width*this.anchor_x;this.top_offset=this.height*this.anchor_y;this.right_offset=this.width*(1-this.anchor_x);this.bottom_offset=this.height*(1-this.anchor_y);this.cached_rect&&this.cached_rect.resizeTo(this.width,this.height);return this};b.Text.prototype.rect=function(){!this.cached_rect&&this.width&&(this.cached_rect=new b.Rect(this.x,this.y,this.width,this.height));this.cached_rect&&this.cached_rect.moveTo(this.x-this.left_offset,
this.y-this.top_offset);return this.cached_rect};b.Text.prototype.createDiv=function(){this.div=document.createElement("div");this.div.style.position="absolute";this.div.style.width=this.width+"px";this.div.style.height=this.height+"px";this.div.style.fontSize=this.fontSize+"px";this.div.style.fontFamily=this.fontFace;this.div.style.textShadow=(this.shadowOffsetX||"0")+"px "+(this.shadowOffsetY||"0")+"px "+(this.shadowBlur||"0")+"px "+(this.shadowColor||"");this.div.style.textAlign="start"===this.textAlign?
"left":"end"===this.textAlign?"right":this.textAlign;this.div.style.verticalAlign="top"===this.textBaseline?"super":"hanging"===this.textBaseline?"text-top":"alphabetic"===this.textBaseline?"bottom":"ideographic"===this.div.style.verticalAlign?"text-bottom":this.textBaseline;this.div.innerText?this.div.innerText=this.text:this.div.textContent=this.text;this.dom&&this.dom.appendChild(this.div);this.updateDiv()};b.Text.prototype.updateDiv=function(){this.div.style.left=this.x+"px";this.div.style.top=
this.y+"px";var b;b=""+("rotate("+this.angle+"deg) ");this.div.style.MozTransform=b;this.div.style.WebkitTransform=b;this.div.style.OTransform=b;this.div.style.msTransform=b;this.div.style.transform=b;return this};b.Text.prototype.draw=function(){if(this.dom)return this.updateDiv();this.context.save();0!==this.angle&&this.context.rotate(this.angle*Math.PI/180);this.context.globalAlpha=this.alpha;this.context.translate(-this.left_offset,-this.top_offset);this.context.fillStyle=this.color;this.context.font=
this.style+" "+this.fontSize+"px "+this.fontFace;this.context.textBaseline=this.textBaseline;this.context.textAlign=this.textAlign;this.shadowColor&&(this.context.shadowColor=this.shadowColor);this.shadowBlur&&(this.context.shadowBlur=this.shadowBlur);this.shadowOffsetX&&(this.context.shadowOffsetX=this.shadowOffsetX);this.shadowOffsetY&&(this.context.shadowOffsetY=this.shadowOffsetY);var b=this.y,d=this.x;if(this.wordWrap)for(var e=this.text.split(" "),g="",f=0;f<e.length;f++){var k=g+e[f]+" ",h=
this.context.measureText(k);this.y<b+this.height&&(h.width>this.width?(this.context.fillText(g,this.x,this.y),g=e[f]+" ",this.y+=this.fontSize):g=k,this.context.fillText(g,this.x,this.y))}else if(this.context.measureText(this.text).width<this.width)this.context.fillText(this.text,this.x,this.y);else for(e=this.text.split(" "),g=" ",f=0;f<e.length;f++)k=g+e[f]+" ",this.context.measureText(k).width<Math.abs(this.width-this.x)&&(this.context.fillText(k,this.x,this.y),g=k);this.y=b;this.x=d;this.context.restore();
return this};b.Text.prototype.asCanvasContext=function(){var c=document.createElement("canvas");c.width=this.width;c.height=this.height;c=c.getContext("2d");c.mozImageSmoothingEnabled=b.context.mozImageSmoothingEnabled;this.context.fillStyle=this.color;this.context.font=this.style+this.fontSize+"px "+this.fontFace;this.context.textBaseline=this.textBaseline;this.context.textAlign=this.textAlign;this.shadowColor&&(this.context.shadowColor=this.shadowColor);this.shadowBlur&&(this.context.shadowBlur=
this.shadowBlur);this.shadowOffsetX&&(this.context.shadowOffsetX=this.shadowOffsetX);this.shadowOffsetY&&(this.context.shadowOffsetY=this.shadowOffsetY);var d=this.y,e=this.x;if(this.wordWrap)for(var g=this.text.split(" "),f="",k=0;k<g.length;k++){var h=f+g[k]+" ",m=this.context.measureText(h);this.y<d+this.height&&(m.width>this.width?(this.context.fillText(f,this.x,this.y),f=g[k]+" ",this.y+=this.fontSize):f=h,this.context.fillText(f,this.x,this.y))}else if(this.context.measureText(this.text).width<
this.width)this.context.fillText(this.text,this.x,this.y);else for(g=this.text.split(" "),f=" ",k=0;k<g.length;k++)h=f+g[k]+" ",this.context.measureText(h).width<Math.abs(this.width-this.x)&&(this.context.fillText(h,this.x,this.y),f=h);this.y=d;this.x=e;return c};b.Text.prototype.asCanvas=function(){var c=document.createElement("canvas");c.width=this.width;c.height=this.height;var d=c.getContext("2d");d.mozImageSmoothingEnabled=b.context.mozImageSmoothingEnabled;this.context.fillStyle=this.color;
this.context.font=this.style+this.fontSize+"px "+this.fontFace;this.context.textBaseline=this.textBaseline;this.context.textAlign=this.textAlign;this.shadowColor&&(this.context.shadowColor=this.shadowColor);this.shadowBlur&&(this.context.shadowBlur=this.shadowBlur);this.shadowOffsetX&&(this.context.shadowOffsetX=this.shadowOffsetX);this.shadowOffsetY&&(this.context.shadowOffsetY=this.shadowOffsetY);var e=this.y,g=this.x;if(this.wordWrap)for(var f=this.text.split(" "),k="",h=0;h<f.length;h++){var m=
k+f[h]+" ",u=d.measureText(m);this.y<e+this.height&&(u.width>this.width?(d.fillText(k,this.x,this.y),k=f[h]+" ",this.y+=this.fontSize):k=m,d.fillText(k,this.x,this.y))}else if(d.measureText(this.text).width<this.width)this.context.fillText(this.text,this.x,this.y);else for(f=this.text.split(" "),k=" ",h=0;h<f.length;h++)m=k+f[h]+" ",d.measureText(m).width<Math.abs(this.width-this.x)&&(d.fillText(m,this.x,this.y),k=m);this.y=e;this.x=g;return c};b.Text.prototype.toString=function(){return"[Text "+
this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width+", "+this.height+"]"};b.Text.prototype.attributes=function(){var b=this.options;b._constructor=this._constructor||"jaws.Text";b.x=parseFloat(this.x.toFixed(2));b.y=parseFloat(this.y.toFixed(2));b.text=this.text;b.alpha=this.alpha;b.angle=parseFloat(this.angle.toFixed(2));b.anchor_x=this.anchor_x;b.anchor_y=this.anchor_y;b.style=this.style;b.fontSize=this.fontSize;b.fontFace=this.fontFace;b.color=this.color;b.textAlign=this.textAlign;b.textBaseline=
this.textBaseline;b.wordWrap=this.wordWrap;b.width=this.width;b.height=this.height;return b};b.Text.prototype.toJSON=function(){return JSON.stringify(this.attributes())};return b}(jaws||{});"undefined"!==typeof module&&"exports"in module&&(module.exports=jaws.Text);
jaws=function(b){b.Assets=function(){function c(c){if(b.isString(c))return c=f.getPostfix(c),f.file_type[c]?f.file_type[c]:c;b.log.error("jaws.assets.getType: Argument not a String with "+c)}function d(d){var e=this.asset,k=e.src,h=c(e.src);try{if("json"===h){if(4!==this.readyState)return;f.data[e.src]=JSON.parse(this.responseText)}else if("image"===h){var p=f.image_to_canvas?b.imageToCanvas(e.image):e.image;if(f.fuchia_to_transparent&&"bmp"===f.getPostfix(e.src))if(h=p,b.isDrawable(h)){for(var r=
b.isImage(h)?b.imageToCanvas(h):h,s=r.getContext("2d"),q=s.getImageData(0,0,r.width,r.height),l=q.data,h=0;h<l.length;h+=4)255===l[h]&&(0===l[h+1]&&255===l[h+2])&&(l[h+3]=0);s.putImageData(q,0,0);p=r}else p=void 0;f.data[e.src]=p}else"audio"===h&&f.can_play[f.getPostfix(e.src)]?f.data[e.src]=e.audio:"video"===h&&f.can_play[f.getPostfix(e.src)]?f.data[e.src]=e.video:f.data[e.src]=this.response}catch(v){b.log.error("Cannot process "+k+" (Message: "+v.message+", Name: "+v.name+")"),f.data[e.src]=null}f.loaded[k]||
f.load_count++;f.loaded[k]=!0;f.loading[k]=!1;g(e,!0,d)}function e(b){var c=this.asset;f.error_count++;g(c,!1,b)}function g(b,c,d){var g=parseInt(100*((f.load_count+f.error_count)/f.src_list.length));if(c){if(f.onprogress)f.onprogress(b.src,g);if(b.onprogress&&void 0!==d)b.onprogress(d)}else{if(f.onerror)f.onerror(b.src,g);if(b.onerror&&void 0!==d)b.onerror(d)}if(100===g){if(f.onload)f.onload();f.onprogress=null;f.onerror=null;f.onload=null}}if(!(this instanceof arguments.callee))return new arguments.callee;
var f=this;f.loaded=[];f.loading=[];f.src_list=[];f.data=[];f.bust_cache=!1;f.image_to_canvas=!0;f.fuchia_to_transparent=!0;f.root="";f.file_type={};f.file_type.json="json";f.file_type.wav="audio";f.file_type.mp3="audio";f.file_type.ogg="audio";f.file_type.m4a="audio";f.file_type.weba="audio";f.file_type.aac="audio";f.file_type.mka="audio";f.file_type.flac="audio";f.file_type.png="image";f.file_type.jpg="image";f.file_type.jpeg="image";f.file_type.gif="image";f.file_type.bmp="image";f.file_type.tiff=
"image";f.file_type.mp4="video";f.file_type.webm="video";f.file_type.ogv="video";f.file_type.mkv="video";var k=new Audio,h=document.createElement("video");f.can_play={};f.can_play.wav=!!k.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"");f.can_play.ogg=!!k.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"");f.can_play.mp3=!!k.canPlayType("audio/mpeg;").replace(/^no$/,"");f.can_play.m4a=!!(k.canPlayType("audio/x-m4a;")||k.canPlayType("audio/aac;")).replace(/^no$/,"");f.can_play.weba=
!!k.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"");f.can_play.aac=!!k.canPlayType("audio/aac;").replace(/^no$/,"");f.can_play.mka=!!k.canPlayType("audio/x-matroska;").replace(/^no$/,"");f.can_play.flac=!!k.canPlayType("audio/x-flac;").replace(/^no$/,"");f.can_play.mp4=!!h.canPlayType("video/mp4;").replace(/^no$/,"");f.can_play.webm=!!h.canPlayType('video/webm; codecs="vorbis"').replace(/^no$/,"");f.can_play.ogv=!!h.canPlayType('video/ogg; codecs="vorbis"').replace(/^no$/,"");f.can_play.mkv=
!!h.canPlayType("video/x-matroska;").replace(/^no$/,"");f.length=function(){return f.src_list.length};f.setRoot=function(b){f.root=b;return f};f.get=function(c){if(b.isArray(c))return c.map(function(b){return f.data[b]});if(b.isString(c)){if("*"===c[c.length-1])for(var d=c.replace("*",""),g=0;g<f.src_list.length;g++)if(0==f.src_list[g].indexOf(d)&&f.data[f.src_list[g]])return f.data[f.src_list[g]];if(f.data[c])return f.data[c];b.log.warn("No such asset: "+c,!0)}else b.log.error("jaws.get: Neither String nor Array. Incorrect URL resource "+
c)};f.isLoading=function(c){if(b.isString(c))return f.loading[c];b.log.error("jaws.isLoading: Argument not a String with "+c)};f.isLoaded=function(c){if(b.isString(c))return f.loaded[c];b.log.error("jaws.isLoaded: Argument not a String with "+c)};f.getPostfix=function(c){if(b.isString(c))return c.toLowerCase().match(/.+\.([^?]+)(\?|$)/)[1];b.log.error("jaws.assets.getPostfix: Argument not a String with "+c)};f.add=function(c){var g=arguments;1==g.length&&b.isArray(g[0])&&(g=g[0]);for(var d=0;d<g.length;d++)b.isArray(g[d])?
f.add(g[d]):b.isString(g[d])?f.src_list.push(g[d]):b.log.error("jaws.assets.add: Neither String nor Array. Incorrect URL resource "+c);return f};f.loadAll=function(c){f.load_count=0;f.error_count=0;c.onprogress&&b.isFunction(c.onprogress)&&(f.onprogress=c.onprogress);c.onerror&&b.isFunction(c.onerror)&&(f.onerror=c.onerror);c.onload&&b.isFunction(c.onload)&&(f.onload=c.onload);f.src_list.forEach(function(b){f.load(b)});return f};f.load=function(h,k){k||(k={});if(b.isString(h)){var n={},t="";n.src=
h;n.onload=k.onload;n.onerror=k.onerror;f.loading[h]=!0;t=/^((f|ht)tp(s)?:)?\/\//.test(h)?n.src:f.root+n.src;f.bust_cache&&(t+="?"+parseInt(1E7*Math.random()));var p=c(n.src);if("image"===p)try{n.image=new Image,n.image.asset=n,n.image.addEventListener("load",d),n.image.addEventListener("error",e),n.image.src=t}catch(r){b.log.error("Cannot load Image resource "+t+" (Message: "+r.message+", Name: "+r.name+")")}else if(f.can_play[f.getPostfix(n.src)])if("audio"===p)try{n.audio=new Audio,n.audio.asset=
n,n.audio.addEventListener("error",e),n.audio.addEventListener("canplay",d),f.data[n.src]=n.audio,n.audio.src=t,n.audio.load()}catch(s){b.log.error("Cannot load Audio resource "+t+" (Message: "+s.message+", Name: "+s.name+")")}else{if("video"===p)try{n.video=document.createElement("video"),n.video.asset=n,f.data[n.src]=n.video,n.video.setAttribute("style","display:none;"),n.video.addEventListener("error",e),n.video.addEventListener("canplay",d),document.body.appendChild(n.video),n.video.src=t,n.video.load()}catch(q){b.log.error("Cannot load Video resource "+
t+" (Message: "+q.message+", Name: "+q.name+")")}}else{if("audio"===p&&!f.can_play[f.getPostfix(n.src)])return f.loaded[n.src]=!0,f.loading[n.src]=!1,f.load_count++,g(n,!0),f;try{var l=new XMLHttpRequest;l.asset=n;l.onreadystatechange=d;l.onerror=e;l.open("GET",t,!0);"json"!==p&&(l.responseType="blob");l.send(null)}catch(v){b.log.error("Cannot load "+t+" (Message: "+v.message+", Name: "+v.name+")")}}return f}b.log.error("jaws.assets.load: Argument not a String with "+h)};f.displayProgress=function(c){b.isNumber(c)&&
b.context&&(b.context.save(),b.context.fillStyle="black",b.context.fillRect(0,0,b.width,b.height),b.context.fillStyle="white",b.context.strokeStyle="white",b.context.textAlign="center",b.context.strokeRect(49,b.height/2-30-1,b.width-100+2,62),b.context.fillRect(50,b.height/2-30,(b.width-100)/100*c,60),b.context.font="11px verdana",b.context.fillText("Loading... "+c+"%",b.width/2,b.height/2-35),b.context.font="11px verdana",b.context.fillStyle="#ccc",b.context.textBaseline="bottom",b.context.fillText("powered by www.jawsjs.com",
b.width/2,b.height-1),b.context.restore())}};b.assets=new b.Assets;return b}(jaws||{});
jaws=function(b){b.QuadTree=function(c,d){this.depth=d||0;this.bounds=c||new b.Rect(0,0,b.width,b.height);this.nodes=[];this.objects=[]};b.QuadTree.prototype.clear=function(){this.objects=[];for(var b=0;b<this.nodes.length;b++)"undefined"!==typeof this.nodes[b]&&(this.nodes[b].clear(),delete this.nodes[b])};b.QuadTree.prototype.split=function(){var c=Math.round(this.bounds.width/2),d=Math.round(this.bounds.height/2),e=this.bounds.x,g=this.bounds.y;this.nodes[0]=new b.QuadTree(new b.Rect(e+c,g,c,d),
this.depth+1);this.nodes[1]=new b.QuadTree(new b.Rect(e,g,c,d),this.depth+1);this.nodes[2]=new b.QuadTree(new b.Rect(e,g+d,c,d),this.depth+1);this.nodes[3]=new b.QuadTree(new b.Rect(e+c,g+d,c,d),this.depth+1)};b.QuadTree.prototype.getIndex=function(b){var d=-1,e=this.bounds.x+this.bounds.width/2,g=this.bounds.y+this.bounds.height/2,f=b.y<g&&b.y+b.height<g,g=b.y>g;b.x<e&&b.x+b.width<e?f?d=1:g&&(d=2):b.x>e&&(f?d=0:g&&(d=3));return d};b.QuadTree.prototype.insert=function(b){if(b.hasOwnProperty("x")||
b.hasOwnProperty("y")||b.hasOwnProperty("width")||b.hasOwnProperty("height")){if("undefined"!==typeof this.nodes[0]){var d=this.getIndex(b);if(-1!==d){this.nodes[d].insert(b);return}}this.objects.push(b);"undefined"===typeof this.nodes[0]&&this.split();for(b=0;b<this.objects.length;)d=this.getIndex(this.objects[b]),-1!==d?this.nodes[d].insert(this.objects.splice(b,1)[0]):b++}};b.QuadTree.prototype.retrieve=function(b){if(b.hasOwnProperty("x")||b.hasOwnProperty("y")||b.hasOwnProperty("width")||b.hasOwnProperty("height")){var d=
this.getIndex(b),e=this.objects;if("undefined"!==typeof this.nodes[0])if(-1!==d)e=e.concat(this.nodes[d].retrieve(b));else for(d=0;d<this.nodes.length;d++)e=e.concat(this.nodes[d].retrieve(b));return e}};b.QuadTree.prototype.collide=function(c,d,e){var g=!1,f=new b.QuadTree,k=[];c.forEach||(k.push(c),c=k);d.forEach||(k=[],k.push(d),d=k);d.forEach(function(b){f.insert(b)});c.forEach(function(c){b.collide(c,f.retrieve(c),e)&&(g=!0)});f.clear();return g};return b}(jaws||{});
"undefined"!==typeof module&&"exports"in module&&(module.exports=jaws.QuadTree);
jaws=function(b){function c(b,c){for(var g=function(c){return void 0!==b.isSpriteList?b.at(c):b[c]},f=[],k=Array(c),h=0;h<c;h++)k[h]=h;for(var h=c-1,m=b.length;0<=h;m=b.length){for(f.push(k.map(g));0<=h&&k[h]===m-1;)h--,m--;if(0<=h){k[h]+=1;for(h+=1;h<c;h++)k[h]=k[h-1]+1;h=c-1}}return f}b.collideOneWithOne=function(c,e){return c.radius&&e.radius&&c!==e&&b.collideCircles(c,e)||c.rect&&e.rect&&c!==e&&b.collideRects(c.rect(),e.rect())?!0:!1};b.collideOneWithMany=function(c,e,g){var f=[];if(g){for(var k=
0;k<e.length;k++)b.collideOneWithOne(c,e[k])&&(g(c,e[k]),f.push(e[k]));return f}return e.filter(function(g){return b.collideOneWithOne(c,g)})};b.collideManyWithMany=function(d,e,g){var f=[];d===e?c(d,2).forEach(function(c){b.collideOneWithOne(c[0],c[1])&&(g?g(c[0],c[1]):f.push([c[0],c[1]]))}):d.forEach(function(c){e.forEach(function(d){b.collideOneWithOne(c,d)&&(g?g(c,d):f.push([c,d]))})});return f};b.collideCircles=function(c,e){return b.distanceBetween(c,e)<c.radius+e.radius};b.collideRects=function(b,
c){return(b.x>=c.x&&b.x<=c.right||c.x>=b.x&&c.x<=b.right)&&(b.y>=c.y&&b.y<=c.bottom||c.y>=b.y&&c.y<=b.bottom)};b.distanceBetween=function(b,c){return Math.sqrt(Math.pow(b.x-c.x,2)+Math.pow(b.y-c.y,2))};b.collide=function(c,e,g){if(c.rect&&e.forEach)return 0<b.collideOneWithMany(c,e,g).length;if(c.forEach&&e.forEach)return 0<b.collideManyWithMany(c,e,g).length;if(c.forEach&&e.rect)return 0<b.collideOneWithMany(e,c,g).length;if(c.rect&&e.rect){var f=b.collideOneWithOne(c,e);if(g&&f)g(c,e);else return f}};
return b}(jaws||{});
jaws=function(b){b.gfx={};b.gfx.retroScaleImage=function(c,d){var e=b.isImage(c)?b.imageToCanvas(c):c,e=e.getContext("2d").getImageData(0,0,e.width,e.height).data,g=document.createElement("canvas");g.width=c.width*d;g.height=c.height*d;for(var f=g.getContext("2d"),k=f.createImageData(g.width,g.height),h=k.width,m=k.height,u=0;u<m;u+=1)for(var n=u*k.width,t=Math.floor(u/d)*c.width,p=0;p<h;p+=1){var r=4*(n+p),s=4*(t+Math.floor(p/d));k.data[r]=e[s];k.data[r+1]=e[s+1];k.data[r+2]=e[s+2];k.data[r+3]=e[s+
3]}f.putImageData(k,0,0);return g};return b}(jaws||{});
jaws=function(b){b.PixelMap=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);this.sprite=new b.Sprite(c);this.named_colors=[];this.update()};b.PixelMap.prototype.update=function(b,d){this.data=this.sprite.asCanvasContext().getImageData(0,0,this.sprite.width,this.sprite.height).data};b.PixelMap.prototype.draw=function(){this.sprite.draw()};b.PixelMap.prototype.namedColorAtRect=function(b,d){for(var e=d.x,g=d.y;e<d.right;e++)if(this.namedColorAt(e,g)==b)return this.namedColorAt(e,
g);for(;g<d.bottom;g++)if(this.namedColorAt(e,g)==b)return this.namedColorAt(e,g);for(;e>d.x;e--)if(this.namedColorAt(e,g)==b)return this.namedColorAt(e,g);for(;g>d.y;g--)if(this.namedColorAt(e,g)==b)return this.namedColorAt(e,g);return!1};b.PixelMap.prototype.at=function(b,d){b=parseInt(b);d=parseInt(d)-1;0>d&&(d=0);var e=4*d*this.sprite.width+4*b;return[this.data[e],this.data[e+1],this.data[e+2],this.data[e+3]]};b.PixelMap.prototype.namedColorAt=function(b,d){for(var e=this.at(b,d),g=0;g<this.named_colors.length;g++){var f=
this.named_colors[g].name,k=this.named_colors[g].color;if(k[0]==e[0]&&k[1]==e[1]&&k[2]==e[2]&&k[3]==e[3])return f}};b.PixelMap.prototype.nameColor=function(b,d){this.named_colors.push({name:b,color:d})};return b}(jaws||{});
jaws=function(b){function c(c){b.mouse_x=c.pageX||c.clientX;b.mouse_y=c.pageY||c.clientY;c=b.canvas?b.canvas:b.dom;b.mouse_x-=c.offsetLeft;b.mouse_y-=c.offsetTop}var d,e;b.Parallax=function(){b.log.error("To use jaws.Parallax() you need to include src/extras/parallax.js")};b.SpriteList=function(){b.log.error("To use SpriteList() you need to include src/extras/sprite_list.js")};b.TileMap=function(){b.log.error("To use TileMap() you need to include src/extras/tile_map.js")};b.PixelMap=function(){b.log.error("To use PixelMap() you need to include src/extras/pixel_map.js")};
b.QuadTree=function(){b.log.error("To use QuadTree() you need to include src/extras/quadtree.js")};b.Audio=function(){b.log.error("To use jaws.Audio() you need to include src/extras/audio.js")};b.title=function(c){if(b.isString(c))return c?d.innerHTML=c:d.innerHTML;b.log.error("jaws.title: Passed in value is not a String.")};b.unpack=function(){"Sprite SpriteList Animation Viewport SpriteSheet Parallax TileMap pressed QuadTree".split(" ").forEach(function(c){window[c]?b.log.warn("jaws.unpack: "+c+
" already exists in global namespace."):window[c]=b[c]})};b.log=function(c,d){b.isString(c)||(c=JSON.stringify(c));b.log.on&&(e&&b.log.use_log_element&&(e.innerHTML=d?e.innerHTML+(c+"<br />"):c),console.log&&b.log.use_console&&console.log("JawsJS: ",c))};b.log.on=!0;b.log.use_console=!1;b.log.use_log_element=!0;b.log.warn=function(c){console.warn&&b.log.use_console&&b.log.on?console.warn(c):b.log("[WARNING]: "+JSON.stringify(c),!0)};b.log.error=function(c){console.error&&b.log.use_console&&b.log.on?
console.error(c):b.log("[ERROR]: "+JSON.stringify(c),!0)};b.log.info=function(c){console.info&&b.log.use_console&&b.log.on?console.info(c):b.log("[INFO]: "+JSON.stringify(c),!0)};b.log.debug=function(c){console.debug&&b.log.use_console&&b.log.on?console.debug(c):b.log("[DEBUG]: "+JSON.stringify(c),!0)};b.log.clear=function(){e&&(e.innerHTML="");console.clear&&console.clear()};b.init=function(g){d=document.getElementsByTagName("title")[0];b.url_parameters=b.getUrlParameters();e=document.getElementById("jaws-log");
b.url_parameters.debug&&!e&&(e=document.createElement("div"),e.id="jaws-log",e.style.cssText="overflow: auto; color: #aaaaaa; width: 300px; height: 150px; margin: 40px auto 0px auto; padding: 5px; border: #444444 1px solid; clear: both; font: 10px verdana; text-align: left;",document.body.appendChild(e));b.url_parameters.bust_cache&&(b.log.info("Busting cache when loading assets"),b.assets.bust_cache=!0);b.canvas=document.getElementsByTagName("canvas")[0];b.canvas||(b.dom=document.getElementById("canvas"));
b.canvas?b.context=b.canvas.getContext("2d"):b.dom?b.dom.style.position="relative":(b.canvas=document.createElement("canvas"),b.canvas.width=g.width,b.canvas.height=g.height,b.context=b.canvas.getContext("2d"),document.body.appendChild(b.canvas));b.context&&b.useCrispScaling();b.width=b.canvas?b.canvas.width:b.dom.offsetWidth;b.height=b.canvas?b.canvas.height:b.dom.offsetHeight;b.mouse_x=0;b.mouse_y=0;window.addEventListener("mousemove",c)};b.useCrispScaling=function(){b.context.imageSmoothingEnabled=
!1;b.context.webkitImageSmoothingEnabled=!1;b.context.mozImageSmoothingEnabled=!1};b.useSmoothScaling=function(){b.context.imageSmoothingEnabled=!0;b.context.webkitImageSmoothingEnabled=!0;b.context.mozImageSmoothingEnabled=!0};b.start=function(c,d,e){function h(c,e){b.log.info(e+"%: "+c,!0);d.loading_screen&&b.assets.displayProgress(e)}function m(c,d){b.log.info(d+"%: Error loading asset "+c,!0)}function u(){b.log.info("all assets loaded",!0);b.switchGameState(c||window,{fps:n},e)}if(b.isFunction(c))if(b.isObject(e)||
void 0===e){d||(d={});var n=d.fps||60;void 0===d.loading_screen&&(d.loading_screen=!0);d.width||(d.width=500);d.height||(d.height=300);b.init(d);d.loading_screen&&b.assets.displayProgress(0);b.log.info("setupInput()",!0);b.setupInput();b.log.info("assets.loadAll()",!0);0<b.assets.length()?b.assets.loadAll({onprogress:h,onerror:m,onload:u}):u()}else b.log.error("jaws.start: The setup options for the game state is not an object.");else b.log.error("jaws.start: Passed in GameState is not a function.")};
b.switchGameState=function(c,d,e){b.isFunction(c)&&(c=new c);b.isObject(c)?(d=d&&d.fps||b.game_loop&&b.game_loop.fps||60,b.game_loop&&b.game_loop.stop(),b.clearKeyCallbacks(),b.previous_game_state=b.game_state,b.game_state=c,b.game_loop=new b.GameLoop(c,{fps:d},e),b.game_loop.start()):b.log.error("jaws.switchGameState: Passed in GameState should be a Function or an Object.")};b.imageToCanvas=function(c){if(b.isCanvas(c))return c;if(b.isImage(c)){var d=document.createElement("canvas");d.src=c.src;
d.width=c.width;d.height=c.height;d.getContext("2d").drawImage(c,0,0,c.width,c.height);return d}b.log.error("jaws.imageToCanvas: Passed in object is not an Image.")};b.forceArray=function(b){return Array.isArray(b)?b:[b]};b.clear=function(){b.context.clearRect(0,0,b.width,b.height)};b.fill=function(c){b.context.fillStyle=c;b.context.fillRect(0,0,b.width,b.height)};b.draw=function(){var c=arguments;1==c.length&&b.isArray(c[0])&&(c=c[0]);for(var d=0;d<c.length;d++)b.isArray(c[d])?b.draw(c[d]):c[d].draw()};
b.update=function(){var c=arguments;1==c.length&&b.isArray(c[0])&&(c=c[0]);for(var d=0;d<c.length;d++)b.isArray(c[d])?b.update(c[d]):c[d].update()};b.isImage=function(b){return"[object HTMLImageElement]"===Object.prototype.toString.call(b)};b.isCanvas=function(b){return"[object HTMLCanvasElement]"===Object.prototype.toString.call(b)};b.isDrawable=function(c){return b.isImage(c)||b.isCanvas(c)};b.isString=function(b){return"string"===typeof b||"object"===typeof b&&b.constructor===String};b.isNumber=
function(b){return!isNaN(parseFloat(b))&&isFinite(b)};b.isArray=function(b){return b?-1!==b.constructor.toString().indexOf("Array"):!1};b.isObject=function(b){return null!==b&&"object"===typeof b};b.isFunction=function(b){return"[object Function]"===Object.prototype.toString.call(b)};b.isRegExp=function(b){return b instanceof RegExp};b.isOutsideCanvas=function(c){if(c.x&&c.y)return 0>c.x||0>c.y||c.x>b.width||c.y>b.height};b.forceInsideCanvas=function(c){c.x&&c.y&&(0>c.x&&(c.x=0),c.x>b.width&&(c.x=
b.width),0>c.y&&(c.y=0),c.y>b.height&&(c.y=b.height))};b.getUrlParameters=function(){for(var b=[],c,d=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),e=0;e<d.length;e++)c=d[e].split("="),b.push(c[0]),b[c[0]]=c[1];return b};b.parseOptions=function(c,d,e){c.options=d;for(var h in d)void 0===e[h]&&b.log.warn("jaws.parseOptions: Unsupported property "+h+"for "+c.constructor);for(h in e)b.isFunction(e[h])&&(e[h]=e[h]()),c[h]=void 0!==d[h]?d[h]:b.clone(e[h])};b.clone=function(c){return b.isArray(c)?
c.slice(0):b.isObject(c)?JSON.parse(JSON.stringify(c)):c};return b}(jaws||{});
jaws=function(b){b.Sprite=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);this.set(c);c.context?this.context=c.context:c.dom&&(this.dom=c.dom,this.createDiv());c.context||c.dom||(b.context?this.context=b.context:(this.dom=b.dom,this.createDiv()))};b.Sprite.prototype.default_options={x:0,y:0,alpha:1,angle:0,flipped:!1,anchor_x:0,anchor_y:0,image:null,image_path:null,anchor:null,scale_image:null,damping:1,scale_x:1,scale_y:1,scale:1,color:null,width:null,height:null,
_constructor:null,dom:null,context:null};b.Sprite.prototype.set=function(c){b.parseOptions(this,c,this.default_options);this.scale&&(this.scale_x=this.scale_y=this.scale);this.image&&this.setImage(this.image);this.scale_image&&this.scaleImage(this.scale_image);this.anchor&&this.setAnchor(this.anchor);if(!this.image&&this.color&&this.width&&this.height){c=document.createElement("canvas");var d=c.getContext("2d");c.width=this.width;c.height=this.height;d.fillStyle=this.color;d.fillRect(0,0,this.width,
this.height);this.image=c}this.cacheOffsets();return this};b.Sprite.prototype.clone=function(b){b=new (this._constructor?eval(this._constructor):this.constructor)(this.attributes());b._constructor=this._constructor||this.constructor.name;return b};b.Sprite.prototype.setImage=function(c){var d=this;if(b.isDrawable(c))return this.image=c,this.cacheOffsets();b.assets.isLoaded(c)?(this.image=b.assets.get(c),this.cacheOffsets()):(b.log.warn("Image '"+c+"' not preloaded with jaws.assets.add(). Image and a working sprite.rect() will be delayed."),
b.assets.load(c,{onload:function(){d.image=b.assets.get(c);d.cacheOffsets()}}));return this};b.Sprite.prototype.stepToWhile=function(b,d,e){var g=b<this.x?-1:1,f=d<this.y?-1:1;b=parseInt(b);d=parseInt(d);for(var k=!1,h=!1;;)if(!1===k&&(this.x!=b&&(this.x+=g),e(this)||(this.x-=g,k=!0)),!1===h&&(this.y!=d&&(this.y+=f),e(this)||(this.y-=f,h=!0)),(k||this.x==b)&&(h||this.y==d))return{x:k,y:h}};b.Sprite.prototype.flip=function(){this.flipped=this.flipped?!1:!0;return this};b.Sprite.prototype.flipTo=function(b){this.flipped=
b;return this};b.Sprite.prototype.rotate=function(b){this.angle+=b;return this};b.Sprite.prototype.rotateTo=function(b){this.angle=b;return this};b.Sprite.prototype.moveTo=function(c,d){void 0!==c&&(void 0===d&&b.isArray(c))&&(c=c[0],d=c[1]);this.x=c;this.y=d;return this};b.Sprite.prototype.move=function(c,d){void 0!==c&&(void 0===d&&b.isArray(c))&&(c=c[0],d=c[1]);c&&(this.x+=c);d&&(this.y+=d);return this};b.Sprite.prototype.scaleAll=function(b){this.scale_x*=b;this.scale_y*=b;return this.cacheOffsets()};
b.Sprite.prototype.scaleTo=function(b){this.scale_x=this.scale_y=b;return this.cacheOffsets()};b.Sprite.prototype.scaleWidth=function(b){this.scale_x*=b;return this.cacheOffsets()};b.Sprite.prototype.scaleHeight=function(b){this.scale_y*=b;return this.cacheOffsets()};b.Sprite.prototype.setX=function(b){this.x=b;return this};b.Sprite.prototype.setY=function(b){this.y=b;return this};b.Sprite.prototype.setTop=function(b){this.y=b+this.top_offset;return this};b.Sprite.prototype.setBottom=function(b){this.y=
b-this.bottom_offset;return this};b.Sprite.prototype.setLeft=function(b){this.x=b+this.left_offset;return this};b.Sprite.prototype.setRight=function(b){this.x=b-this.right_offset;return this};b.Sprite.prototype.setWidth=function(b){this.scale_x=b/this.image.width;return this.cacheOffsets()};b.Sprite.prototype.setHeight=function(b){this.scale_y=b/this.image.height;return this.cacheOffsets()};b.Sprite.prototype.resize=function(c,d){void 0!==c&&(void 0===d&&b.isArray(c))&&(c=c[0],d=c[1]);this.scale_x=
(this.width+c)/this.image.width;this.scale_y=(this.height+d)/this.image.height;return this.cacheOffsets()};b.Sprite.prototype.resizeTo=function(c,d){void 0!==c&&(void 0===d&&b.isArray(c))&&(c=c[0],d=c[1]);this.scale_x=c/this.image.width;this.scale_y=d/this.image.height;return this.cacheOffsets()};b.Sprite.prototype.setAnchor=function(b){if(a={top_left:[0,0],left_top:[0,0],center_left:[0,0.5],left_center:[0,0.5],bottom_left:[0,1],left_bottom:[0,1],top_center:[0.5,0],center_top:[0.5,0],center_center:[0.5,
0.5],center:[0.5,0.5],bottom_center:[0.5,1],center_bottom:[0.5,1],top_right:[1,0],right_top:[1,0],center_right:[1,0.5],right_center:[1,0.5],bottom_right:[1,1],right_bottom:[1,1]}[b])this.anchor_x=a[0],this.anchor_y=a[1],this.image&&this.cacheOffsets();return this};b.Sprite.prototype.cacheOffsets=function(){if(this.image)return this.width=this.image.width*this.scale_x,this.height=this.image.height*this.scale_y,this.left_offset=this.width*this.anchor_x,this.top_offset=this.height*this.anchor_y,this.right_offset=
this.width*(1-this.anchor_x),this.bottom_offset=this.height*(1-this.anchor_y),this.cached_rect&&this.cached_rect.resizeTo(this.width,this.height),this};b.Sprite.prototype.rect=function(){!this.cached_rect&&this.width&&(this.cached_rect=new b.Rect(this.x,this.y,this.width,this.height));this.cached_rect&&this.cached_rect.moveTo(this.x-this.left_offset,this.y-this.top_offset);return this.cached_rect};b.Sprite.prototype.createDiv=function(){this.div=document.createElement("div");this.div.style.position=
"absolute";this.image&&(this.div.style.width=this.image.width+"px",this.div.style.height=this.image.height+"px",this.div.style.backgroundImage=this.image.toDataURL?"url("+this.image.toDataURL()+")":"url("+this.image.src+")");this.dom&&this.dom.appendChild(this.div);this.updateDiv()};b.Sprite.prototype.updateDiv=function(){this.div.style.left=this.x+"px";this.div.style.top=this.y+"px";var b;b=""+("rotate("+this.angle+"deg) ");b=this.flipped?b+("scale(-"+this.scale_x+","+this.scale_y+")"):b+("scale("+
this.scale_x+","+this.scale_y+")");this.div.style.MozTransform=b;this.div.style.WebkitTransform=b;this.div.style.OTransform=b;this.div.style.msTransform=b;this.div.style.transform=b;return this};b.Sprite.prototype.draw=function(){if(!this.image)return this;if(this.dom)return this.updateDiv();this.context.save();this.context.translate(this.x,this.y);0!=this.angle&&b.context.rotate(this.angle*Math.PI/180);this.flipped&&this.context.scale(-1,1);this.context.globalAlpha=this.alpha;this.context.translate(-this.left_offset,
-this.top_offset);this.context.drawImage(this.image,0,0,this.width,this.height);this.context.restore();return this};b.Sprite.prototype.scaleImage=function(c){if(this.image)return this.setImage(b.gfx.retroScaleImage(this.image,c)),this};b.Sprite.prototype.asCanvasContext=function(){var c=document.createElement("canvas");c.width=this.width;c.height=this.height;c=c.getContext("2d");b.context&&(c.mozImageSmoothingEnabled=b.context.mozImageSmoothingEnabled);c.drawImage(this.image,0,0,this.width,this.height);
return c};b.Sprite.prototype.asCanvas=function(){var c=document.createElement("canvas");c.width=this.width;c.height=this.height;var d=c.getContext("2d");b.context&&(d.mozImageSmoothingEnabled=b.context.mozImageSmoothingEnabled);d.drawImage(this.image,0,0,this.width,this.height);return c};b.Sprite.prototype.toString=function(){return"[Sprite "+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width+", "+this.height+"]"};b.Sprite.prototype.attributes=function(){var b=this.options;b._constructor=this._constructor||
"jaws.Sprite";b.x=parseFloat(this.x.toFixed(2));b.y=parseFloat(this.y.toFixed(2));b.image=this.image_path;b.alpha=this.alpha;b.flipped=this.flipped;b.angle=parseFloat(this.angle.toFixed(2));b.scale_x=this.scale_x;b.scale_y=this.scale_y;b.anchor_x=this.anchor_x;b.anchor_y=this.anchor_y;return b};b.Sprite.prototype.toJSON=function(){return JSON.stringify(this.attributes())};return b}(jaws||{});"undefined"!==typeof module&&"exports"in module&&(module.exports=jaws.Sprite);
jaws=function(b){b.Parallax=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);b.parseOptions(this,c,this.default_options)};b.Parallax.prototype.default_options={width:function(){b.width},height:function(){b.height},scale:1,repeat_x:null,repeat_y:null,camera_x:0,camera_y:0,width:null,height:null,layers:[]};b.Parallax.prototype.draw=function(b){for(var d,e=0;e<this.layers.length;e++)for(b=this.layers[e],d=this.repeat_x?-(this.camera_x/b.damping%b.width):-(this.camera_x/
b.damping),b.y=this.repeat_y?-(this.camera_y/b.damping%b.height):-(this.camera_y/b.damping),b.x=d;b.y<this.height;){for(;b.x<this.width&&(0<=b.x+b.width&&0<=b.y+b.height&&b.draw(),b.x+=b.width,this.repeat_x););b.y+=b.height;b.x=d;if(!this.repeat_y)break}};b.Parallax.prototype.addLayer=function(c){c=new b.ParallaxLayer(c);c.scaleAll(this.scale);this.layers.push(c)};b.Parallax.prototype.toString=function(){return"[Parallax "+this.x+", "+this.y+". "+this.layers.length+" layers]"};b.ParallaxLayer=function(c){if(!(this instanceof
arguments.callee))return new arguments.callee(c);this.damping=c.damping||0;b.Sprite.call(this,c)};b.ParallaxLayer.prototype=b.Sprite.prototype;return b}(jaws||{});
jaws=function(b){b.TileMap=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);b.parseOptions(this,c,this.default_options);this.cells=Array(this.size[0]);for(var d=0;d<this.size[0];d++){this.cells[d]=Array(this.size[1]);for(var e=0;e<this.size[1];e++)this.cells[d][e]=[]}};b.TileMap.prototype.default_options={cell_size:[32,32],size:[100,100],sortFunction:null};b.TileMap.prototype.clear=function(){for(var b=0;b<this.size[0];b++)for(var d=0;d<this.size[1];d++)this.cells[b][d]=
[]};b.TileMap.prototype.sortCells=function(b){for(var d=0;d<this.size[0];d++)for(var e=0;e<this.size[1];e++)this.cells[d][e].sort(b)};b.TileMap.prototype.push=function(b){var d=this;if(b.forEach)return b.forEach(function(b){d.push(b)}),b;if(b.rect)return this.pushAsRect(b,b.rect());var e=parseInt(b.x/this.cell_size[0]),g=parseInt(b.y/this.cell_size[1]);return this.pushToCell(e,g,b)};b.TileMap.prototype.pushAsPoint=function(b){if(Array.isArray(b)){for(var d=0;d<b.length;d++)this.pushAsPoint(b[d]);
return b}var d=parseInt(b.x/this.cell_size[0]),e=parseInt(b.y/this.cell_size[1]);return this.pushToCell(d,e,b)};b.TileMap.prototype.pushAsRect=function(b,d){for(var e=parseInt(d.x/this.cell_size[0]),g=parseInt((d.right-1)/this.cell_size[0]);e<=g;e++)for(var f=parseInt(d.y/this.cell_size[1]),k=parseInt((d.bottom-1)/this.cell_size[1]);f<=k;f++)this.pushToCell(e,f,b);return b};b.TileMap.prototype.pushToCell=function(b,d,e){this.cells[b][d].push(e);this.sortFunction&&this.cells[b][d].sort(this.sortFunction);
return this};b.TileMap.prototype.at=function(b,d){var e=parseInt(b/this.cell_size[0]),g=parseInt(d/this.cell_size[1]);return this.cells[e][g]};b.TileMap.prototype.atRect=function(b){var d=[];try{var e=parseInt(b.x/this.cell_size[0]);0>e&&(e=0);var g=parseInt(b.right/this.cell_size[0]);g>=this.size[0]&&(g=this.size[0]-1);var f=parseInt(b.y/this.cell_size[1]);0>f&&(f=0);var k=parseInt(b.bottom/this.cell_size[1]);k>=this.size[1]&&(k=this.size[1]-1);for(b=e;b<=g;b++)for(e=f;e<=k;e++)this.cells[b][e].forEach(function(b,
c){-1==d.indexOf(b)&&d.push(b)})}catch(h){}return d};b.TileMap.prototype.all=function(){for(var b=[],d=0;d<this.size[0];d++)for(var e=0;e<this.size[1];e++)this.cells[d][e].forEach(function(d,e){b.push(d)});return b};b.TileMap.prototype.cell=function(b,d){return this.cells[b][d]};b.TileMap.prototype.findPath=function(b,d,e){"undefined"==typeof e&&(e=!1);var g=parseInt(b[0]/this.cell_size[0]),f=parseInt(b[1]/this.cell_size[1]),k=parseInt(d[0]/this.cell_size[0]);d=parseInt(d[1]/this.cell_size[1]);if(g===
k&&f===d)return[{x:b[0],y:b[1]}];for(var h=g,m=f,u=0,n=0,t=2*this.size[0]*this.size[1]+1,p=Array(this.size[0]),r=0;r<this.size[0];r++){p[r]=Array(this.size[1]);for(var s=0;s<this.size[1];s++)p[r][s]=!1}p[h][m]={parent:[],G:0,score:t};b=Array(this.size[0]);for(r=0;r<this.size[0];r++)for(b[r]=Array(this.size[1]),s=0;s<this.size[1];s++)b[r][s]=!1;for(;h!==k||m!==d;){s=[];0<h&&s.push([h-1,m]);h<this.size[0]-1&&s.push([h+1,m]);0<m&&s.push([h,m-1]);m<this.size[1]-1&&s.push([h,m+1]);for(r=0;r<s.length;r++){var q=
s[r][0],l=s[r][1];if(n=0===this.cell(q,l).length&&!e||0<this.cell(q,l).length&&e)n=b[q][l]?!0:!1,n=!n;if(n){var n=u+1,v;v=[q,l];var w=[k,d];v=Math.abs(w[0]-v[0])+Math.abs(w[1]-v[1]);n+=v;if(!p[q][l]||p[q][l]&&p[q][l].score>n)p[q][l]={parent:[h,m],G:u+1,score:n}}}m=[];q=[];h=t;for(r=u=0;r<this.size[0];r++)for(s=0;s<this.size[1];s++)p[r][s]&&p[r][s].score<h&&(m=[r,s],q=p[r][s].parent,h=p[r][s].score,u=p[r][s].G);if(0===m.length)return[];p[m[0]][m[1]]=!1;h=m[0];m=m[1];b[h][m]={parent:q}}e=[];k=b[h][m];
for(e.unshift({x:h*this.cell_size[0],y:m*this.cell_size[1]});h!==g||m!==f;)h=k.parent[0],m=k.parent[1],e.unshift({x:h*this.cell_size[0],y:m*this.cell_size[1]}),k=b[h][m];return e};b.TileMap.prototype.lineOfSight=function(b,d,e){"undefined"==typeof e&&(e=!1);var g=b[0],f=d[0];b=b[1];d=d[1];var k=Math.abs(f-g),h=Math.abs(d-b),m,u;m=g<f?1:-1;u=b<d?1:-1;for(var n=k-h,t;g!==f||b!==d;){if(e){if(0===this.at(g,b).length)return!1}else if(0<this.at(g,b).length)return!1;t=2*n;t>-h&&(n-=h,g+=m);t<k&&(n+=k,b+=
u)}return!0};b.TileMap.prototype.toString=function(){return"[TileMap "+this.size[0]+" cols, "+this.size[1]+" rows]"};return b}(jaws||{});"undefined"!==typeof module&&"exports"in module&&(module.exports=jaws.TileMap);
jaws=function(b){b.Viewport=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);b.parseOptions(this,c,this.default_options);this.context||(this.context=b.context);this.width||(this.width=b.width);this.height||(this.height=b.height);this.max_x||(this.max_x=b.width);this.max_y||(this.max_y=b.height);var d=this;this.move=function(b,c){b&&(this.x+=b);c&&(this.y+=c);this.verifyPosition()};this.moveTo=function(b,c){void 0!=b&&(this.x=b);void 0!=c&&(this.y=c);this.verifyPosition()};
this.isOutside=function(b){return!d.isInside(b)};this.isInside=function(b){return b.x>=d.x&&b.x<=d.x+d.width&&b.y>=d.y&&b.y<=d.y+d.height};this.isPartlyInside=function(b){var c=b.rect();return c.right>=d.x&&c.x<=d.x+d.width&&c.bottom>=d.y&&b.y<=d.y+d.height};this.isLeftOf=function(b){return b.x<d.x};this.isRightOf=function(b){return b.x>d.x+d.width};this.isAbove=function(b){return b.y<d.y};this.isBelow=function(b){return b.y>d.y+d.height};this.centerAround=function(b){this.x=Math.floor(b.x-this.width/
2);this.y=Math.floor(b.y-this.height/2);this.verifyPosition()};this.forceInsideVisibleArea=function(c,d){c.x<this.x+d&&(c.x=this.x+d);c.x>this.x+b.width-d&&(c.x=this.x+b.width-d);c.y<this.y+d&&(c.y=this.y+d);c.y>this.y+b.height-d&&(c.y=this.y+b.height-d)};this.forceInside=function(b,c){b.x<c&&(b.x=c);b.x>this.max_x-c&&(b.x=this.max_x-c);b.y<c&&(b.y=c);b.y>this.max_y-c&&(b.y=this.max_y-c)};this.apply=function(b){this.context.save();this.context.translate(-this.x,-this.y);b();this.context.restore()};
this.draw=function(b){this.apply(function(){b.forEach?b.forEach(d.drawIfPartlyInside):b.draw&&d.drawIfPartlyInside(b)})};this.drawTileMap=function(b){var c=b.atRect({x:this.x,y:this.y,right:this.x+this.width,bottom:this.y+this.height});this.apply(function(){for(var b=0;b<c.length;b++)c[b].draw()})};this.drawIfPartlyInside=function(b){d.isPartlyInside(b)&&b.draw()};this.verifyPosition=function(){var b=this.max_x-this.width;0>this.x&&(this.x=0);this.x>b&&(this.x=b);b=this.max_y-this.height;0>this.y&&
(this.y=0);this.y>b&&(this.y=b)};this.moveTo(c.x||0,c.y||0)};b.Viewport.prototype.default_options={context:null,width:null,height:null,max_x:null,max_y:null,x:0,y:0};b.Viewport.prototype.toString=function(){return"[Viewport "+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width+", "+this.height+"]"};return b}(jaws||{});
jaws=function(b){function c(b){this.size=b;this.values=Array(this.size);this.value;this.add=function(b){if(this.values.length>this.size){this.values.splice(0,1);for(var c=this.value=0;this.values[c];c++)this.value+=this.values[c];this.value/=this.size}this.values.push(b);return this};this.get=function(){return parseInt(this.value)}}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||
window.msRequestAnimationFrame||function(b,c){window.setTimeout(b,16.666)}}();b.GameLoop=function(d,e,g){if(!(this instanceof arguments.callee))return new arguments.callee(d,e);this.ticks=this.fps=this.tick_duration=0;var f,k=!1,h=!1,m=this,u=new c(20);this.runtime=function(){return this.last_tick-this.first_tick};this.start=function(){b.log.info("Game loop start",!0);this.first_tick=(new Date).getTime();this.current_tick=(new Date).getTime();this.last_tick=(new Date).getTime();d.setup&&d.setup(g);
step_delay=1E3/e.fps;60==e.fps?requestAnimFrame(this.loop):f=setInterval(this.loop,step_delay)};this.loop=function(){m.current_tick=(new Date).getTime();m.tick_duration=m.current_tick-m.last_tick;m.fps=u.add(1E3/m.tick_duration).get();h||k||(d.update&&d.update(),d.draw&&d.draw(),m.ticks++);60!=e.fps||h||requestAnimFrame(m.loop);m.last_tick=m.current_tick};this.pause=function(){k=!0};this.unpause=function(){k=!1};this.stop=function(){f&&clearInterval(f);h=!0}};return b}(jaws||{});
jaws=function(b){b.Animation=function(c){if(!(this instanceof arguments.callee))return new arguments.callee(c);b.parseOptions(this,c,this.default_options);if(c.sprite_sheet){var d=new b.SpriteSheet({image:c.sprite_sheet,scale_image:this.scale_image,frame_size:this.frame_size,orientation:this.orientation,offset:this.offset});this.frames=d.frames;this.frame_size=d.frame_size}c.scale_image&&(d=b.isDrawable(c.sprite_sheet)?c.sprite_sheet:b.assets.get(c.sprite_sheet),this.frame_size[0]*=c.scale_image,
this.frame_size[1]*=c.scale_image,c.sprite_sheet=b.gfx.retroScaleImage(d,c.scale_image));this.current_tick=(new Date).getTime();this.last_tick=(new Date).getTime();this.sum_tick=0;if(c.subsets)for(subset in this.subsets={},c.subsets)start_stop=c.subsets[subset],this.subsets[subset]=this.slice(start_stop[0],start_stop[1])};b.Animation.prototype.default_options={frames:[],subsets:[],frame_duration:100,index:0,loop:1,bounce:0,frame_direction:1,frame_size:null,orientation:"down",on_end:null,offset:0,
scale_image:null,sprite_sheet:null};b.Animation.prototype.subset=function(b){return this.subsets[b]};b.Animation.prototype.update=function(){this.current_tick=(new Date).getTime();this.sum_tick+=this.current_tick-this.last_tick;this.last_tick=this.current_tick;this.sum_tick>this.frame_duration&&(this.index+=this.frame_direction,this.sum_tick=0);if(this.index>=this.frames.length||0>this.index)this.bounce?(this.frame_direction=-this.frame_direction,this.index+=2*this.frame_direction):this.loop?this.index=
0>this.frame_direction?this.frames.length-1:0:(this.index-=this.frame_direction,this.on_end&&(this.on_end(),this.on_end=null));return this};b.Animation.prototype.slice=function(c,d){var e={};e.frame_duration=this.frame_duration;e.loop=this.loop;e.bounce=this.bounce;e.on_end=this.on_end;e.frame_direction=this.frame_direction;e.frames=this.frames.slice().slice(c,d);return new b.Animation(e)};b.Animation.prototype.next=function(){this.update();return this.frames[this.index]};b.Animation.prototype.atLastFrame=
function(){return this.index==this.frames.length-1};b.Animation.prototype.atFirstFrame=function(){return 0==this.index};b.Animation.prototype.currentFrame=function(){return this.frames[this.index]};b.Animation.prototype.toString=function(){return"[Animation, "+this.frames.length+" frames]"};return b}(jaws||{});
jaws=function(b){b.Rect=function(b,d,e,g){if(!(this instanceof arguments.callee))return new arguments.callee(b,d,e,g);this.x=b;this.y=d;this.width=e;this.height=g;this.right=b+e;this.bottom=d+g};b.Rect.prototype.getPosition=function(){return[this.x,this.y]};b.Rect.prototype.move=function(b,d){this.x+=b;this.y+=d;this.right+=b;this.bottom+=d;return this};b.Rect.prototype.moveTo=function(b,d){this.x=b;this.y=d;this.right=this.x+this.width;this.bottom=this.y+this.height;return this};b.Rect.prototype.resize=
function(b,d){this.width+=b;this.height+=d;this.right=this.x+this.width;this.bottom=this.y+this.height;return this};b.Rect.prototype.clone=function(){return new b.Rect(this.x,this.y,this.width,this.height)};b.Rect.prototype.shrink=function(b,d){this.x+=b;this.y+=d;this.width-=b+b;this.height-=d+d;this.right=this.x+this.width;this.bottom=this.y+this.height;return this};b.Rect.prototype.resizeTo=function(b,d){this.width=b;this.height=d;this.right=this.x+this.width;this.bottom=this.y+this.height;return this};
b.Rect.prototype.draw=function(){b.context.strokeStyle="red";b.context.strokeRect(this.x,this.y,this.width,this.height);return this};b.Rect.prototype.collidePoint=function(b,d){return b>=this.x&&b<=this.right&&d>=this.y&&d<=this.bottom};b.Rect.prototype.collideRect=function(b){return(this.x>=b.x&&this.x<=b.right||b.x>=this.x&&b.x<=this.right)&&(this.y>=b.y&&this.y<=b.bottom||b.y>=this.y&&b.y<=this.bottom)};b.Rect.prototype.toString=function(){return"[Rect "+this.x+", "+this.y+", "+this.width+", "+
this.height+"]"};return b}(jaws||{});"undefined"!==typeof module&&"exports"in module&&(module.exports=jaws.Rect);
jaws=function(b){function c(b,c,g,f,k){var h=document.createElement("canvas");h.width=f;h.height=k;h.getContext("2d").drawImage(b,c,g,f,k,0,0,h.width,h.height);return h}b.SpriteSheet=function(d){if(!(this instanceof arguments.callee))return new arguments.callee(d);b.parseOptions(this,d,this.default_options);if(b.isString(this.image)&&!d.frame_size){var e=RegExp("_(\\d+)x(\\d+)","g").exec(this.image);this.frame_size=[];this.frame_size[0]=parseInt(e[1]);this.frame_size[1]=parseInt(e[2])}this.image=
b.isDrawable(this.image)?this.image:b.assets.data[this.image];this.scale_image&&(e=b.isDrawable(this.image)?this.image:b.assets.get(this.image),this.frame_size[0]*=this.scale_image,this.frame_size[1]*=this.scale_image,this.image=b.gfx.retroScaleImage(e,this.scale_image));this.frames=[];if("down"==this.orientation)for(e=this.offset;e<this.image.width;e+=this.frame_size[0])for(var g=0;g<this.image.height;g+=this.frame_size[1])this.frames.push(c(this.image,e,g,this.frame_size[0],this.frame_size[1]));
else for(g=this.offset;g<this.image.height;g+=this.frame_size[1])for(e=0;e<this.image.width;e+=this.frame_size[0])this.frames.push(c(this.image,e,g,this.frame_size[0],this.frame_size[1]))};b.SpriteSheet.prototype.default_options={image:null,orientation:"down",frame_size:[32,32],offset:0,scale_image:null};b.SpriteSheet.prototype.toString=function(){return"[SpriteSheet "+this.frames.length+" frames]"};return b}(jaws||{});
jaws=function(b){function c(b){m={}}function d(b){event=b?b:window.event;n[event.keyCode].split(" ").forEach(function(c){m[c]=!1;p[c]&&(p[c](c),b.preventDefault());q[c]&&b.preventDefault()})}function e(b){event=b?b:window.event;n[event.keyCode].split(" ").forEach(function(c){m[c]=!0;t[c]&&(t[c](c),b.preventDefault());q[c]&&b.preventDefault()})}function g(b){event=b?b:window.event;var c=r[event.button];"Microsoft Internet Explorer"==navigator.appName&&(c=s[event.button]);m[c]=!0;t[c]&&(t[c](c),b.preventDefault())}
function f(b){event=b?b:window.event;var c=r[event.button];"Microsoft Internet Explorer"==navigator.appName&&(c=s[event.button]);m[c]=!1;p[c]&&(p[c](c),b.preventDefault())}function k(c){event=c?c:window.event;m.left_mouse_button=!0;b.mouse_x=c.touches[0].pageX-b.canvas.offsetLeft;b.mouse_y=c.touches[0].pageY-b.canvas.offsetTop}function h(c){event=c?c:window.event;m.left_mouse_button=!1;b.mouse_x=void 0;b.mouse_y=void 0}var m={},u={},n=[],t=[],p=[],r=[],s=[];b.setupInput=function(){var l=[];l[8]="backspace";
l[9]="tab";l[13]="enter";l[16]="shift";l[17]="ctrl";l[18]="alt";l[19]="pause";l[20]="capslock";l[27]="esc";l[32]="space";l[33]="pageup";l[34]="pagedown";l[35]="end";l[36]="home";l[37]="left";l[38]="up";l[39]="right";l[40]="down";l[45]="insert";l[46]="delete";l[91]="left_window_key leftwindowkey";l[92]="right_window_key rightwindowkey";l[93]="select_key selectkey";l[106]="multiply *";l[107]="add plus +";l[109]="subtract minus -";l[110]="decimalpoint";l[111]="divide /";l[144]="numlock";l[145]="scrollock";
l[186]="semicolon ;";l[187]="equalsign =";l[188]="comma ,";l[189]="dash -";l[190]="period .";l[191]="forwardslash /";l[192]="graveaccent `";l[219]="openbracket [";l[220]="backslash \\";l[221]="closebracket ]";l[222]="singlequote '";r=["left_mouse_button","center_mouse_button","right_mouse_button"];s=[,"left_mouse_button","right_mouse_button",,"center_mouse_button"];for(var m="numpad0 numpad1 numpad2 numpad3 numpad4 numpad5 numpad6 numpad7 numpad8 numpad9".split(" "),p="f1 f2 f3 f4 f5 f6 f7 f8 f9".split(" "),
t="0123456789".split(""),u="abcdefghijklmnopqrstuvwxyz".split(""),q=0;t[q];q++)l[48+q]=t[q];for(q=0;u[q];q++)l[65+q]=u[q];for(q=0;m[q];q++)l[96+q]=m[q];for(q=0;p[q];q++)l[112+q]=p[q];n=l;window.addEventListener("keydown",e);window.addEventListener("keyup",d);l=b.canvas||b.dom;l.addEventListener("mousedown",g,!1);l.addEventListener("mouseup",f,!1);l.addEventListener("touchstart",k,!1);l.addEventListener("touchend",h,!1);window.addEventListener("blur",c,!1);document.oncontextmenu=function(){return!1}};
var q=[];b.preventDefaultKeys=function(b){b.forEach(function(b,c){q[b]=!0})};b.pressed=function(c,d){b.isString(c)&&(c=c.split(" "));return d?c.every(function(b){return m[b]}):c.some(function(b){return m[b]})};b.pressedWithoutRepeat=function(c,d){if(b.pressed(c,d)){if(!u[c])return u[c]=!0}else return u[c]=!1};b.on_keydown=function(c,d){if(b.isArray(c))for(var e=0;c[e];e++)t[c[e]]=d;else t[c]=d};b.on_keyup=function(c,d){if(b.isArray(c))for(var e=0;c[e];e++)p[c[e]]=d;else p[c]=d};b.clearKeyCallbacks=
function(){p=[];t=[]};return b}(jaws||{});window.addEventListener("load",function(){if(jaws.onload)jaws.onload()},!1);
